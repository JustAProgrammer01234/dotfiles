var wv=Object.create;var fi=Object.defineProperty,Rv=Object.defineProperties,bv=Object.getOwnPropertyDescriptor,Dv=Object.getOwnPropertyDescriptors,Tv=Object.getOwnPropertyNames,oo=Object.getOwnPropertySymbols,Sv=Object.getPrototypeOf,Ds=Object.prototype.hasOwnProperty,Kc=Object.prototype.propertyIsEnumerable;var Uc=(n,e,t)=>e in n?fi(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ar=(n,e)=>{for(var t in e||(e={}))Ds.call(e,t)&&Uc(n,t,e[t]);if(oo)for(var t of oo(e))Kc.call(e,t)&&Uc(n,t,e[t]);return n},so=(n,e)=>Rv(n,Dv(e));var Vc=(n,e)=>{var t={};for(var r in n)Ds.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&oo)for(var r of oo(n))e.indexOf(r)<0&&Kc.call(n,r)&&(t[r]=n[r]);return t};var k=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),_v=(n,e)=>{for(var t in e)fi(n,t,{get:e[t],enumerable:!0})},Bc=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Tv(e))!Ds.call(n,i)&&i!==t&&fi(n,i,{get:()=>e[i],enumerable:!(r=bv(e,i))||r.enumerable});return n};var qe=(n,e,t)=>(t=n!=null?wv(Sv(n)):{},Bc(e||!n||!n.__esModule?fi(t,"default",{value:n,enumerable:!0}):t,n)),Pv=n=>Bc(fi({},"__esModule",{value:!0}),n);var pi=k((XS,Gc)=>{var Ev="2.0.0",xv=Number.MAX_SAFE_INTEGER||9007199254740991,kv=16;Gc.exports={SEMVER_SPEC_VERSION:Ev,MAX_LENGTH:256,MAX_SAFE_INTEGER:xv,MAX_SAFE_COMPONENT_LENGTH:kv}});var hi=k((QS,Xc)=>{var qv=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Xc.exports=qv});var pr=k((Yn,Qc)=>{var{MAX_SAFE_COMPONENT_LENGTH:Ts}=pi(),Ov=hi();Yn=Qc.exports={};var Iv=Yn.re=[],B=Yn.src=[],G=Yn.t={},Nv=0,ae=(n,e,t)=>{let r=Nv++;Ov(r,e),G[n]=r,B[r]=e,Iv[r]=new RegExp(e,t?"g":void 0)};ae("NUMERICIDENTIFIER","0|[1-9]\\d*");ae("NUMERICIDENTIFIERLOOSE","[0-9]+");ae("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");ae("MAINVERSION",`(${B[G.NUMERICIDENTIFIER]})\\.(${B[G.NUMERICIDENTIFIER]})\\.(${B[G.NUMERICIDENTIFIER]})`);ae("MAINVERSIONLOOSE",`(${B[G.NUMERICIDENTIFIERLOOSE]})\\.(${B[G.NUMERICIDENTIFIERLOOSE]})\\.(${B[G.NUMERICIDENTIFIERLOOSE]})`);ae("PRERELEASEIDENTIFIER",`(?:${B[G.NUMERICIDENTIFIER]}|${B[G.NONNUMERICIDENTIFIER]})`);ae("PRERELEASEIDENTIFIERLOOSE",`(?:${B[G.NUMERICIDENTIFIERLOOSE]}|${B[G.NONNUMERICIDENTIFIER]})`);ae("PRERELEASE",`(?:-(${B[G.PRERELEASEIDENTIFIER]}(?:\\.${B[G.PRERELEASEIDENTIFIER]})*))`);ae("PRERELEASELOOSE",`(?:-?(${B[G.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${B[G.PRERELEASEIDENTIFIERLOOSE]})*))`);ae("BUILDIDENTIFIER","[0-9A-Za-z-]+");ae("BUILD",`(?:\\+(${B[G.BUILDIDENTIFIER]}(?:\\.${B[G.BUILDIDENTIFIER]})*))`);ae("FULLPLAIN",`v?${B[G.MAINVERSION]}${B[G.PRERELEASE]}?${B[G.BUILD]}?`);ae("FULL",`^${B[G.FULLPLAIN]}$`);ae("LOOSEPLAIN",`[v=\\s]*${B[G.MAINVERSIONLOOSE]}${B[G.PRERELEASELOOSE]}?${B[G.BUILD]}?`);ae("LOOSE",`^${B[G.LOOSEPLAIN]}$`);ae("GTLT","((?:<|>)?=?)");ae("XRANGEIDENTIFIERLOOSE",`${B[G.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ae("XRANGEIDENTIFIER",`${B[G.NUMERICIDENTIFIER]}|x|X|\\*`);ae("XRANGEPLAIN",`[v=\\s]*(${B[G.XRANGEIDENTIFIER]})(?:\\.(${B[G.XRANGEIDENTIFIER]})(?:\\.(${B[G.XRANGEIDENTIFIER]})(?:${B[G.PRERELEASE]})?${B[G.BUILD]}?)?)?`);ae("XRANGEPLAINLOOSE",`[v=\\s]*(${B[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[G.XRANGEIDENTIFIERLOOSE]})(?:${B[G.PRERELEASELOOSE]})?${B[G.BUILD]}?)?)?`);ae("XRANGE",`^${B[G.GTLT]}\\s*${B[G.XRANGEPLAIN]}$`);ae("XRANGELOOSE",`^${B[G.GTLT]}\\s*${B[G.XRANGEPLAINLOOSE]}$`);ae("COERCE",`(^|[^\\d])(\\d{1,${Ts}})(?:\\.(\\d{1,${Ts}}))?(?:\\.(\\d{1,${Ts}}))?(?:$|[^\\d])`);ae("COERCERTL",B[G.COERCE],!0);ae("LONETILDE","(?:~>?)");ae("TILDETRIM",`(\\s*)${B[G.LONETILDE]}\\s+`,!0);Yn.tildeTrimReplace="$1~";ae("TILDE",`^${B[G.LONETILDE]}${B[G.XRANGEPLAIN]}$`);ae("TILDELOOSE",`^${B[G.LONETILDE]}${B[G.XRANGEPLAINLOOSE]}$`);ae("LONECARET","(?:\\^)");ae("CARETTRIM",`(\\s*)${B[G.LONECARET]}\\s+`,!0);Yn.caretTrimReplace="$1^";ae("CARET",`^${B[G.LONECARET]}${B[G.XRANGEPLAIN]}$`);ae("CARETLOOSE",`^${B[G.LONECARET]}${B[G.XRANGEPLAINLOOSE]}$`);ae("COMPARATORLOOSE",`^${B[G.GTLT]}\\s*(${B[G.LOOSEPLAIN]})$|^$`);ae("COMPARATOR",`^${B[G.GTLT]}\\s*(${B[G.FULLPLAIN]})$|^$`);ae("COMPARATORTRIM",`(\\s*)${B[G.GTLT]}\\s*(${B[G.LOOSEPLAIN]}|${B[G.XRANGEPLAIN]})`,!0);Yn.comparatorTrimReplace="$1$2$3";ae("HYPHENRANGE",`^\\s*(${B[G.XRANGEPLAIN]})\\s+-\\s+(${B[G.XRANGEPLAIN]})\\s*$`);ae("HYPHENRANGELOOSE",`^\\s*(${B[G.XRANGEPLAINLOOSE]})\\s+-\\s+(${B[G.XRANGEPLAINLOOSE]})\\s*$`);ae("STAR","(<|>)?=?\\s*\\*");ae("GTE0","^\\s*>=\\s*0.0.0\\s*$");ae("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")});var gi=k((JS,Jc)=>{var Fv=["includePrerelease","loose","rtl"],Lv=n=>n?typeof n!="object"?{loose:!0}:Fv.filter(e=>n[e]).reduce((e,t)=>(e[t]=!0,e),{}):{};Jc.exports=Lv});var ao=k((YS,eu)=>{var Yc=/^[0-9]+$/,Zc=(n,e)=>{let t=Yc.test(n),r=Yc.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},Av=(n,e)=>Zc(e,n);eu.exports={compareIdentifiers:Zc,rcompareIdentifiers:Av}});var Ct=k((ZS,iu)=>{var co=hi(),{MAX_LENGTH:tu,MAX_SAFE_INTEGER:uo}=pi(),{re:nu,t:ru}=pr(),Mv=gi(),{compareIdentifiers:mi}=ao(),Jt=class{constructor(e,t){if(t=Mv(t),e instanceof Jt){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>tu)throw new TypeError(`version is longer than ${tu} characters`);co("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?nu[ru.LOOSE]:nu[ru.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>uo||this.major<0)throw new TypeError("Invalid major version");if(this.minor>uo||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>uo||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<uo)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(co("SemVer.compare",this.version,this.options,e),!(e instanceof Jt)){if(typeof e=="string"&&e===this.version)return 0;e=new Jt(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Jt||(e=new Jt(e,this.options)),mi(this.major,e.major)||mi(this.minor,e.minor)||mi(this.patch,e.patch)}comparePre(e){if(e instanceof Jt||(e=new Jt(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(co("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return mi(r,i)}while(++t)}compareBuild(e){e instanceof Jt||(e=new Jt(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(co("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return mi(r,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};iu.exports=Jt});var hr=k((e_,cu)=>{var{MAX_LENGTH:jv}=pi(),{re:ou,t:su}=pr(),au=Ct(),$v=gi(),Hv=(n,e)=>{if(e=$v(e),n instanceof au)return n;if(typeof n!="string"||n.length>jv||!(e.loose?ou[su.LOOSE]:ou[su.FULL]).test(n))return null;try{return new au(n,e)}catch{return null}};cu.exports=Hv});var lu=k((t_,uu)=>{var Wv=hr(),zv=(n,e)=>{let t=Wv(n,e);return t?t.version:null};uu.exports=zv});var fu=k((n_,du)=>{var Uv=hr(),Kv=(n,e)=>{let t=Uv(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null};du.exports=Kv});var hu=k((r_,pu)=>{var Vv=Ct(),Bv=(n,e,t,r)=>{typeof t=="string"&&(r=t,t=void 0);try{return new Vv(n,t).inc(e,r).version}catch{return null}};pu.exports=Bv});var Yt=k((i_,mu)=>{var gu=Ct(),Gv=(n,e,t)=>new gu(n,t).compare(new gu(e,t));mu.exports=Gv});var lo=k((o_,vu)=>{var Xv=Yt(),Qv=(n,e,t)=>Xv(n,e,t)===0;vu.exports=Qv});var wu=k((s_,Cu)=>{var yu=hr(),Jv=lo(),Yv=(n,e)=>{if(Jv(n,e))return null;{let t=yu(n),r=yu(e),i=t.prerelease.length||r.prerelease.length,o=i?"pre":"",s=i?"prerelease":"";for(let a in t)if((a==="major"||a==="minor"||a==="patch")&&t[a]!==r[a])return o+a;return s}};Cu.exports=Yv});var bu=k((a_,Ru)=>{var Zv=Ct(),ey=(n,e)=>new Zv(n,e).major;Ru.exports=ey});var Tu=k((c_,Du)=>{var ty=Ct(),ny=(n,e)=>new ty(n,e).minor;Du.exports=ny});var _u=k((u_,Su)=>{var ry=Ct(),iy=(n,e)=>new ry(n,e).patch;Su.exports=iy});var Eu=k((l_,Pu)=>{var oy=hr(),sy=(n,e)=>{let t=oy(n,e);return t&&t.prerelease.length?t.prerelease:null};Pu.exports=sy});var ku=k((d_,xu)=>{var ay=Yt(),cy=(n,e,t)=>ay(e,n,t);xu.exports=cy});var Ou=k((f_,qu)=>{var uy=Yt(),ly=(n,e)=>uy(n,e,!0);qu.exports=ly});var fo=k((p_,Nu)=>{var Iu=Ct(),dy=(n,e,t)=>{let r=new Iu(n,t),i=new Iu(e,t);return r.compare(i)||r.compareBuild(i)};Nu.exports=dy});var Lu=k((h_,Fu)=>{var fy=fo(),py=(n,e)=>n.sort((t,r)=>fy(t,r,e));Fu.exports=py});var Mu=k((g_,Au)=>{var hy=fo(),gy=(n,e)=>n.sort((t,r)=>hy(r,t,e));Au.exports=gy});var vi=k((m_,ju)=>{var my=Yt(),vy=(n,e,t)=>my(n,e,t)>0;ju.exports=vy});var po=k((v_,$u)=>{var yy=Yt(),Cy=(n,e,t)=>yy(n,e,t)<0;$u.exports=Cy});var Ss=k((y_,Hu)=>{var wy=Yt(),Ry=(n,e,t)=>wy(n,e,t)!==0;Hu.exports=Ry});var ho=k((C_,Wu)=>{var by=Yt(),Dy=(n,e,t)=>by(n,e,t)>=0;Wu.exports=Dy});var go=k((w_,zu)=>{var Ty=Yt(),Sy=(n,e,t)=>Ty(n,e,t)<=0;zu.exports=Sy});var _s=k((R_,Uu)=>{var _y=lo(),Py=Ss(),Ey=vi(),xy=ho(),ky=po(),qy=go(),Oy=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return _y(n,t,r);case"!=":return Py(n,t,r);case">":return Ey(n,t,r);case">=":return xy(n,t,r);case"<":return ky(n,t,r);case"<=":return qy(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Uu.exports=Oy});var Vu=k((b_,Ku)=>{var Iy=Ct(),Ny=hr(),{re:mo,t:vo}=pr(),Fy=(n,e)=>{if(n instanceof Iy)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;e=e||{};let t=null;if(!e.rtl)t=n.match(mo[vo.COERCE]);else{let r;for(;(r=mo[vo.COERCERTL].exec(n))&&(!t||t.index+t[0].length!==n.length);)(!t||r.index+r[0].length!==t.index+t[0].length)&&(t=r),mo[vo.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;mo[vo.COERCERTL].lastIndex=-1}return t===null?null:Ny(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};Ku.exports=Fy});var Gu=k((D_,Bu)=>{"use strict";Bu.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var Qu=k((T_,Xu)=>{"use strict";Xu.exports=ve;ve.Node=gr;ve.create=ve;function ve(n){var e=this;if(e instanceof ve||(e=new ve),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}ve.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};ve.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};ve.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};ve.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)Ay(this,arguments[n]);return this.length};ve.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)My(this,arguments[n]);return this.length};ve.prototype.pop=function(){if(!!this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};ve.prototype.shift=function(){if(!!this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};ve.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};ve.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};ve.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};ve.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};ve.prototype.map=function(n,e){e=e||this;for(var t=new ve,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};ve.prototype.mapReverse=function(n,e){e=e||this;for(var t=new ve,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};ve.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};ve.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};ve.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};ve.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};ve.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new ve;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};ve.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new ve;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};ve.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var o=[],r=0;i&&r<e;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=Ly(this,i,t[r]);return o};ve.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function Ly(n,e,t){var r=e===n.head?new gr(t,null,e,n):new gr(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function Ay(n,e){n.tail=new gr(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function My(n,e){n.head=new gr(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function gr(n,e,t,r){if(!(this instanceof gr))return new gr(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Gu()(ve)}catch{}});var rl=k((S_,nl)=>{"use strict";var jy=Qu(),mr=Symbol("max"),Ln=Symbol("length"),Mr=Symbol("lengthCalculator"),Ci=Symbol("allowStale"),vr=Symbol("maxAge"),Fn=Symbol("dispose"),Ju=Symbol("noDisposeOnSet"),ot=Symbol("lruList"),an=Symbol("cache"),Zu=Symbol("updateAgeOnGet"),Ps=()=>1,el=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[mr]=e.max||1/0,r=e.length||Ps;if(this[Mr]=typeof r!="function"?Ps:r,this[Ci]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[vr]=e.maxAge||0,this[Fn]=e.dispose,this[Ju]=e.noDisposeOnSet||!1,this[Zu]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[mr]=e||1/0,yi(this)}get max(){return this[mr]}set allowStale(e){this[Ci]=!!e}get allowStale(){return this[Ci]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[vr]=e,yi(this)}get maxAge(){return this[vr]}set lengthCalculator(e){typeof e!="function"&&(e=Ps),e!==this[Mr]&&(this[Mr]=e,this[Ln]=0,this[ot].forEach(t=>{t.length=this[Mr](t.value,t.key),this[Ln]+=t.length})),yi(this)}get lengthCalculator(){return this[Mr]}get length(){return this[Ln]}get itemCount(){return this[ot].length}rforEach(e,t){t=t||this;for(let r=this[ot].tail;r!==null;){let i=r.prev;Yu(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[ot].head;r!==null;){let i=r.next;Yu(this,e,r,t),r=i}}keys(){return this[ot].toArray().map(e=>e.key)}values(){return this[ot].toArray().map(e=>e.value)}reset(){this[Fn]&&this[ot]&&this[ot].length&&this[ot].forEach(e=>this[Fn](e.key,e.value)),this[an]=new Map,this[ot]=new jy,this[Ln]=0}dump(){return this[ot].map(e=>yo(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[ot]}set(e,t,r){if(r=r||this[vr],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,o=this[Mr](t,e);if(this[an].has(e)){if(o>this[mr])return jr(this,this[an].get(e)),!1;let c=this[an].get(e).value;return this[Fn]&&(this[Ju]||this[Fn](e,c.value)),c.now=i,c.maxAge=r,c.value=t,this[Ln]+=o-c.length,c.length=o,this.get(e),yi(this),!0}let s=new tl(e,t,o,i,r);return s.length>this[mr]?(this[Fn]&&this[Fn](e,t),!1):(this[Ln]+=s.length,this[ot].unshift(s),this[an].set(e,this[ot].head),yi(this),!0)}has(e){if(!this[an].has(e))return!1;let t=this[an].get(e).value;return!yo(this,t)}get(e){return Es(this,e,!0)}peek(e){return Es(this,e,!1)}pop(){let e=this[ot].tail;return e?(jr(this,e),e.value):null}del(e){jr(this,this[an].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{let s=o-t;s>0&&this.set(i.k,i.v,s)}}}prune(){this[an].forEach((e,t)=>Es(this,t,!1))}},Es=(n,e,t)=>{let r=n[an].get(e);if(r){let i=r.value;if(yo(n,i)){if(jr(n,r),!n[Ci])return}else t&&(n[Zu]&&(r.value.now=Date.now()),n[ot].unshiftNode(r));return i.value}},yo=(n,e)=>{if(!e||!e.maxAge&&!n[vr])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[vr]&&t>n[vr]},yi=n=>{if(n[Ln]>n[mr])for(let e=n[ot].tail;n[Ln]>n[mr]&&e!==null;){let t=e.prev;jr(n,e),e=t}},jr=(n,e)=>{if(e){let t=e.value;n[Fn]&&n[Fn](t.key,t.value),n[Ln]-=t.length,n[an].delete(t.key),n[ot].removeNode(e)}},tl=class{constructor(e,t,r,i,o){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=o||0}},Yu=(n,e,t,r)=>{let i=t.value;yo(n,i)&&(jr(n,t),n[Ci]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};nl.exports=el});var Zt=k((__,al)=>{var $r=class{constructor(e,t){if(t=Hy(t),e instanceof $r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new $r(e.raw,t);if(e instanceof xs)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!ol(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&Vy(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();let r=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=il.get(r);if(i)return i;let o=this.options.loose,s=o?wt[lt.HYPHENRANGELOOSE]:wt[lt.HYPHENRANGE];e=e.replace(s,nC(this.options.includePrerelease)),Ke("hyphen replace",e),e=e.replace(wt[lt.COMPARATORTRIM],zy),Ke("comparator trim",e,wt[lt.COMPARATORTRIM]),e=e.replace(wt[lt.TILDETRIM],Uy),e=e.replace(wt[lt.CARETTRIM],Ky),e=e.split(/\s+/).join(" ");let a=o?wt[lt.COMPARATORLOOSE]:wt[lt.COMPARATOR],c=e.split(" ").map(h=>By(h,this.options)).join(" ").split(/\s+/).map(h=>tC(h,this.options)).filter(this.options.loose?h=>!!h.match(a):()=>!0).map(h=>new xs(h,this.options)),l=c.length,g=new Map;for(let h of c){if(ol(h))return[h];g.set(h.value,h)}g.size>1&&g.has("")&&g.delete("");let v=[...g.values()];return il.set(r,v),v}intersects(e,t){if(!(e instanceof $r))throw new TypeError("a Range is required");return this.set.some(r=>sl(r,t)&&e.set.some(i=>sl(i,t)&&r.every(o=>i.every(s=>o.intersects(s,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Wy(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(rC(this.set[t],e,this.options))return!0;return!1}};al.exports=$r;var $y=rl(),il=new $y({max:1e3}),Hy=gi(),xs=wi(),Ke=hi(),Wy=Ct(),{re:wt,t:lt,comparatorTrimReplace:zy,tildeTrimReplace:Uy,caretTrimReplace:Ky}=pr(),ol=n=>n.value==="<0.0.0-0",Vy=n=>n.value==="",sl=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(o=>i.intersects(o,e)),i=r.pop();return t},By=(n,e)=>(Ke("comp",n,e),n=Qy(n,e),Ke("caret",n),n=Gy(n,e),Ke("tildes",n),n=Yy(n,e),Ke("xrange",n),n=eC(n,e),Ke("stars",n),n),Pt=n=>!n||n.toLowerCase()==="x"||n==="*",Gy=(n,e)=>n.trim().split(/\s+/).map(t=>Xy(t,e)).join(" "),Xy=(n,e)=>{let t=e.loose?wt[lt.TILDELOOSE]:wt[lt.TILDE];return n.replace(t,(r,i,o,s,a)=>{Ke("tilde",n,r,i,o,s,a);let c;return Pt(i)?c="":Pt(o)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Pt(s)?c=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:a?(Ke("replaceTilde pr",a),c=`>=${i}.${o}.${s}-${a} <${i}.${+o+1}.0-0`):c=`>=${i}.${o}.${s} <${i}.${+o+1}.0-0`,Ke("tilde return",c),c})},Qy=(n,e)=>n.trim().split(/\s+/).map(t=>Jy(t,e)).join(" "),Jy=(n,e)=>{Ke("caret",n,e);let t=e.loose?wt[lt.CARETLOOSE]:wt[lt.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,o,s,a,c)=>{Ke("caret",n,i,o,s,a,c);let l;return Pt(o)?l="":Pt(s)?l=`>=${o}.0.0${r} <${+o+1}.0.0-0`:Pt(a)?o==="0"?l=`>=${o}.${s}.0${r} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.0${r} <${+o+1}.0.0-0`:c?(Ke("replaceCaret pr",c),o==="0"?s==="0"?l=`>=${o}.${s}.${a}-${c} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a}-${c} <${+o+1}.0.0-0`):(Ke("no pr"),o==="0"?s==="0"?l=`>=${o}.${s}.${a}${r} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}${r} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a} <${+o+1}.0.0-0`),Ke("caret return",l),l})},Yy=(n,e)=>(Ke("replaceXRanges",n,e),n.split(/\s+/).map(t=>Zy(t,e)).join(" ")),Zy=(n,e)=>{n=n.trim();let t=e.loose?wt[lt.XRANGELOOSE]:wt[lt.XRANGE];return n.replace(t,(r,i,o,s,a,c)=>{Ke("xRange",n,r,i,o,s,a,c);let l=Pt(o),g=l||Pt(s),v=g||Pt(a),h=v;return i==="="&&h&&(i=""),c=e.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&h?(g&&(s=0),a=0,i===">"?(i=">=",g?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",g?o=+o+1:s=+s+1),i==="<"&&(c="-0"),r=`${i+o}.${s}.${a}${c}`):g?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:v&&(r=`>=${o}.${s}.0${c} <${o}.${+s+1}.0-0`),Ke("xRange return",r),r})},eC=(n,e)=>(Ke("replaceStars",n,e),n.trim().replace(wt[lt.STAR],"")),tC=(n,e)=>(Ke("replaceGTE0",n,e),n.trim().replace(wt[e.includePrerelease?lt.GTE0PRE:lt.GTE0],"")),nC=n=>(e,t,r,i,o,s,a,c,l,g,v,h,C)=>(Pt(r)?t="":Pt(i)?t=`>=${r}.0.0${n?"-0":""}`:Pt(o)?t=`>=${r}.${i}.0${n?"-0":""}`:s?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Pt(l)?c="":Pt(g)?c=`<${+l+1}.0.0-0`:Pt(v)?c=`<${l}.${+g+1}.0-0`:h?c=`<=${l}.${g}.${v}-${h}`:n?c=`<${l}.${g}.${+v+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),rC=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(Ke(n[r].semver),n[r].semver!==xs.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var wi=k((P_,fl)=>{var Ri=Symbol("SemVer ANY"),bi=class{static get ANY(){return Ri}constructor(e,t){if(t=iC(t),e instanceof bi){if(e.loose===!!t.loose)return e;e=e.value}qs("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Ri?this.value="":this.value=this.operator+this.semver.version,qs("comp",this)}parse(e){let t=this.options.loose?cl[ul.COMPARATORLOOSE]:cl[ul.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new ll(r[2],this.options.loose):this.semver=Ri}toString(){return this.value}test(e){if(qs("Comparator.test",e,this.options.loose),this.semver===Ri||e===Ri)return!0;if(typeof e=="string")try{e=new ll(e,this.options)}catch{return!1}return ks(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof bi))throw new TypeError("a Comparator is required");if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new dl(e.value,t).test(this.value);if(e.operator==="")return e.value===""?!0:new dl(this.value,t).test(e.semver);let r=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),o=this.semver.version===e.semver.version,s=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),a=ks(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=ks(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||i||o&&s||a||c}};fl.exports=bi;var iC=gi(),{re:cl,t:ul}=pr(),ks=_s(),qs=hi(),ll=Ct(),dl=Zt()});var Di=k((E_,pl)=>{var oC=Zt(),sC=(n,e,t)=>{try{e=new oC(e,t)}catch{return!1}return e.test(n)};pl.exports=sC});var gl=k((x_,hl)=>{var aC=Zt(),cC=(n,e)=>new aC(n,e).set.map(t=>t.map(r=>r.value).join(" ").trim().split(" "));hl.exports=cC});var vl=k((k_,ml)=>{var uC=Ct(),lC=Zt(),dC=(n,e,t)=>{let r=null,i=null,o=null;try{o=new lC(e,t)}catch{return null}return n.forEach(s=>{o.test(s)&&(!r||i.compare(s)===-1)&&(r=s,i=new uC(r,t))}),r};ml.exports=dC});var Cl=k((q_,yl)=>{var fC=Ct(),pC=Zt(),hC=(n,e,t)=>{let r=null,i=null,o=null;try{o=new pC(e,t)}catch{return null}return n.forEach(s=>{o.test(s)&&(!r||i.compare(s)===1)&&(r=s,i=new fC(r,t))}),r};yl.exports=hC});var bl=k((O_,Rl)=>{var Os=Ct(),gC=Zt(),wl=vi(),mC=(n,e)=>{n=new gC(n,e);let t=new Os("0.0.0");if(n.test(t)||(t=new Os("0.0.0-0"),n.test(t)))return t;t=null;for(let r=0;r<n.set.length;++r){let i=n.set[r],o=null;i.forEach(s=>{let a=new Os(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!o||wl(a,o))&&(o=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),o&&(!t||wl(t,o))&&(t=o)}return t&&n.test(t)?t:null};Rl.exports=mC});var Tl=k((I_,Dl)=>{var vC=Zt(),yC=(n,e)=>{try{return new vC(n,e).range||"*"}catch{return null}};Dl.exports=yC});var Co=k((N_,El)=>{var CC=Ct(),Pl=wi(),{ANY:wC}=Pl,RC=Zt(),bC=Di(),Sl=vi(),_l=po(),DC=go(),TC=ho(),SC=(n,e,t,r)=>{n=new CC(n,r),e=new RC(e,r);let i,o,s,a,c;switch(t){case">":i=Sl,o=DC,s=_l,a=">",c=">=";break;case"<":i=_l,o=TC,s=Sl,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(bC(n,e,r))return!1;for(let l=0;l<e.set.length;++l){let g=e.set[l],v=null,h=null;if(g.forEach(C=>{C.semver===wC&&(C=new Pl(">=0.0.0")),v=v||C,h=h||C,i(C.semver,v.semver,r)?v=C:s(C.semver,h.semver,r)&&(h=C)}),v.operator===a||v.operator===c||(!h.operator||h.operator===a)&&o(n,h.semver))return!1;if(h.operator===c&&s(n,h.semver))return!1}return!0};El.exports=SC});var kl=k((F_,xl)=>{var _C=Co(),PC=(n,e,t)=>_C(n,e,">",t);xl.exports=PC});var Ol=k((L_,ql)=>{var EC=Co(),xC=(n,e,t)=>EC(n,e,"<",t);ql.exports=xC});var Fl=k((A_,Nl)=>{var Il=Zt(),kC=(n,e,t)=>(n=new Il(n,t),e=new Il(e,t),n.intersects(e));Nl.exports=kC});var Al=k((M_,Ll)=>{var qC=Di(),OC=Yt();Ll.exports=(n,e,t)=>{let r=[],i=null,o=null,s=n.sort((g,v)=>OC(g,v,t));for(let g of s)qC(g,e,t)?(o=g,i||(i=g)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);let a=[];for(let[g,v]of r)g===v?a.push(g):!v&&g===s[0]?a.push("*"):v?g===s[0]?a.push(`<=${v}`):a.push(`${g} - ${v}`):a.push(`>=${g}`);let c=a.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var Wl=k((j_,Hl)=>{var Ml=Zt(),wo=wi(),{ANY:Is}=wo,Ti=Di(),Ns=Yt(),IC=(n,e,t={})=>{if(n===e)return!0;n=new Ml(n,t),e=new Ml(e,t);let r=!1;e:for(let i of n.set){for(let o of e.set){let s=NC(i,o,t);if(r=r||s!==null,s)continue e}if(r)return!1}return!0},NC=(n,e,t)=>{if(n===e)return!0;if(n.length===1&&n[0].semver===Is){if(e.length===1&&e[0].semver===Is)return!0;t.includePrerelease?n=[new wo(">=0.0.0-0")]:n=[new wo(">=0.0.0")]}if(e.length===1&&e[0].semver===Is){if(t.includePrerelease)return!0;e=[new wo(">=0.0.0")]}let r=new Set,i,o;for(let C of n)C.operator===">"||C.operator===">="?i=jl(i,C,t):C.operator==="<"||C.operator==="<="?o=$l(o,C,t):r.add(C.semver);if(r.size>1)return null;let s;if(i&&o){if(s=Ns(i.semver,o.semver,t),s>0)return null;if(s===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let C of r){if(i&&!Ti(C,String(i),t)||o&&!Ti(C,String(o),t))return null;for(let b of e)if(!Ti(C,String(b),t))return!1;return!0}let a,c,l,g,v=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1,h=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;v&&v.prerelease.length===1&&o.operator==="<"&&v.prerelease[0]===0&&(v=!1);for(let C of e){if(g=g||C.operator===">"||C.operator===">=",l=l||C.operator==="<"||C.operator==="<=",i){if(h&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===h.major&&C.semver.minor===h.minor&&C.semver.patch===h.patch&&(h=!1),C.operator===">"||C.operator===">="){if(a=jl(i,C,t),a===C&&a!==i)return!1}else if(i.operator===">="&&!Ti(i.semver,String(C),t))return!1}if(o){if(v&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===v.major&&C.semver.minor===v.minor&&C.semver.patch===v.patch&&(v=!1),C.operator==="<"||C.operator==="<="){if(c=$l(o,C,t),c===C&&c!==o)return!1}else if(o.operator==="<="&&!Ti(o.semver,String(C),t))return!1}if(!C.operator&&(o||i)&&s!==0)return!1}return!(i&&l&&!o&&s!==0||o&&g&&!i&&s!==0||h||v)},jl=(n,e,t)=>{if(!n)return e;let r=Ns(n.semver,e.semver,t);return r>0?n:r<0||e.operator===">"&&n.operator===">="?e:n},$l=(n,e,t)=>{if(!n)return e;let r=Ns(n.semver,e.semver,t);return r<0?n:r>0||e.operator==="<"&&n.operator==="<="?e:n};Hl.exports=IC});var Ul=k(($_,zl)=>{var Fs=pr();zl.exports={re:Fs.re,src:Fs.src,tokens:Fs.t,SEMVER_SPEC_VERSION:pi().SEMVER_SPEC_VERSION,SemVer:Ct(),compareIdentifiers:ao().compareIdentifiers,rcompareIdentifiers:ao().rcompareIdentifiers,parse:hr(),valid:lu(),clean:fu(),inc:hu(),diff:wu(),major:bu(),minor:Tu(),patch:_u(),prerelease:Eu(),compare:Yt(),rcompare:ku(),compareLoose:Ou(),compareBuild:fo(),sort:Lu(),rsort:Mu(),gt:vi(),lt:po(),eq:lo(),neq:Ss(),gte:ho(),lte:go(),cmp:_s(),coerce:Vu(),Comparator:wi(),Range:Zt(),satisfies:Di(),toComparators:gl(),maxSatisfying:vl(),minSatisfying:Cl(),minVersion:bl(),validRange:Tl(),outside:Co(),gtr:kl(),ltr:Ol(),intersects:Fl(),simplifyRange:Al(),subset:Wl()}});var wn=k(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.asPromise=We.thenable=We.typedArray=We.stringArray=We.array=We.func=We.error=We.number=We.string=We.boolean=void 0;function FC(n){return n===!0||n===!1}We.boolean=FC;function Kl(n){return typeof n=="string"||n instanceof String}We.string=Kl;function LC(n){return typeof n=="number"||n instanceof Number}We.number=LC;function AC(n){return n instanceof Error}We.error=AC;function Vl(n){return typeof n=="function"}We.func=Vl;function Bl(n){return Array.isArray(n)}We.array=Bl;function MC(n){return Bl(n)&&n.every(e=>Kl(e))}We.stringArray=MC;function jC(n,e){return Array.isArray(n)&&n.every(e)}We.typedArray=jC;function Gl(n){return n&&Vl(n.then)}We.thenable=Gl;function $C(n){return n instanceof Promise?n:Gl(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}We.asPromise=$C});var An=k(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});var Ls;function As(){if(Ls===void 0)throw new Error("No runtime abstraction layer installed");return Ls}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Ls=t}n.install=e})(As||(As={}));Ms.default=As});var js=k(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.Disposable=void 0;var HC;(function(n){function e(t){return{dispose:t}}n.create=e})(HC=Si.Disposable||(Si.Disposable={}))});var Ql=k(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.AbstractMessageBuffer=void 0;var WC=13,zC=10,UC=`\r
`,Xl=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(this._chunks.length===0)return;let e=0,t=0,r=0,i=0;e:for(;t<this._chunks.length;){let c=this._chunks[t];r=0;t:for(;r<c.length;){switch(c[r]){case WC:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case zC:switch(e){case 1:e=2;break;case 3:e=4,r++;break e;default:e=0}break;default:e=0}r++}i+=c.byteLength,t++}if(e!==4)return;let o=this._read(i+r),s=new Map,a=this.toString(o,"ascii").split(UC);if(a.length<2)return s;for(let c=0;c<a.length-2;c++){let l=a[c],g=l.indexOf(":");if(g===-1)throw new Error("Message header must separate key and value using :");let v=l.substr(0,g),h=l.substr(g+1).trim();s.set(v,h)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}};Ro.AbstractMessageBuffer=Xl});var td=k(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});var KC=An(),Jl=require("util"),yr=js(),VC=Ql(),_i=class extends VC.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return _i.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Jl.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};_i.emptyBuffer=Buffer.allocUnsafe(0);var Yl=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),yr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),yr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),yr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),yr.Disposable.create(()=>this.stream.off("data",e))}},Zl=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),yr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),yr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),yr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let o=s=>{s==null?r():i(s)};typeof e=="string"?this.stream.write(e,t,o):this.stream.write(e,o)})}end(){this.stream.end()}},ed=Object.freeze({messageBuffer:Object.freeze({create:n=>new _i(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new Jl.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new Yl(n),asWritableStream:n=>new Zl(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function $s(){return ed}(function(n){function e(){KC.default.install(ed)}n.install=e})($s||($s={}));Hs.default=$s});var Hr=k(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.stringArray=Rt.array=Rt.func=Rt.error=Rt.number=Rt.string=Rt.boolean=void 0;function BC(n){return n===!0||n===!1}Rt.boolean=BC;function nd(n){return typeof n=="string"||n instanceof String}Rt.string=nd;function GC(n){return typeof n=="number"||n instanceof Number}Rt.number=GC;function XC(n){return n instanceof Error}Rt.error=XC;function QC(n){return typeof n=="function"}Rt.func=QC;function rd(n){return Array.isArray(n)}Rt.array=rd;function JC(n){return rd(n)&&n.every(e=>nd(e))}Rt.stringArray=JC});var Ws=k(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.Message=Q.NotificationType9=Q.NotificationType8=Q.NotificationType7=Q.NotificationType6=Q.NotificationType5=Q.NotificationType4=Q.NotificationType3=Q.NotificationType2=Q.NotificationType1=Q.NotificationType0=Q.NotificationType=Q.RequestType9=Q.RequestType8=Q.RequestType7=Q.RequestType6=Q.RequestType5=Q.RequestType4=Q.RequestType3=Q.RequestType2=Q.RequestType1=Q.RequestType=Q.RequestType0=Q.AbstractMessageSignature=Q.ParameterStructures=Q.ResponseError=Q.ErrorCodes=void 0;var Cr=Hr(),id;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=n.jsonrpcReservedErrorRangeStart,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=n.jsonrpcReservedErrorRangeEnd})(id=Q.ErrorCodes||(Q.ErrorCodes={}));var bo=class extends Error{constructor(e,t,r){super(t);this.code=Cr.number(e)?e:id.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,bo.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};Q.ResponseError=bo;var dt=class{constructor(e){this.kind=e}static is(e){return e===dt.auto||e===dt.byName||e===dt.byPosition}toString(){return this.kind}};Q.ParameterStructures=dt;dt.auto=new dt("auto");dt.byPosition=new dt("byPosition");dt.byName=new dt("byName");var Ie=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return dt.auto}};Q.AbstractMessageSignature=Ie;var od=class extends Ie{constructor(e){super(e,0)}};Q.RequestType0=od;var sd=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType=sd;var ad=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType1=ad;var cd=class extends Ie{constructor(e){super(e,2)}};Q.RequestType2=cd;var ud=class extends Ie{constructor(e){super(e,3)}};Q.RequestType3=ud;var ld=class extends Ie{constructor(e){super(e,4)}};Q.RequestType4=ld;var dd=class extends Ie{constructor(e){super(e,5)}};Q.RequestType5=dd;var fd=class extends Ie{constructor(e){super(e,6)}};Q.RequestType6=fd;var pd=class extends Ie{constructor(e){super(e,7)}};Q.RequestType7=pd;var hd=class extends Ie{constructor(e){super(e,8)}};Q.RequestType8=hd;var gd=class extends Ie{constructor(e){super(e,9)}};Q.RequestType9=gd;var md=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType=md;var vd=class extends Ie{constructor(e){super(e,0)}};Q.NotificationType0=vd;var yd=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType1=yd;var Cd=class extends Ie{constructor(e){super(e,2)}};Q.NotificationType2=Cd;var wd=class extends Ie{constructor(e){super(e,3)}};Q.NotificationType3=wd;var Rd=class extends Ie{constructor(e){super(e,4)}};Q.NotificationType4=Rd;var bd=class extends Ie{constructor(e){super(e,5)}};Q.NotificationType5=bd;var Dd=class extends Ie{constructor(e){super(e,6)}};Q.NotificationType6=Dd;var Td=class extends Ie{constructor(e){super(e,7)}};Q.NotificationType7=Td;var Sd=class extends Ie{constructor(e){super(e,8)}};Q.NotificationType8=Sd;var _d=class extends Ie{constructor(e){super(e,9)}};Q.NotificationType9=_d;var YC;(function(n){function e(i){let o=i;return o&&Cr.string(o.method)&&(Cr.string(o.id)||Cr.number(o.id))}n.isRequest=e;function t(i){let o=i;return o&&Cr.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(Cr.string(o.id)||Cr.number(o.id)||o.id===null)}n.isResponse=r})(YC=Q.Message||(Q.Message={}))});var Us=k(Mn=>{"use strict";var Pd;Object.defineProperty(Mn,"__esModule",{value:!0});Mn.LRUCache=Mn.LinkedMap=Mn.Touch=void 0;var Et;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Et=Mn.Touch||(Mn.Touch={}));var zs=class{constructor(){this[Pd]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Et.None){let r=this._map.get(e);if(!!r)return t!==Et.None&&this.touch(r,t),r.value}set(e,t,r=Et.None){let i=this._map.get(e);if(i)i.value=t,r!==Et.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Et.None:this.addItemLast(i);break;case Et.First:this.addItemFirst(i);break;case Et.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Pd=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Et.First&&t!==Et.Last)){if(t===Et.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Et.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};Mn.LinkedMap=zs;var Ed=class extends zs{constructor(e,t=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Et.AsNew){return super.get(e,t)}peek(e){return super.get(e,Et.None)}set(e,t){return super.set(e,t,Et.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Mn.LRUCache=Ed});var Wr=k(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.Emitter=wr.Event=void 0;var ZC=An(),ew;(function(n){let e={dispose(){}};n.None=function(){return e}})(ew=wr.Event||(wr.Event={}));var xd=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(a){(0,ZC.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Pi=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new xd),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{!this._callbacks||(this._callbacks.remove(e,t),i.dispose=Pi._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};wr.Emitter=Pi;Pi._noop=function(){}});var Gs=k(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.CancellationTokenSource=Rr.CancellationToken=void 0;var tw=An(),nw=Hr(),Ks=Wr(),Vs;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ks.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Ks.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||nw.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(Vs=Rr.CancellationToken||(Rr.CancellationToken={}));var rw=Object.freeze(function(n,e){let t=(0,tw.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),Bs=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?rw:(this._emitter||(this._emitter=new Ks.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},kd=class{get token(){return this._token||(this._token=new Bs),this._token}cancel(){this._token?this._token.cancel():this._token=Vs.Cancelled}dispose(){this._token?this._token instanceof Bs&&this._token.dispose():this._token=Vs.None}};Rr.CancellationTokenSource=kd});var Od=k(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.ReadableStreamMessageReader=jn.AbstractMessageReader=jn.MessageReader=void 0;var Qs=An(),zr=Hr(),Xs=Wr(),iw;(function(n){function e(t){let r=t;return r&&zr.func(r.listen)&&zr.func(r.dispose)&&zr.func(r.onError)&&zr.func(r.onClose)&&zr.func(r.onPartialMessage)}n.is=e})(iw=jn.MessageReader||(jn.MessageReader={}));var Ys=class{constructor(){this.errorEmitter=new Xs.Emitter,this.closeEmitter=new Xs.Emitter,this.partialMessageEmitter=new Xs.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${zr.string(e.message)?e.message:"unknown"}`)}};jn.AbstractMessageReader=Ys;var Js;(function(n){function e(t){let r,i,o,s=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,s.set(o.name,o)),t.contentDecoders!==void 0)for(let l of t.contentDecoders)s.set(l.name,l);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let l of t.contentTypeDecoders)c.set(l.name,l)}return a===void 0&&(a=(0,Qs.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:o,contentDecoders:s,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(Js||(Js={}));var qd=class extends Ys{constructor(e,t){super();this.readable=e,this.options=Js.fromOptions(t),this.buffer=(0,Qs.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders();if(!i)return;let o=i.get("Content-Length");if(!o)throw new Error("Header must provide a Content-Length property.");let s=parseInt(o);if(isNaN(s))throw new Error("Content-Length value must be a number.");this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1;let r;this.options.contentDecoder!==void 0?r=this.options.contentDecoder.decode(t):r=Promise.resolve(t),r.then(i=>{this.options.contentTypeDecoder.decode(i,this.options).then(o=>{this.callback(o)},o=>{this.fireError(o)})},i=>{this.fireError(i)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Qs.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};jn.ReadableStreamMessageReader=qd});var Nd=k(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.Semaphore=void 0;var ow=An(),Id=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,ow.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Do.Semaphore=Id});var jd=k($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.WriteableStreamMessageWriter=$n.AbstractMessageWriter=$n.MessageWriter=void 0;var Fd=An(),Ei=Hr(),sw=Nd(),Ld=Wr(),aw="Content-Length: ",Ad=`\r
`,cw;(function(n){function e(t){let r=t;return r&&Ei.func(r.dispose)&&Ei.func(r.onClose)&&Ei.func(r.onError)&&Ei.func(r.write)}n.is=e})(cw=$n.MessageWriter||($n.MessageWriter={}));var ea=class{constructor(){this.errorEmitter=new Ld.Emitter,this.closeEmitter=new Ld.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Ei.string(e.message)?e.message:"unknown"}`)}};$n.AbstractMessageWriter=ea;var Zs;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Fd.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Fd.default)().applicationJson.encoder}}n.fromOptions=e})(Zs||(Zs={}));var Md=class extends ea{constructor(e,t){super();this.writable=e,this.options=Zs.fromOptions(t),this.errorCount=0,this.writeSemaphore=new sw.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(aw,r.byteLength.toString(),Ad),i.push(Ad),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};$n.WriteableStreamMessageWriter=Md});var Vd=k(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.createMessageConnection=Y.ConnectionOptions=Y.CancellationStrategy=Y.CancellationSenderStrategy=Y.CancellationReceiverStrategy=Y.ConnectionStrategy=Y.ConnectionError=Y.ConnectionErrors=Y.LogTraceNotification=Y.SetTraceNotification=Y.TraceFormat=Y.Trace=Y.NullLogger=Y.ProgressType=Y.ProgressToken=void 0;var $d=An(),nt=Hr(),ee=Ws(),Hd=Us(),xi=Wr(),ta=Gs(),qi;(function(n){n.type=new ee.NotificationType("$/cancelRequest")})(qi||(qi={}));var Wd;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(Wd=Y.ProgressToken||(Y.ProgressToken={}));var ki;(function(n){n.type=new ee.NotificationType("$/progress")})(ki||(ki={}));var zd=class{constructor(){}};Y.ProgressType=zd;var na;(function(n){function e(t){return nt.func(t)}n.is=e})(na||(na={}));Y.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var be;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(be=Y.Trace||(Y.Trace={}));(function(n){function e(r){if(!nt.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(be=Y.Trace||(Y.Trace={}));var cn;(function(n){n.Text="text",n.JSON="json"})(cn=Y.TraceFormat||(Y.TraceFormat={}));(function(n){function e(t){return nt.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(cn=Y.TraceFormat||(Y.TraceFormat={}));var Ud;(function(n){n.type=new ee.NotificationType("$/setTrace")})(Ud=Y.SetTraceNotification||(Y.SetTraceNotification={}));var ra;(function(n){n.type=new ee.NotificationType("$/logTrace")})(ra=Y.LogTraceNotification||(Y.LogTraceNotification={}));var To;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(To=Y.ConnectionErrors||(Y.ConnectionErrors={}));var br=class extends Error{constructor(e,t){super(t);this.code=e,Object.setPrototypeOf(this,br.prototype)}};Y.ConnectionError=br;var Kd;(function(n){function e(t){let r=t;return r&&nt.func(r.cancelUndispatched)}n.is=e})(Kd=Y.ConnectionStrategy||(Y.ConnectionStrategy={}));var ia;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new ta.CancellationTokenSource}});function e(t){let r=t;return r&&nt.func(r.createCancellationTokenSource)}n.is=e})(ia=Y.CancellationReceiverStrategy||(Y.CancellationReceiverStrategy={}));var oa;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(qi.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&nt.func(r.sendCancellation)&&nt.func(r.cleanup)}n.is=e})(oa=Y.CancellationSenderStrategy||(Y.CancellationSenderStrategy={}));var sa;(function(n){n.Message=Object.freeze({receiver:ia.Message,sender:oa.Message});function e(t){let r=t;return r&&ia.is(r.receiver)&&oa.is(r.sender)}n.is=e})(sa=Y.CancellationStrategy||(Y.CancellationStrategy={}));var uw;(function(n){function e(t){let r=t;return r&&(sa.is(r.cancellationStrategy)||Kd.is(r.connectionStrategy))}n.is=e})(uw=Y.ConnectionOptions||(Y.ConnectionOptions={}));var un;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(un||(un={}));function lw(n,e,t,r){let i=t!==void 0?t:Y.NullLogger,o=0,s=0,a=0,c="2.0",l,g=new Map,v,h=new Map,C=new Map,b,x=new Hd.LinkedMap,q=new Map,O=new Set,I=new Map,N=be.Off,$=cn.Text,K,de=un.New,se=new xi.Emitter,He=new xi.Emitter,Ge=new xi.Emitter,rt=new xi.Emitter,Tt=new xi.Emitter,gt=r&&r.cancellationStrategy?r.cancellationStrategy:sa.Message;function mt(R){if(R===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+R.toString()}function St(R){return R===null?"res-unknown-"+(++a).toString():"res-"+R.toString()}function at(){return"not-"+(++s).toString()}function vt(R,F){ee.Message.isRequest(F)?R.set(mt(F.id),F):ee.Message.isResponse(F)?R.set(St(F.id),F):R.set(at(),F)}function xn(R){}function Le(){return de===un.Listening}function tt(){return de===un.Closed}function ct(){return de===un.Disposed}function Ft(){(de===un.New||de===un.Listening)&&(de=un.Closed,He.fire(void 0))}function Xe(R){se.fire([R,void 0,void 0])}function ur(R){se.fire(R)}n.onClose(Ft),n.onError(Xe),e.onClose(Ft),e.onError(ur);function Vn(){b||x.size===0||(b=(0,$d.default)().timer.setImmediate(()=>{b=void 0,Bn()}))}function Bn(){if(x.size===0)return;let R=x.shift();try{ee.Message.isRequest(R)?qn(R):ee.Message.isNotification(R)?Gn(R):ee.Message.isResponse(R)?lr(R):Xn(R)}finally{Vn()}}let kn=R=>{try{if(ee.Message.isNotification(R)&&R.method===qi.type.method){let F=R.params.id,H=mt(F),V=x.get(H);if(ee.Message.isRequest(V)){let ge=r==null?void 0:r.connectionStrategy,me=ge&&ge.cancelUndispatched?ge.cancelUndispatched(V,xn):void 0;if(me&&(me.error!==void 0||me.result!==void 0)){x.delete(H),I.delete(F),me.id=V.id,Mt(me,R.method,Date.now()),e.write(me).catch(()=>i.error("Sending response for canceled message failed."));return}}let he=I.get(F);if(he!==void 0){he.cancel(),yn(R);return}else O.add(F)}vt(x,R)}finally{Vn()}};function qn(R){if(ct())return;function F(ce,Ce,ue){let p={jsonrpc:c,id:R.id};ce instanceof ee.ResponseError?p.error=ce.toJson():p.result=ce===void 0?null:ce,Mt(p,Ce,ue),e.write(p).catch(()=>i.error("Sending response failed."))}function H(ce,Ce,ue){let p={jsonrpc:c,id:R.id,error:ce.toJson()};Mt(p,Ce,ue),e.write(p).catch(()=>i.error("Sending response failed."))}function V(ce,Ce,ue){ce===void 0&&(ce=null);let p={jsonrpc:c,id:R.id,result:ce};Mt(p,Ce,ue),e.write(p).catch(()=>i.error("Sending response failed."))}On(R);let he=g.get(R.method),ge,me;he&&(ge=he.type,me=he.handler);let ke=Date.now();if(me||l){let ce=R.id??String(Date.now()),Ce=gt.receiver.createCancellationTokenSource(ce);R.id!==null&&O.has(R.id)&&Ce.cancel(),R.id!==null&&I.set(ce,Ce);try{let ue;if(me)if(R.params===void 0){if(ge!==void 0&&ge.numberOfParams!==0){H(new ee.ResponseError(ee.ErrorCodes.InvalidParams,`Request ${R.method} defines ${ge.numberOfParams} params but received none.`),R.method,ke);return}ue=me(Ce.token)}else if(Array.isArray(R.params)){if(ge!==void 0&&ge.parameterStructures===ee.ParameterStructures.byName){H(new ee.ResponseError(ee.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by name but received parameters by position`),R.method,ke);return}ue=me(...R.params,Ce.token)}else{if(ge!==void 0&&ge.parameterStructures===ee.ParameterStructures.byPosition){H(new ee.ResponseError(ee.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by position but received parameters by name`),R.method,ke);return}ue=me(R.params,Ce.token)}else l&&(ue=l(R.method,R.params,Ce.token));let p=ue;ue?p.then?p.then(E=>{I.delete(ce),F(E,R.method,ke)},E=>{I.delete(ce),E instanceof ee.ResponseError?H(E,R.method,ke):E&&nt.string(E.message)?H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${E.message}`),R.method,ke):H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,ke)}):(I.delete(ce),F(ue,R.method,ke)):(I.delete(ce),V(ue,R.method,ke))}catch(ue){I.delete(ce),ue instanceof ee.ResponseError?F(ue,R.method,ke):ue&&nt.string(ue.message)?H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${ue.message}`),R.method,ke):H(new ee.ResponseError(ee.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,ke)}}else H(new ee.ResponseError(ee.ErrorCodes.MethodNotFound,`Unhandled method ${R.method}`),R.method,ke)}function lr(R){if(!ct())if(R.id===null)R.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(R.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let F=R.id,H=q.get(F);if(jt(R,H),H!==void 0){q.delete(F);try{if(R.error){let V=R.error;H.reject(new ee.ResponseError(V.code,V.message,V.data))}else if(R.result!==void 0)H.resolve(R.result);else throw new Error("Should never happen.")}catch(V){V.message?i.error(`Response handler '${H.method}' failed with message: ${V.message}`):i.error(`Response handler '${H.method}' failed unexpectedly.`)}}}}function Gn(R){if(ct())return;let F,H;if(R.method===qi.type.method){let V=R.params.id;O.delete(V),yn(R);return}else{let V=h.get(R.method);V&&(H=V.handler,F=V.type)}if(H||v)try{if(yn(R),H)if(R.params===void 0)F!==void 0&&F.numberOfParams!==0&&F.parameterStructures!==ee.ParameterStructures.byName&&i.error(`Notification ${R.method} defines ${F.numberOfParams} params but received none.`),H();else if(Array.isArray(R.params)){let V=R.params;R.method===ki.type.method&&V.length===2&&Wd.is(V[0])?H({token:V[0],value:V[1]}):(F!==void 0&&(F.parameterStructures===ee.ParameterStructures.byName&&i.error(`Notification ${R.method} defines parameters by name but received parameters by position`),F.numberOfParams!==R.params.length&&i.error(`Notification ${R.method} defines ${F.numberOfParams} params but received ${V.length} arguments`)),H(...V))}else F!==void 0&&F.parameterStructures===ee.ParameterStructures.byPosition&&i.error(`Notification ${R.method} defines parameters by position but received parameters by name`),H(R.params);else v&&v(R.method,R.params)}catch(V){V.message?i.error(`Notification handler '${R.method}' failed with message: ${V.message}`):i.error(`Notification handler '${R.method}' failed unexpectedly.`)}else Ge.fire(R)}function Xn(R){if(!R){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(R,null,4)}`);let F=R;if(nt.string(F.id)||nt.number(F.id)){let H=F.id,V=q.get(H);V&&V.reject(new Error("The received response has neither a result nor an error property."))}}function yt(R){if(R!=null)switch(N){case be.Verbose:return JSON.stringify(R,null,4);case be.Compact:return JSON.stringify(R);default:return}}function Gt(R){if(!(N===be.Off||!K))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&R.params&&(F=`Params: ${yt(R.params)}

`),K.log(`Sending request '${R.method} - (${R.id})'.`,F)}else Lt("send-request",R)}function Qn(R){if(!(N===be.Off||!K))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&(R.params?F=`Params: ${yt(R.params)}

`:F=`No parameters provided.

`),K.log(`Sending notification '${R.method}'.`,F)}else Lt("send-notification",R)}function Mt(R,F,H){if(!(N===be.Off||!K))if($===cn.Text){let V;(N===be.Verbose||N===be.Compact)&&(R.error&&R.error.data?V=`Error data: ${yt(R.error.data)}

`:R.result?V=`Result: ${yt(R.result)}

`:R.error===void 0&&(V=`No result returned.

`)),K.log(`Sending response '${F} - (${R.id})'. Processing request took ${Date.now()-H}ms`,V)}else Lt("send-response",R)}function On(R){if(!(N===be.Off||!K))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&R.params&&(F=`Params: ${yt(R.params)}

`),K.log(`Received request '${R.method} - (${R.id})'.`,F)}else Lt("receive-request",R)}function yn(R){if(!(N===be.Off||!K||R.method===ra.type.method))if($===cn.Text){let F;(N===be.Verbose||N===be.Compact)&&(R.params?F=`Params: ${yt(R.params)}

`:F=`No parameters provided.

`),K.log(`Received notification '${R.method}'.`,F)}else Lt("receive-notification",R)}function jt(R,F){if(!(N===be.Off||!K))if($===cn.Text){let H;if((N===be.Verbose||N===be.Compact)&&(R.error&&R.error.data?H=`Error data: ${yt(R.error.data)}

`:R.result?H=`Result: ${yt(R.result)}

`:R.error===void 0&&(H=`No result returned.

`)),F){let V=R.error?` Request failed: ${R.error.message} (${R.error.code}).`:"";K.log(`Received response '${F.method} - (${R.id})' in ${Date.now()-F.timerStart}ms.${V}`,H)}else K.log(`Received response ${R.id} without active response promise.`,H)}else Lt("receive-response",R)}function Lt(R,F){if(!K||N===be.Off)return;let H={isLSPMessage:!0,type:R,message:F,timestamp:Date.now()};K.log(H)}function Qe(){if(tt())throw new br(To.Closed,"Connection is closed.");if(ct())throw new br(To.Disposed,"Connection is disposed.")}function dr(){if(Le())throw new br(To.AlreadyListening,"Connection is already listening")}function _t(){if(!Le())throw new Error("Call listen() first.")}function $t(R){return R===void 0?null:R}function Cn(R){if(R!==null)return R}function In(R){return R!=null&&!Array.isArray(R)&&typeof R=="object"}function Nn(R,F){switch(R){case ee.ParameterStructures.auto:return In(F)?Cn(F):[$t(F)];case ee.ParameterStructures.byName:if(!In(F))throw new Error("Received parameters by name but param is not an object literal.");return Cn(F);case ee.ParameterStructures.byPosition:return[$t(F)];default:throw new Error(`Unknown parameter structure ${R.toString()}`)}}function Ht(R,F){let H,V=R.numberOfParams;switch(V){case 0:H=void 0;break;case 1:H=Nn(R.parameterStructures,F[0]);break;default:H=[];for(let he=0;he<F.length&&he<V;he++)H.push($t(F[he]));if(F.length<V)for(let he=F.length;he<V;he++)H.push(null);break}return H}let Xt={sendNotification:(R,...F)=>{Qe();let H,V;if(nt.string(R)){H=R;let ge=F[0],me=0,ke=ee.ParameterStructures.auto;ee.ParameterStructures.is(ge)&&(me=1,ke=ge);let ce=F.length,Ce=ce-me;switch(Ce){case 0:V=void 0;break;case 1:V=Nn(ke,F[me]);break;default:if(ke===ee.ParameterStructures.byName)throw new Error(`Received ${Ce} parameters for 'by Name' notification parameter structure.`);V=F.slice(me,ce).map(ue=>$t(ue));break}}else{let ge=F;H=R.method,V=Ht(R,ge)}let he={jsonrpc:c,method:H,params:V};return Qn(he),e.write(he).catch(()=>i.error("Sending notification failed."))},onNotification:(R,F)=>{Qe();let H;return nt.func(R)?v=R:F&&(nt.string(R)?(H=R,h.set(R,{type:void 0,handler:F})):(H=R.method,h.set(R.method,{type:R,handler:F}))),{dispose:()=>{H!==void 0?h.delete(H):v=void 0}}},onProgress:(R,F,H)=>{if(C.has(F))throw new Error(`Progress handler for token ${F} already registered`);return C.set(F,H),{dispose:()=>{C.delete(F)}}},sendProgress:(R,F,H)=>Xt.sendNotification(ki.type,{token:F,value:H}),onUnhandledProgress:rt.event,sendRequest:(R,...F)=>{Qe(),_t();let H,V,he;if(nt.string(R)){H=R;let ce=F[0],Ce=F[F.length-1],ue=0,p=ee.ParameterStructures.auto;ee.ParameterStructures.is(ce)&&(ue=1,p=ce);let E=F.length;ta.CancellationToken.is(Ce)&&(E=E-1,he=Ce);let z=E-ue;switch(z){case 0:V=void 0;break;case 1:V=Nn(p,F[ue]);break;default:if(p===ee.ParameterStructures.byName)throw new Error(`Received ${z} parameters for 'by Name' request parameter structure.`);V=F.slice(ue,E).map(S=>$t(S));break}}else{let ce=F;H=R.method,V=Ht(R,ce);let Ce=R.numberOfParams;he=ta.CancellationToken.is(ce[Ce])?ce[Ce]:void 0}let ge=o++,me;return he&&(me=he.onCancellationRequested(()=>{let ce=gt.sender.sendCancellation(Xt,ge);return ce===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${ge}`),Promise.resolve()):ce.catch(()=>{i.log(`Sending cancellation messages for id ${ge} failed`)})})),new Promise((ce,Ce)=>{let ue={jsonrpc:c,id:ge,method:H,params:V},p=S=>{ce(S),gt.sender.cleanup(ge),me==null||me.dispose()},E=S=>{Ce(S),gt.sender.cleanup(ge),me==null||me.dispose()},z={method:H,timerStart:Date.now(),resolve:p,reject:E};Gt(ue);try{e.write(ue).catch(()=>i.error("Sending request failed."))}catch(S){z.reject(new ee.ResponseError(ee.ErrorCodes.MessageWriteError,S.message?S.message:"Unknown reason")),z=null}z&&q.set(ge,z)})},onRequest:(R,F)=>{Qe();let H=null;return na.is(R)?(H=void 0,l=R):nt.string(R)?(H=null,F!==void 0&&(H=R,g.set(R,{handler:F,type:void 0}))):F!==void 0&&(H=R.method,g.set(R.method,{type:R,handler:F})),{dispose:()=>{H!==null&&(H!==void 0?g.delete(H):l=void 0)}}},trace:(R,F,H)=>{let V=!1,he=cn.Text;H!==void 0&&(nt.boolean(H)?V=H:(V=H.sendNotification||!1,he=H.traceFormat||cn.Text)),N=R,$=he,N===be.Off?K=void 0:K=F,V&&!tt()&&!ct()&&Xt.sendNotification(Ud.type,{value:be.toString(R)}).catch(()=>{i.error("Sending trace notification failed")})},onError:se.event,onClose:He.event,onUnhandledNotification:Ge.event,onDispose:Tt.event,end:()=>{e.end()},dispose:()=>{if(ct())return;de=un.Disposed,Tt.fire(void 0);let R=new Error("Connection got disposed.");for(let F of q.values())F.reject(R);q=new Map,I=new Map,O=new Set,x=new Hd.LinkedMap,nt.func(e.dispose)&&e.dispose(),nt.func(n.dispose)&&n.dispose()},listen:()=>{Qe(),dr(),de=un.Listening,n.listen(kn)},inspect:()=>{(0,$d.default)().console.log("inspect")}};return Xt.onNotification(ra.type,R=>{if(N===be.Off||!K)return;let F=N===be.Verbose||N===be.Compact;K.log(R.message,F?R.verbose:void 0)}),Xt.onNotification(ki.type,R=>{let F=C.get(R.token);F?F(R.value):rt.fire(R)}),Xt}Y.createMessageConnection=lw});var la=k(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.SetTraceNotification=A.TraceFormat=A.Trace=A.ProgressType=A.ProgressToken=A.createMessageConnection=A.NullLogger=A.ConnectionOptions=A.ConnectionStrategy=A.WriteableStreamMessageWriter=A.AbstractMessageWriter=A.MessageWriter=A.ReadableStreamMessageReader=A.AbstractMessageReader=A.MessageReader=A.CancellationToken=A.CancellationTokenSource=A.Emitter=A.Event=A.Disposable=A.LRUCache=A.Touch=A.LinkedMap=A.ParameterStructures=A.NotificationType9=A.NotificationType8=A.NotificationType7=A.NotificationType6=A.NotificationType5=A.NotificationType4=A.NotificationType3=A.NotificationType2=A.NotificationType1=A.NotificationType0=A.NotificationType=A.ErrorCodes=A.ResponseError=A.RequestType9=A.RequestType8=A.RequestType7=A.RequestType6=A.RequestType5=A.RequestType4=A.RequestType3=A.RequestType2=A.RequestType1=A.RequestType0=A.RequestType=A.Message=A.RAL=void 0;A.CancellationStrategy=A.CancellationSenderStrategy=A.CancellationReceiverStrategy=A.ConnectionError=A.ConnectionErrors=A.LogTraceNotification=void 0;var Ee=Ws();Object.defineProperty(A,"Message",{enumerable:!0,get:function(){return Ee.Message}});Object.defineProperty(A,"RequestType",{enumerable:!0,get:function(){return Ee.RequestType}});Object.defineProperty(A,"RequestType0",{enumerable:!0,get:function(){return Ee.RequestType0}});Object.defineProperty(A,"RequestType1",{enumerable:!0,get:function(){return Ee.RequestType1}});Object.defineProperty(A,"RequestType2",{enumerable:!0,get:function(){return Ee.RequestType2}});Object.defineProperty(A,"RequestType3",{enumerable:!0,get:function(){return Ee.RequestType3}});Object.defineProperty(A,"RequestType4",{enumerable:!0,get:function(){return Ee.RequestType4}});Object.defineProperty(A,"RequestType5",{enumerable:!0,get:function(){return Ee.RequestType5}});Object.defineProperty(A,"RequestType6",{enumerable:!0,get:function(){return Ee.RequestType6}});Object.defineProperty(A,"RequestType7",{enumerable:!0,get:function(){return Ee.RequestType7}});Object.defineProperty(A,"RequestType8",{enumerable:!0,get:function(){return Ee.RequestType8}});Object.defineProperty(A,"RequestType9",{enumerable:!0,get:function(){return Ee.RequestType9}});Object.defineProperty(A,"ResponseError",{enumerable:!0,get:function(){return Ee.ResponseError}});Object.defineProperty(A,"ErrorCodes",{enumerable:!0,get:function(){return Ee.ErrorCodes}});Object.defineProperty(A,"NotificationType",{enumerable:!0,get:function(){return Ee.NotificationType}});Object.defineProperty(A,"NotificationType0",{enumerable:!0,get:function(){return Ee.NotificationType0}});Object.defineProperty(A,"NotificationType1",{enumerable:!0,get:function(){return Ee.NotificationType1}});Object.defineProperty(A,"NotificationType2",{enumerable:!0,get:function(){return Ee.NotificationType2}});Object.defineProperty(A,"NotificationType3",{enumerable:!0,get:function(){return Ee.NotificationType3}});Object.defineProperty(A,"NotificationType4",{enumerable:!0,get:function(){return Ee.NotificationType4}});Object.defineProperty(A,"NotificationType5",{enumerable:!0,get:function(){return Ee.NotificationType5}});Object.defineProperty(A,"NotificationType6",{enumerable:!0,get:function(){return Ee.NotificationType6}});Object.defineProperty(A,"NotificationType7",{enumerable:!0,get:function(){return Ee.NotificationType7}});Object.defineProperty(A,"NotificationType8",{enumerable:!0,get:function(){return Ee.NotificationType8}});Object.defineProperty(A,"NotificationType9",{enumerable:!0,get:function(){return Ee.NotificationType9}});Object.defineProperty(A,"ParameterStructures",{enumerable:!0,get:function(){return Ee.ParameterStructures}});var aa=Us();Object.defineProperty(A,"LinkedMap",{enumerable:!0,get:function(){return aa.LinkedMap}});Object.defineProperty(A,"LRUCache",{enumerable:!0,get:function(){return aa.LRUCache}});Object.defineProperty(A,"Touch",{enumerable:!0,get:function(){return aa.Touch}});var dw=js();Object.defineProperty(A,"Disposable",{enumerable:!0,get:function(){return dw.Disposable}});var Bd=Wr();Object.defineProperty(A,"Event",{enumerable:!0,get:function(){return Bd.Event}});Object.defineProperty(A,"Emitter",{enumerable:!0,get:function(){return Bd.Emitter}});var Gd=Gs();Object.defineProperty(A,"CancellationTokenSource",{enumerable:!0,get:function(){return Gd.CancellationTokenSource}});Object.defineProperty(A,"CancellationToken",{enumerable:!0,get:function(){return Gd.CancellationToken}});var ca=Od();Object.defineProperty(A,"MessageReader",{enumerable:!0,get:function(){return ca.MessageReader}});Object.defineProperty(A,"AbstractMessageReader",{enumerable:!0,get:function(){return ca.AbstractMessageReader}});Object.defineProperty(A,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return ca.ReadableStreamMessageReader}});var ua=jd();Object.defineProperty(A,"MessageWriter",{enumerable:!0,get:function(){return ua.MessageWriter}});Object.defineProperty(A,"AbstractMessageWriter",{enumerable:!0,get:function(){return ua.AbstractMessageWriter}});Object.defineProperty(A,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return ua.WriteableStreamMessageWriter}});var xt=Vd();Object.defineProperty(A,"ConnectionStrategy",{enumerable:!0,get:function(){return xt.ConnectionStrategy}});Object.defineProperty(A,"ConnectionOptions",{enumerable:!0,get:function(){return xt.ConnectionOptions}});Object.defineProperty(A,"NullLogger",{enumerable:!0,get:function(){return xt.NullLogger}});Object.defineProperty(A,"createMessageConnection",{enumerable:!0,get:function(){return xt.createMessageConnection}});Object.defineProperty(A,"ProgressToken",{enumerable:!0,get:function(){return xt.ProgressToken}});Object.defineProperty(A,"ProgressType",{enumerable:!0,get:function(){return xt.ProgressType}});Object.defineProperty(A,"Trace",{enumerable:!0,get:function(){return xt.Trace}});Object.defineProperty(A,"TraceFormat",{enumerable:!0,get:function(){return xt.TraceFormat}});Object.defineProperty(A,"SetTraceNotification",{enumerable:!0,get:function(){return xt.SetTraceNotification}});Object.defineProperty(A,"LogTraceNotification",{enumerable:!0,get:function(){return xt.LogTraceNotification}});Object.defineProperty(A,"ConnectionErrors",{enumerable:!0,get:function(){return xt.ConnectionErrors}});Object.defineProperty(A,"ConnectionError",{enumerable:!0,get:function(){return xt.ConnectionError}});Object.defineProperty(A,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return xt.CancellationReceiverStrategy}});Object.defineProperty(A,"CancellationSenderStrategy",{enumerable:!0,get:function(){return xt.CancellationSenderStrategy}});Object.defineProperty(A,"CancellationStrategy",{enumerable:!0,get:function(){return xt.CancellationStrategy}});var fw=An();A.RAL=fw.default});var Dr=k(we=>{"use strict";var pw=we&&we.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),hw=we&&we.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pw(e,n,t)};Object.defineProperty(we,"__esModule",{value:!0});we.createMessageConnection=we.createServerSocketTransport=we.createClientSocketTransport=we.createServerPipeTransport=we.createClientPipeTransport=we.generateRandomPipeName=we.StreamMessageWriter=we.StreamMessageReader=we.SocketMessageWriter=we.SocketMessageReader=we.IPCMessageWriter=we.IPCMessageReader=void 0;var Ur=td();Ur.default.install();var Rn=la(),Xd=require("path"),gw=require("os"),mw=require("crypto"),So=require("net");hw(la(),we);var Jd=class extends Rn.AbstractMessageReader{constructor(e){super();this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),Rn.Disposable.create(()=>this.process.off("message",e))}};we.IPCMessageReader=Jd;var Yd=class extends Rn.AbstractMessageWriter{constructor(e){super();this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};we.IPCMessageWriter=Yd;var Kr=class extends Rn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,Ur.default)().stream.asReadableStream(e),t)}};we.SocketMessageReader=Kr;var Vr=class extends Rn.WriteableStreamMessageWriter{constructor(e,t){super((0,Ur.default)().stream.asWritableStream(e),t);this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};we.SocketMessageWriter=Vr;var da=class extends Rn.ReadableStreamMessageReader{constructor(e,t){super((0,Ur.default)().stream.asReadableStream(e),t)}};we.StreamMessageReader=da;var fa=class extends Rn.WriteableStreamMessageWriter{constructor(e,t){super((0,Ur.default)().stream.asWritableStream(e),t)}};we.StreamMessageWriter=fa;var Qd=process.env.XDG_RUNTIME_DIR,vw=new Map([["linux",107],["darwin",103]]);function yw(){let n=(0,mw.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;Qd?e=Xd.join(Qd,`vscode-ipc-${n}.sock`):e=Xd.join(gw.tmpdir(),`vscode-${n}.sock`);let t=vw.get(process.platform);return t!==void 0&&e.length>=t&&(0,Ur.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}we.generateRandomPipeName=yw;function Cw(n,e="utf-8"){let t,r=new Promise((i,o)=>{t=i});return new Promise((i,o)=>{let s=(0,So.createServer)(a=>{s.close(),t([new Kr(a,e),new Vr(a,e)])});s.on("error",o),s.listen(n,()=>{s.removeListener("error",o),i({onConnected:()=>r})})})}we.createClientPipeTransport=Cw;function ww(n,e="utf-8"){let t=(0,So.createConnection)(n);return[new Kr(t,e),new Vr(t,e)]}we.createServerPipeTransport=ww;function Rw(n,e="utf-8"){let t,r=new Promise((i,o)=>{t=i});return new Promise((i,o)=>{let s=(0,So.createServer)(a=>{s.close(),t([new Kr(a,e),new Vr(a,e)])});s.on("error",o),s.listen(n,"127.0.0.1",()=>{s.removeListener("error",o),i({onConnected:()=>r})})})}we.createClientSocketTransport=Rw;function bw(n,e="utf-8"){let t=(0,So.createConnection)(n,"127.0.0.1");return[new Kr(t,e),new Vr(t,e)]}we.createServerSocketTransport=bw;function Dw(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function Tw(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function Sw(n,e,t,r){t||(t=Rn.NullLogger);let i=Dw(n)?new da(n):n,o=Tw(e)?new fa(e):e;return Rn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Rn.createMessageConnection)(i,o,t,r)}we.createMessageConnection=Sw});var pa=k((rP,Zd)=>{"use strict";Zd.exports=Dr()});var ha=k((ef,_o)=>{(function(n){if(typeof _o=="object"&&typeof _o.exports=="object"){var e=n(require,ef);e!==void 0&&(_o.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(f){function D(T){return typeof T=="string"}f.is=D})(t=e.DocumentUri||(e.DocumentUri={}));var r;(function(f){function D(T){return typeof T=="string"}f.is=D})(r=e.URI||(e.URI={}));var i;(function(f){f.MIN_VALUE=-2147483648,f.MAX_VALUE=2147483647;function D(T){return typeof T=="number"&&f.MIN_VALUE<=T&&T<=f.MAX_VALUE}f.is=D})(i=e.integer||(e.integer={}));var o;(function(f){f.MIN_VALUE=0,f.MAX_VALUE=2147483647;function D(T){return typeof T=="number"&&f.MIN_VALUE<=T&&T<=f.MAX_VALUE}f.is=D})(o=e.uinteger||(e.uinteger={}));var s;(function(f){function D(m,d){return m===Number.MAX_VALUE&&(m=o.MAX_VALUE),d===Number.MAX_VALUE&&(d=o.MAX_VALUE),{line:m,character:d}}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&S.uinteger(d.line)&&S.uinteger(d.character)}f.is=T})(s=e.Position||(e.Position={}));var a;(function(f){function D(m,d,P,L){if(S.uinteger(m)&&S.uinteger(d)&&S.uinteger(P)&&S.uinteger(L))return{start:s.create(m,d),end:s.create(P,L)};if(s.is(m)&&s.is(d))return{start:m,end:d};throw new Error("Range#create called with invalid arguments[".concat(m,", ").concat(d,", ").concat(P,", ").concat(L,"]"))}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&s.is(d.start)&&s.is(d.end)}f.is=T})(a=e.Range||(e.Range={}));var c;(function(f){function D(m,d){return{uri:m,range:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&a.is(d.range)&&(S.string(d.uri)||S.undefined(d.uri))}f.is=T})(c=e.Location||(e.Location={}));var l;(function(f){function D(m,d,P,L){return{targetUri:m,targetRange:d,targetSelectionRange:P,originSelectionRange:L}}f.create=D;function T(m){var d=m;return S.defined(d)&&a.is(d.targetRange)&&S.string(d.targetUri)&&a.is(d.targetSelectionRange)&&(a.is(d.originSelectionRange)||S.undefined(d.originSelectionRange))}f.is=T})(l=e.LocationLink||(e.LocationLink={}));var g;(function(f){function D(m,d,P,L){return{red:m,green:d,blue:P,alpha:L}}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&S.numberRange(d.red,0,1)&&S.numberRange(d.green,0,1)&&S.numberRange(d.blue,0,1)&&S.numberRange(d.alpha,0,1)}f.is=T})(g=e.Color||(e.Color={}));var v;(function(f){function D(m,d){return{range:m,color:d}}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&a.is(d.range)&&g.is(d.color)}f.is=T})(v=e.ColorInformation||(e.ColorInformation={}));var h;(function(f){function D(m,d,P){return{label:m,textEdit:d,additionalTextEdits:P}}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&S.string(d.label)&&(S.undefined(d.textEdit)||K.is(d))&&(S.undefined(d.additionalTextEdits)||S.typedArray(d.additionalTextEdits,K.is))}f.is=T})(h=e.ColorPresentation||(e.ColorPresentation={}));var C;(function(f){f.Comment="comment",f.Imports="imports",f.Region="region"})(C=e.FoldingRangeKind||(e.FoldingRangeKind={}));var b;(function(f){function D(m,d,P,L,te){var Pe={startLine:m,endLine:d};return S.defined(P)&&(Pe.startCharacter=P),S.defined(L)&&(Pe.endCharacter=L),S.defined(te)&&(Pe.kind=te),Pe}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&S.uinteger(d.startLine)&&S.uinteger(d.startLine)&&(S.undefined(d.startCharacter)||S.uinteger(d.startCharacter))&&(S.undefined(d.endCharacter)||S.uinteger(d.endCharacter))&&(S.undefined(d.kind)||S.string(d.kind))}f.is=T})(b=e.FoldingRange||(e.FoldingRange={}));var x;(function(f){function D(m,d){return{location:m,message:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&c.is(d.location)&&S.string(d.message)}f.is=T})(x=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var q;(function(f){f.Error=1,f.Warning=2,f.Information=3,f.Hint=4})(q=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var O;(function(f){f.Unnecessary=1,f.Deprecated=2})(O=e.DiagnosticTag||(e.DiagnosticTag={}));var I;(function(f){function D(T){var m=T;return S.objectLiteral(m)&&S.string(m.href)}f.is=D})(I=e.CodeDescription||(e.CodeDescription={}));var N;(function(f){function D(m,d,P,L,te,Pe){var Ae={range:m,message:d};return S.defined(P)&&(Ae.severity=P),S.defined(L)&&(Ae.code=L),S.defined(te)&&(Ae.source=te),S.defined(Pe)&&(Ae.relatedInformation=Pe),Ae}f.create=D;function T(m){var d,P=m;return S.defined(P)&&a.is(P.range)&&S.string(P.message)&&(S.number(P.severity)||S.undefined(P.severity))&&(S.integer(P.code)||S.string(P.code)||S.undefined(P.code))&&(S.undefined(P.codeDescription)||S.string((d=P.codeDescription)===null||d===void 0?void 0:d.href))&&(S.string(P.source)||S.undefined(P.source))&&(S.undefined(P.relatedInformation)||S.typedArray(P.relatedInformation,x.is))}f.is=T})(N=e.Diagnostic||(e.Diagnostic={}));var $;(function(f){function D(m,d){for(var P=[],L=2;L<arguments.length;L++)P[L-2]=arguments[L];var te={title:m,command:d};return S.defined(P)&&P.length>0&&(te.arguments=P),te}f.create=D;function T(m){var d=m;return S.defined(d)&&S.string(d.title)&&S.string(d.command)}f.is=T})($=e.Command||(e.Command={}));var K;(function(f){function D(P,L){return{range:P,newText:L}}f.replace=D;function T(P,L){return{range:{start:P,end:P},newText:L}}f.insert=T;function m(P){return{range:P,newText:""}}f.del=m;function d(P){var L=P;return S.objectLiteral(L)&&S.string(L.newText)&&a.is(L.range)}f.is=d})(K=e.TextEdit||(e.TextEdit={}));var de;(function(f){function D(m,d,P){var L={label:m};return d!==void 0&&(L.needsConfirmation=d),P!==void 0&&(L.description=P),L}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&S.string(d.label)&&(S.boolean(d.needsConfirmation)||d.needsConfirmation===void 0)&&(S.string(d.description)||d.description===void 0)}f.is=T})(de=e.ChangeAnnotation||(e.ChangeAnnotation={}));var se;(function(f){function D(T){var m=T;return S.string(m)}f.is=D})(se=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var He;(function(f){function D(P,L,te){return{range:P,newText:L,annotationId:te}}f.replace=D;function T(P,L,te){return{range:{start:P,end:P},newText:L,annotationId:te}}f.insert=T;function m(P,L){return{range:P,newText:"",annotationId:L}}f.del=m;function d(P){var L=P;return K.is(L)&&(de.is(L.annotationId)||se.is(L.annotationId))}f.is=d})(He=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var Ge;(function(f){function D(m,d){return{textDocument:m,edits:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&tt.is(d.textDocument)&&Array.isArray(d.edits)}f.is=T})(Ge=e.TextDocumentEdit||(e.TextDocumentEdit={}));var rt;(function(f){function D(m,d,P){var L={kind:"create",uri:m};return d!==void 0&&(d.overwrite!==void 0||d.ignoreIfExists!==void 0)&&(L.options=d),P!==void 0&&(L.annotationId=P),L}f.create=D;function T(m){var d=m;return d&&d.kind==="create"&&S.string(d.uri)&&(d.options===void 0||(d.options.overwrite===void 0||S.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||S.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||se.is(d.annotationId))}f.is=T})(rt=e.CreateFile||(e.CreateFile={}));var Tt;(function(f){function D(m,d,P,L){var te={kind:"rename",oldUri:m,newUri:d};return P!==void 0&&(P.overwrite!==void 0||P.ignoreIfExists!==void 0)&&(te.options=P),L!==void 0&&(te.annotationId=L),te}f.create=D;function T(m){var d=m;return d&&d.kind==="rename"&&S.string(d.oldUri)&&S.string(d.newUri)&&(d.options===void 0||(d.options.overwrite===void 0||S.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||S.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||se.is(d.annotationId))}f.is=T})(Tt=e.RenameFile||(e.RenameFile={}));var gt;(function(f){function D(m,d,P){var L={kind:"delete",uri:m};return d!==void 0&&(d.recursive!==void 0||d.ignoreIfNotExists!==void 0)&&(L.options=d),P!==void 0&&(L.annotationId=P),L}f.create=D;function T(m){var d=m;return d&&d.kind==="delete"&&S.string(d.uri)&&(d.options===void 0||(d.options.recursive===void 0||S.boolean(d.options.recursive))&&(d.options.ignoreIfNotExists===void 0||S.boolean(d.options.ignoreIfNotExists)))&&(d.annotationId===void 0||se.is(d.annotationId))}f.is=T})(gt=e.DeleteFile||(e.DeleteFile={}));var mt;(function(f){function D(T){var m=T;return m&&(m.changes!==void 0||m.documentChanges!==void 0)&&(m.documentChanges===void 0||m.documentChanges.every(function(d){return S.string(d.kind)?rt.is(d)||Tt.is(d)||gt.is(d):Ge.is(d)}))}f.is=D})(mt=e.WorkspaceEdit||(e.WorkspaceEdit={}));var St=function(){function f(D,T){this.edits=D,this.changeAnnotations=T}return f.prototype.insert=function(D,T,m){var d,P;if(m===void 0?d=K.insert(D,T):se.is(m)?(P=m,d=He.insert(D,T,m)):(this.assertChangeAnnotations(this.changeAnnotations),P=this.changeAnnotations.manage(m),d=He.insert(D,T,P)),this.edits.push(d),P!==void 0)return P},f.prototype.replace=function(D,T,m){var d,P;if(m===void 0?d=K.replace(D,T):se.is(m)?(P=m,d=He.replace(D,T,m)):(this.assertChangeAnnotations(this.changeAnnotations),P=this.changeAnnotations.manage(m),d=He.replace(D,T,P)),this.edits.push(d),P!==void 0)return P},f.prototype.delete=function(D,T){var m,d;if(T===void 0?m=K.del(D):se.is(T)?(d=T,m=He.del(D,T)):(this.assertChangeAnnotations(this.changeAnnotations),d=this.changeAnnotations.manage(T),m=He.del(D,d)),this.edits.push(m),d!==void 0)return d},f.prototype.add=function(D){this.edits.push(D)},f.prototype.all=function(){return this.edits},f.prototype.clear=function(){this.edits.splice(0,this.edits.length)},f.prototype.assertChangeAnnotations=function(D){if(D===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},f}(),at=function(){function f(D){this._annotations=D===void 0?Object.create(null):D,this._counter=0,this._size=0}return f.prototype.all=function(){return this._annotations},Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),f.prototype.manage=function(D,T){var m;if(se.is(D)?m=D:(m=this.nextId(),T=D),this._annotations[m]!==void 0)throw new Error("Id ".concat(m," is already in use."));if(T===void 0)throw new Error("No annotation provided for id ".concat(m));return this._annotations[m]=T,this._size++,m},f.prototype.nextId=function(){return this._counter++,this._counter.toString()},f}(),vt=function(){function f(D){var T=this;this._textEditChanges=Object.create(null),D!==void 0?(this._workspaceEdit=D,D.documentChanges?(this._changeAnnotations=new at(D.changeAnnotations),D.changeAnnotations=this._changeAnnotations.all(),D.documentChanges.forEach(function(m){if(Ge.is(m)){var d=new St(m.edits,T._changeAnnotations);T._textEditChanges[m.textDocument.uri]=d}})):D.changes&&Object.keys(D.changes).forEach(function(m){var d=new St(D.changes[m]);T._textEditChanges[m]=d})):this._workspaceEdit={}}return Object.defineProperty(f.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),f.prototype.getTextEditChange=function(D){if(tt.is(D)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T={uri:D.uri,version:D.version},m=this._textEditChanges[T.uri];if(!m){var d=[],P={textDocument:T,edits:d};this._workspaceEdit.documentChanges.push(P),m=new St(d,this._changeAnnotations),this._textEditChanges[T.uri]=m}return m}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var m=this._textEditChanges[D];if(!m){var d=[];this._workspaceEdit.changes[D]=d,m=new St(d),this._textEditChanges[D]=m}return m}},f.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new at,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},f.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},f.prototype.createFile=function(D,T,m){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;de.is(T)||se.is(T)?d=T:m=T;var P,L;if(d===void 0?P=rt.create(D,m):(L=se.is(d)?d:this._changeAnnotations.manage(d),P=rt.create(D,m,L)),this._workspaceEdit.documentChanges.push(P),L!==void 0)return L},f.prototype.renameFile=function(D,T,m,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var P;de.is(m)||se.is(m)?P=m:d=m;var L,te;if(P===void 0?L=Tt.create(D,T,d):(te=se.is(P)?P:this._changeAnnotations.manage(P),L=Tt.create(D,T,d,te)),this._workspaceEdit.documentChanges.push(L),te!==void 0)return te},f.prototype.deleteFile=function(D,T,m){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;de.is(T)||se.is(T)?d=T:m=T;var P,L;if(d===void 0?P=gt.create(D,m):(L=se.is(d)?d:this._changeAnnotations.manage(d),P=gt.create(D,m,L)),this._workspaceEdit.documentChanges.push(P),L!==void 0)return L},f}();e.WorkspaceChange=vt;var xn;(function(f){function D(m){return{uri:m}}f.create=D;function T(m){var d=m;return S.defined(d)&&S.string(d.uri)}f.is=T})(xn=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var Le;(function(f){function D(m,d){return{uri:m,version:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&S.string(d.uri)&&S.integer(d.version)}f.is=T})(Le=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var tt;(function(f){function D(m,d){return{uri:m,version:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&S.string(d.uri)&&(d.version===null||S.integer(d.version))}f.is=T})(tt=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var ct;(function(f){function D(m,d,P,L){return{uri:m,languageId:d,version:P,text:L}}f.create=D;function T(m){var d=m;return S.defined(d)&&S.string(d.uri)&&S.string(d.languageId)&&S.integer(d.version)&&S.string(d.text)}f.is=T})(ct=e.TextDocumentItem||(e.TextDocumentItem={}));var Ft;(function(f){f.PlainText="plaintext",f.Markdown="markdown"})(Ft=e.MarkupKind||(e.MarkupKind={})),function(f){function D(T){var m=T;return m===f.PlainText||m===f.Markdown}f.is=D}(Ft=e.MarkupKind||(e.MarkupKind={}));var Xe;(function(f){function D(T){var m=T;return S.objectLiteral(T)&&Ft.is(m.kind)&&S.string(m.value)}f.is=D})(Xe=e.MarkupContent||(e.MarkupContent={}));var ur;(function(f){f.Text=1,f.Method=2,f.Function=3,f.Constructor=4,f.Field=5,f.Variable=6,f.Class=7,f.Interface=8,f.Module=9,f.Property=10,f.Unit=11,f.Value=12,f.Enum=13,f.Keyword=14,f.Snippet=15,f.Color=16,f.File=17,f.Reference=18,f.Folder=19,f.EnumMember=20,f.Constant=21,f.Struct=22,f.Event=23,f.Operator=24,f.TypeParameter=25})(ur=e.CompletionItemKind||(e.CompletionItemKind={}));var Vn;(function(f){f.PlainText=1,f.Snippet=2})(Vn=e.InsertTextFormat||(e.InsertTextFormat={}));var Bn;(function(f){f.Deprecated=1})(Bn=e.CompletionItemTag||(e.CompletionItemTag={}));var kn;(function(f){function D(m,d,P){return{newText:m,insert:d,replace:P}}f.create=D;function T(m){var d=m;return d&&S.string(d.newText)&&a.is(d.insert)&&a.is(d.replace)}f.is=T})(kn=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var qn;(function(f){f.asIs=1,f.adjustIndentation=2})(qn=e.InsertTextMode||(e.InsertTextMode={}));var lr;(function(f){function D(T){var m=T;return m&&(S.string(m.detail)||m.detail===void 0)&&(S.string(m.description)||m.description===void 0)}f.is=D})(lr=e.CompletionItemLabelDetails||(e.CompletionItemLabelDetails={}));var Gn;(function(f){function D(T){return{label:T}}f.create=D})(Gn=e.CompletionItem||(e.CompletionItem={}));var Xn;(function(f){function D(T,m){return{items:T||[],isIncomplete:!!m}}f.create=D})(Xn=e.CompletionList||(e.CompletionList={}));var yt;(function(f){function D(m){return m.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}f.fromPlainText=D;function T(m){var d=m;return S.string(d)||S.objectLiteral(d)&&S.string(d.language)&&S.string(d.value)}f.is=T})(yt=e.MarkedString||(e.MarkedString={}));var Gt;(function(f){function D(T){var m=T;return!!m&&S.objectLiteral(m)&&(Xe.is(m.contents)||yt.is(m.contents)||S.typedArray(m.contents,yt.is))&&(T.range===void 0||a.is(T.range))}f.is=D})(Gt=e.Hover||(e.Hover={}));var Qn;(function(f){function D(T,m){return m?{label:T,documentation:m}:{label:T}}f.create=D})(Qn=e.ParameterInformation||(e.ParameterInformation={}));var Mt;(function(f){function D(T,m){for(var d=[],P=2;P<arguments.length;P++)d[P-2]=arguments[P];var L={label:T};return S.defined(m)&&(L.documentation=m),S.defined(d)?L.parameters=d:L.parameters=[],L}f.create=D})(Mt=e.SignatureInformation||(e.SignatureInformation={}));var On;(function(f){f.Text=1,f.Read=2,f.Write=3})(On=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var yn;(function(f){function D(T,m){var d={range:T};return S.number(m)&&(d.kind=m),d}f.create=D})(yn=e.DocumentHighlight||(e.DocumentHighlight={}));var jt;(function(f){f.File=1,f.Module=2,f.Namespace=3,f.Package=4,f.Class=5,f.Method=6,f.Property=7,f.Field=8,f.Constructor=9,f.Enum=10,f.Interface=11,f.Function=12,f.Variable=13,f.Constant=14,f.String=15,f.Number=16,f.Boolean=17,f.Array=18,f.Object=19,f.Key=20,f.Null=21,f.EnumMember=22,f.Struct=23,f.Event=24,f.Operator=25,f.TypeParameter=26})(jt=e.SymbolKind||(e.SymbolKind={}));var Lt;(function(f){f.Deprecated=1})(Lt=e.SymbolTag||(e.SymbolTag={}));var Qe;(function(f){function D(T,m,d,P,L){var te={name:T,kind:m,location:{uri:P,range:d}};return L&&(te.containerName=L),te}f.create=D})(Qe=e.SymbolInformation||(e.SymbolInformation={}));var dr;(function(f){function D(T,m,d,P){return P!==void 0?{name:T,kind:m,location:{uri:d,range:P}}:{name:T,kind:m,location:{uri:d}}}f.create=D})(dr=e.WorkspaceSymbol||(e.WorkspaceSymbol={}));var _t;(function(f){function D(m,d,P,L,te,Pe){var Ae={name:m,detail:d,kind:P,range:L,selectionRange:te};return Pe!==void 0&&(Ae.children=Pe),Ae}f.create=D;function T(m){var d=m;return d&&S.string(d.name)&&S.number(d.kind)&&a.is(d.range)&&a.is(d.selectionRange)&&(d.detail===void 0||S.string(d.detail))&&(d.deprecated===void 0||S.boolean(d.deprecated))&&(d.children===void 0||Array.isArray(d.children))&&(d.tags===void 0||Array.isArray(d.tags))}f.is=T})(_t=e.DocumentSymbol||(e.DocumentSymbol={}));var $t;(function(f){f.Empty="",f.QuickFix="quickfix",f.Refactor="refactor",f.RefactorExtract="refactor.extract",f.RefactorInline="refactor.inline",f.RefactorRewrite="refactor.rewrite",f.Source="source",f.SourceOrganizeImports="source.organizeImports",f.SourceFixAll="source.fixAll"})($t=e.CodeActionKind||(e.CodeActionKind={}));var Cn;(function(f){f.Invoked=1,f.Automatic=2})(Cn=e.CodeActionTriggerKind||(e.CodeActionTriggerKind={}));var In;(function(f){function D(m,d,P){var L={diagnostics:m};return d!=null&&(L.only=d),P!=null&&(L.triggerKind=P),L}f.create=D;function T(m){var d=m;return S.defined(d)&&S.typedArray(d.diagnostics,N.is)&&(d.only===void 0||S.typedArray(d.only,S.string))&&(d.triggerKind===void 0||d.triggerKind===Cn.Invoked||d.triggerKind===Cn.Automatic)}f.is=T})(In=e.CodeActionContext||(e.CodeActionContext={}));var Nn;(function(f){function D(m,d,P){var L={title:m},te=!0;return typeof d=="string"?(te=!1,L.kind=d):$.is(d)?L.command=d:L.edit=d,te&&P!==void 0&&(L.kind=P),L}f.create=D;function T(m){var d=m;return d&&S.string(d.title)&&(d.diagnostics===void 0||S.typedArray(d.diagnostics,N.is))&&(d.kind===void 0||S.string(d.kind))&&(d.edit!==void 0||d.command!==void 0)&&(d.command===void 0||$.is(d.command))&&(d.isPreferred===void 0||S.boolean(d.isPreferred))&&(d.edit===void 0||mt.is(d.edit))}f.is=T})(Nn=e.CodeAction||(e.CodeAction={}));var Ht;(function(f){function D(m,d){var P={range:m};return S.defined(d)&&(P.data=d),P}f.create=D;function T(m){var d=m;return S.defined(d)&&a.is(d.range)&&(S.undefined(d.command)||$.is(d.command))}f.is=T})(Ht=e.CodeLens||(e.CodeLens={}));var Xt;(function(f){function D(m,d){return{tabSize:m,insertSpaces:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&S.uinteger(d.tabSize)&&S.boolean(d.insertSpaces)}f.is=T})(Xt=e.FormattingOptions||(e.FormattingOptions={}));var R;(function(f){function D(m,d,P){return{range:m,target:d,data:P}}f.create=D;function T(m){var d=m;return S.defined(d)&&a.is(d.range)&&(S.undefined(d.target)||S.string(d.target))}f.is=T})(R=e.DocumentLink||(e.DocumentLink={}));var F;(function(f){function D(m,d){return{range:m,parent:d}}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&a.is(d.range)&&(d.parent===void 0||f.is(d.parent))}f.is=T})(F=e.SelectionRange||(e.SelectionRange={}));var H;(function(f){f.namespace="namespace",f.type="type",f.class="class",f.enum="enum",f.interface="interface",f.struct="struct",f.typeParameter="typeParameter",f.parameter="parameter",f.variable="variable",f.property="property",f.enumMember="enumMember",f.event="event",f.function="function",f.method="method",f.macro="macro",f.keyword="keyword",f.modifier="modifier",f.comment="comment",f.string="string",f.number="number",f.regexp="regexp",f.operator="operator",f.decorator="decorator"})(H=e.SemanticTokenTypes||(e.SemanticTokenTypes={}));var V;(function(f){f.declaration="declaration",f.definition="definition",f.readonly="readonly",f.static="static",f.deprecated="deprecated",f.abstract="abstract",f.async="async",f.modification="modification",f.documentation="documentation",f.defaultLibrary="defaultLibrary"})(V=e.SemanticTokenModifiers||(e.SemanticTokenModifiers={}));var he;(function(f){function D(T){var m=T;return S.objectLiteral(m)&&(m.resultId===void 0||typeof m.resultId=="string")&&Array.isArray(m.data)&&(m.data.length===0||typeof m.data[0]=="number")}f.is=D})(he=e.SemanticTokens||(e.SemanticTokens={}));var ge;(function(f){function D(m,d){return{range:m,text:d}}f.create=D;function T(m){var d=m;return d!=null&&a.is(d.range)&&S.string(d.text)}f.is=T})(ge=e.InlineValueText||(e.InlineValueText={}));var me;(function(f){function D(m,d,P){return{range:m,variableName:d,caseSensitiveLookup:P}}f.create=D;function T(m){var d=m;return d!=null&&a.is(d.range)&&S.boolean(d.caseSensitiveLookup)&&(S.string(d.variableName)||d.variableName===void 0)}f.is=T})(me=e.InlineValueVariableLookup||(e.InlineValueVariableLookup={}));var ke;(function(f){function D(m,d){return{range:m,expression:d}}f.create=D;function T(m){var d=m;return d!=null&&a.is(d.range)&&(S.string(d.expression)||d.expression===void 0)}f.is=T})(ke=e.InlineValueEvaluatableExpression||(e.InlineValueEvaluatableExpression={}));var ce;(function(f){function D(m,d){return{frameId:m,stoppedLocation:d}}f.create=D;function T(m){var d=m;return S.defined(d)&&a.is(m.stoppedLocation)}f.is=T})(ce=e.InlineValueContext||(e.InlineValueContext={}));var Ce;(function(f){f.Type=1,f.Parameter=2;function D(T){return T===1||T===2}f.is=D})(Ce=e.InlayHintKind||(e.InlayHintKind={}));var ue;(function(f){function D(m){return{value:m}}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&(d.tooltip===void 0||S.string(d.tooltip)||Xe.is(d.tooltip))&&(d.location===void 0||c.is(d.location))&&(d.command===void 0||$.is(d.command))}f.is=T})(ue=e.InlayHintLabelPart||(e.InlayHintLabelPart={}));var p;(function(f){function D(m,d,P){var L={position:m,label:d};return P!==void 0&&(L.kind=P),L}f.create=D;function T(m){var d=m;return S.objectLiteral(d)&&s.is(d.position)&&(S.string(d.label)||S.typedArray(d.label,ue.is))&&(d.kind===void 0||Ce.is(d.kind))&&d.textEdits===void 0||S.typedArray(d.textEdits,K.is)&&(d.tooltip===void 0||S.string(d.tooltip)||Xe.is(d.tooltip))&&(d.paddingLeft===void 0||S.boolean(d.paddingLeft))&&(d.paddingRight===void 0||S.boolean(d.paddingRight))}f.is=T})(p=e.InlayHint||(e.InlayHint={})),e.EOL=[`
`,`\r
`,"\r"];var E;(function(f){function D(P,L,te,Pe){return new z(P,L,te,Pe)}f.create=D;function T(P){var L=P;return!!(S.defined(L)&&S.string(L.uri)&&(S.undefined(L.languageId)||S.string(L.languageId))&&S.uinteger(L.lineCount)&&S.func(L.getText)&&S.func(L.positionAt)&&S.func(L.offsetAt))}f.is=T;function m(P,L){for(var te=P.getText(),Pe=d(L,function(Jn,Fr){var io=Jn.range.start.line-Fr.range.start.line;return io===0?Jn.range.start.character-Fr.range.start.character:io}),Ae=te.length,Wt=Pe.length-1;Wt>=0;Wt--){var zt=Pe[Wt],Qt=P.offsetAt(zt.range.start),fe=P.offsetAt(zt.range.end);if(fe<=Ae)te=te.substring(0,Qt)+zt.newText+te.substring(fe,te.length);else throw new Error("Overlapping edit");Ae=Qt}return te}f.applyEdits=m;function d(P,L){if(P.length<=1)return P;var te=P.length/2|0,Pe=P.slice(0,te),Ae=P.slice(te);d(Pe,L),d(Ae,L);for(var Wt=0,zt=0,Qt=0;Wt<Pe.length&&zt<Ae.length;){var fe=L(Pe[Wt],Ae[zt]);fe<=0?P[Qt++]=Pe[Wt++]:P[Qt++]=Ae[zt++]}for(;Wt<Pe.length;)P[Qt++]=Pe[Wt++];for(;zt<Ae.length;)P[Qt++]=Ae[zt++];return P}})(E=e.TextDocument||(e.TextDocument={}));var z=function(){function f(D,T,m,d){this._uri=D,this._languageId=T,this._version=m,this._content=d,this._lineOffsets=void 0}return Object.defineProperty(f.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),f.prototype.getText=function(D){if(D){var T=this.offsetAt(D.start),m=this.offsetAt(D.end);return this._content.substring(T,m)}return this._content},f.prototype.update=function(D,T){this._content=D.text,this._version=T,this._lineOffsets=void 0},f.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var D=[],T=this._content,m=!0,d=0;d<T.length;d++){m&&(D.push(d),m=!1);var P=T.charAt(d);m=P==="\r"||P===`
`,P==="\r"&&d+1<T.length&&T.charAt(d+1)===`
`&&d++}m&&T.length>0&&D.push(T.length),this._lineOffsets=D}return this._lineOffsets},f.prototype.positionAt=function(D){D=Math.max(Math.min(D,this._content.length),0);var T=this.getLineOffsets(),m=0,d=T.length;if(d===0)return s.create(0,D);for(;m<d;){var P=Math.floor((m+d)/2);T[P]>D?d=P:m=P+1}var L=m-1;return s.create(L,D-T[L])},f.prototype.offsetAt=function(D){var T=this.getLineOffsets();if(D.line>=T.length)return this._content.length;if(D.line<0)return 0;var m=T[D.line],d=D.line+1<T.length?T[D.line+1]:this._content.length;return Math.max(Math.min(m+D.character,d),m)},Object.defineProperty(f.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),f}(),S;(function(f){var D=Object.prototype.toString;function T(fe){return typeof fe<"u"}f.defined=T;function m(fe){return typeof fe>"u"}f.undefined=m;function d(fe){return fe===!0||fe===!1}f.boolean=d;function P(fe){return D.call(fe)==="[object String]"}f.string=P;function L(fe){return D.call(fe)==="[object Number]"}f.number=L;function te(fe,Jn,Fr){return D.call(fe)==="[object Number]"&&Jn<=fe&&fe<=Fr}f.numberRange=te;function Pe(fe){return D.call(fe)==="[object Number]"&&-2147483648<=fe&&fe<=2147483647}f.integer=Pe;function Ae(fe){return D.call(fe)==="[object Number]"&&0<=fe&&fe<=2147483647}f.uinteger=Ae;function Wt(fe){return D.call(fe)==="[object Function]"}f.func=Wt;function zt(fe){return fe!==null&&typeof fe=="object"}f.objectLiteral=zt;function Qt(fe,Jn){return Array.isArray(fe)&&fe.every(Jn)}f.typedArray=Qt})(S||(S={}))})});var Me=k(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.ProtocolNotificationType=en.ProtocolNotificationType0=en.ProtocolRequestType=en.ProtocolRequestType0=en.RegistrationType=void 0;var Br=Dr(),tf=class{constructor(e){this.method=e}};en.RegistrationType=tf;var nf=class extends Br.RequestType0{constructor(e){super(e)}};en.ProtocolRequestType0=nf;var rf=class extends Br.RequestType{constructor(e){super(e,Br.ParameterStructures.byName)}};en.ProtocolRequestType=rf;var of=class extends Br.NotificationType0{constructor(e){super(e)}};en.ProtocolNotificationType0=of;var sf=class extends Br.NotificationType{constructor(e){super(e,Br.ParameterStructures.byName)}};en.ProtocolNotificationType=sf});var Po=k(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.objectLiteral=Je.typedArray=Je.stringArray=Je.array=Je.func=Je.error=Je.number=Je.string=Je.boolean=void 0;function _w(n){return n===!0||n===!1}Je.boolean=_w;function af(n){return typeof n=="string"||n instanceof String}Je.string=af;function Pw(n){return typeof n=="number"||n instanceof Number}Je.number=Pw;function Ew(n){return n instanceof Error}Je.error=Ew;function xw(n){return typeof n=="function"}Je.func=xw;function cf(n){return Array.isArray(n)}Je.array=cf;function kw(n){return cf(n)&&n.every(e=>af(e))}Je.stringArray=kw;function qw(n,e){return Array.isArray(n)&&n.every(e)}Je.typedArray=qw;function Ow(n){return n!==null&&typeof n=="object"}Je.objectLiteral=Ow});var uf=k(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});Oi.ImplementationRequest=void 0;var Iw=Me(),Nw;(function(n){n.method="textDocument/implementation",n.type=new Iw.ProtocolRequestType(n.method)})(Nw=Oi.ImplementationRequest||(Oi.ImplementationRequest={}))});var lf=k(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.TypeDefinitionRequest=void 0;var Fw=Me(),Lw;(function(n){n.method="textDocument/typeDefinition",n.type=new Fw.ProtocolRequestType(n.method)})(Lw=Ii.TypeDefinitionRequest||(Ii.TypeDefinitionRequest={}))});var ff=k(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.DidChangeWorkspaceFoldersNotification=Zn.WorkspaceFoldersRequest=void 0;var df=Me(),Aw;(function(n){n.type=new df.ProtocolRequestType0("workspace/workspaceFolders")})(Aw=Zn.WorkspaceFoldersRequest||(Zn.WorkspaceFoldersRequest={}));var Mw;(function(n){n.type=new df.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")})(Mw=Zn.DidChangeWorkspaceFoldersNotification||(Zn.DidChangeWorkspaceFoldersNotification={}))});var pf=k(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.ConfigurationRequest=void 0;var jw=Me(),$w;(function(n){n.type=new jw.ProtocolRequestType("workspace/configuration")})($w=Ni.ConfigurationRequest||(Ni.ConfigurationRequest={}))});var gf=k(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.ColorPresentationRequest=er.DocumentColorRequest=void 0;var hf=Me(),Hw;(function(n){n.method="textDocument/documentColor",n.type=new hf.ProtocolRequestType(n.method)})(Hw=er.DocumentColorRequest||(er.DocumentColorRequest={}));var Ww;(function(n){n.type=new hf.ProtocolRequestType("textDocument/colorPresentation")})(Ww=er.ColorPresentationRequest||(er.ColorPresentationRequest={}))});var mf=k(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.FoldingRangeRequest=tr.FoldingRangeKind=void 0;var zw=Me(),Uw;(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})(Uw=tr.FoldingRangeKind||(tr.FoldingRangeKind={}));var Kw;(function(n){n.method="textDocument/foldingRange",n.type=new zw.ProtocolRequestType(n.method)})(Kw=tr.FoldingRangeRequest||(tr.FoldingRangeRequest={}))});var vf=k(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.DeclarationRequest=void 0;var Vw=Me(),Bw;(function(n){n.method="textDocument/declaration",n.type=new Vw.ProtocolRequestType(n.method)})(Bw=Fi.DeclarationRequest||(Fi.DeclarationRequest={}))});var yf=k(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.SelectionRangeRequest=void 0;var Gw=Me(),Xw;(function(n){n.method="textDocument/selectionRange",n.type=new Gw.ProtocolRequestType(n.method)})(Xw=Li.SelectionRangeRequest||(Li.SelectionRangeRequest={}))});var wf=k(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.WorkDoneProgressCancelNotification=ln.WorkDoneProgressCreateRequest=ln.WorkDoneProgress=void 0;var Qw=Dr(),Cf=Me(),Jw;(function(n){n.type=new Qw.ProgressType;function e(t){return t===n.type}n.is=e})(Jw=ln.WorkDoneProgress||(ln.WorkDoneProgress={}));var Yw;(function(n){n.type=new Cf.ProtocolRequestType("window/workDoneProgress/create")})(Yw=ln.WorkDoneProgressCreateRequest||(ln.WorkDoneProgressCreateRequest={}));var Zw;(function(n){n.type=new Cf.ProtocolNotificationType("window/workDoneProgress/cancel")})(Zw=ln.WorkDoneProgressCancelNotification||(ln.WorkDoneProgressCancelNotification={}))});var Rf=k(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.CallHierarchyOutgoingCallsRequest=dn.CallHierarchyIncomingCallsRequest=dn.CallHierarchyPrepareRequest=void 0;var ga=Me(),eR;(function(n){n.method="textDocument/prepareCallHierarchy",n.type=new ga.ProtocolRequestType(n.method)})(eR=dn.CallHierarchyPrepareRequest||(dn.CallHierarchyPrepareRequest={}));var tR;(function(n){n.method="callHierarchy/incomingCalls",n.type=new ga.ProtocolRequestType(n.method)})(tR=dn.CallHierarchyIncomingCallsRequest||(dn.CallHierarchyIncomingCallsRequest={}));var nR;(function(n){n.method="callHierarchy/outgoingCalls",n.type=new ga.ProtocolRequestType(n.method)})(nR=dn.CallHierarchyOutgoingCallsRequest||(dn.CallHierarchyOutgoingCallsRequest={}))});var bf=k(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.SemanticTokensRefreshRequest=Ye.SemanticTokensRangeRequest=Ye.SemanticTokensDeltaRequest=Ye.SemanticTokensRequest=Ye.SemanticTokensRegistrationType=Ye.TokenFormat=void 0;var Ai=Me(),rR;(function(n){n.Relative="relative"})(rR=Ye.TokenFormat||(Ye.TokenFormat={}));var iR;(function(n){n.method="textDocument/semanticTokens",n.type=new Ai.RegistrationType(n.method)})(iR=Ye.SemanticTokensRegistrationType||(Ye.SemanticTokensRegistrationType={}));var oR;(function(n){n.method="textDocument/semanticTokens/full",n.type=new Ai.ProtocolRequestType(n.method)})(oR=Ye.SemanticTokensRequest||(Ye.SemanticTokensRequest={}));var sR;(function(n){n.method="textDocument/semanticTokens/full/delta",n.type=new Ai.ProtocolRequestType(n.method)})(sR=Ye.SemanticTokensDeltaRequest||(Ye.SemanticTokensDeltaRequest={}));var aR;(function(n){n.method="textDocument/semanticTokens/range",n.type=new Ai.ProtocolRequestType(n.method)})(aR=Ye.SemanticTokensRangeRequest||(Ye.SemanticTokensRangeRequest={}));var cR;(function(n){n.method="workspace/semanticTokens/refresh",n.type=new Ai.ProtocolRequestType0(n.method)})(cR=Ye.SemanticTokensRefreshRequest||(Ye.SemanticTokensRefreshRequest={}))});var Df=k(Mi=>{"use strict";Object.defineProperty(Mi,"__esModule",{value:!0});Mi.ShowDocumentRequest=void 0;var uR=Me(),lR;(function(n){n.method="window/showDocument",n.type=new uR.ProtocolRequestType(n.method)})(lR=Mi.ShowDocumentRequest||(Mi.ShowDocumentRequest={}))});var Tf=k(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.LinkedEditingRangeRequest=void 0;var dR=Me(),fR;(function(n){n.method="textDocument/linkedEditingRange",n.type=new dR.ProtocolRequestType(n.method)})(fR=ji.LinkedEditingRangeRequest||(ji.LinkedEditingRangeRequest={}))});var Sf=k(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.WillDeleteFilesRequest=je.DidDeleteFilesNotification=je.DidRenameFilesNotification=je.WillRenameFilesRequest=je.DidCreateFilesNotification=je.WillCreateFilesRequest=je.FileOperationPatternKind=void 0;var Gr=Me(),pR;(function(n){n.file="file",n.folder="folder"})(pR=je.FileOperationPatternKind||(je.FileOperationPatternKind={}));var hR;(function(n){n.method="workspace/willCreateFiles",n.type=new Gr.ProtocolRequestType(n.method)})(hR=je.WillCreateFilesRequest||(je.WillCreateFilesRequest={}));var gR;(function(n){n.method="workspace/didCreateFiles",n.type=new Gr.ProtocolNotificationType(n.method)})(gR=je.DidCreateFilesNotification||(je.DidCreateFilesNotification={}));var mR;(function(n){n.method="workspace/willRenameFiles",n.type=new Gr.ProtocolRequestType(n.method)})(mR=je.WillRenameFilesRequest||(je.WillRenameFilesRequest={}));var vR;(function(n){n.method="workspace/didRenameFiles",n.type=new Gr.ProtocolNotificationType(n.method)})(vR=je.DidRenameFilesNotification||(je.DidRenameFilesNotification={}));var yR;(function(n){n.method="workspace/didDeleteFiles",n.type=new Gr.ProtocolNotificationType(n.method)})(yR=je.DidDeleteFilesNotification||(je.DidDeleteFilesNotification={}));var CR;(function(n){n.method="workspace/willDeleteFiles",n.type=new Gr.ProtocolRequestType(n.method)})(CR=je.WillDeleteFilesRequest||(je.WillDeleteFilesRequest={}))});var _f=k(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.MonikerRequest=fn.MonikerKind=fn.UniquenessLevel=void 0;var wR=Me(),RR;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(RR=fn.UniquenessLevel||(fn.UniquenessLevel={}));var bR;(function(n){n.import="import",n.export="export",n.local="local"})(bR=fn.MonikerKind||(fn.MonikerKind={}));var DR;(function(n){n.method="textDocument/moniker",n.type=new wR.ProtocolRequestType(n.method)})(DR=fn.MonikerRequest||(fn.MonikerRequest={}))});var Pf=k(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.TypeHierarchySubtypesRequest=pn.TypeHierarchySupertypesRequest=pn.TypeHierarchyPrepareRequest=void 0;var ma=Me(),TR;(function(n){n.method="textDocument/prepareTypeHierarchy",n.type=new ma.ProtocolRequestType(n.method)})(TR=pn.TypeHierarchyPrepareRequest||(pn.TypeHierarchyPrepareRequest={}));var SR;(function(n){n.method="typeHierarchy/supertypes",n.type=new ma.ProtocolRequestType(n.method)})(SR=pn.TypeHierarchySupertypesRequest||(pn.TypeHierarchySupertypesRequest={}));var _R;(function(n){n.method="typeHierarchy/subtypes",n.type=new ma.ProtocolRequestType(n.method)})(_R=pn.TypeHierarchySubtypesRequest||(pn.TypeHierarchySubtypesRequest={}))});var xf=k(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.InlineValueRefreshRequest=nr.InlineValueRequest=void 0;var Ef=Me(),PR;(function(n){n.method="textDocument/inlineValue",n.type=new Ef.ProtocolRequestType(n.method)})(PR=nr.InlineValueRequest||(nr.InlineValueRequest={}));var ER;(function(n){n.method="workspace/inlineValue/refresh",n.type=new Ef.ProtocolRequestType0(n.method)})(ER=nr.InlineValueRefreshRequest||(nr.InlineValueRefreshRequest={}))});var kf=k(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.InlayHintRefreshRequest=hn.InlayHintResolveRequest=hn.InlayHintRequest=void 0;var va=Me(),xR;(function(n){n.method="textDocument/inlayHint",n.type=new va.ProtocolRequestType(n.method)})(xR=hn.InlayHintRequest||(hn.InlayHintRequest={}));var kR;(function(n){n.method="inlayHint/resolve",n.type=new va.ProtocolRequestType(n.method)})(kR=hn.InlayHintResolveRequest||(hn.InlayHintResolveRequest={}));var qR;(function(n){n.method="workspace/inlayHint/refresh",n.type=new va.ProtocolRequestType0(n.method)})(qR=hn.InlayHintRefreshRequest||(hn.InlayHintRefreshRequest={}))});var Mf=k(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.CodeLensRequest=y.WorkspaceSymbolResolveRequest=y.WorkspaceSymbolRequest=y.CodeActionResolveRequest=y.CodeActionRequest=y.DocumentSymbolRequest=y.DocumentHighlightRequest=y.ReferencesRequest=y.DefinitionRequest=y.SignatureHelpRequest=y.SignatureHelpTriggerKind=y.HoverRequest=y.CompletionResolveRequest=y.CompletionRequest=y.CompletionTriggerKind=y.PublishDiagnosticsNotification=y.WatchKind=y.FileChangeType=y.DidChangeWatchedFilesNotification=y.WillSaveTextDocumentWaitUntilRequest=y.WillSaveTextDocumentNotification=y.TextDocumentSaveReason=y.DidSaveTextDocumentNotification=y.DidCloseTextDocumentNotification=y.DidChangeTextDocumentNotification=y.TextDocumentContentChangeEvent=y.DidOpenTextDocumentNotification=y.TextDocumentSyncKind=y.TelemetryEventNotification=y.LogMessageNotification=y.ShowMessageRequest=y.ShowMessageNotification=y.MessageType=y.DidChangeConfigurationNotification=y.ExitNotification=y.ShutdownRequest=y.InitializedNotification=y.InitializeError=y.InitializeRequest=y.WorkDoneProgressOptions=y.TextDocumentRegistrationOptions=y.StaticRegistrationOptions=y.FailureHandlingKind=y.ResourceOperationKind=y.UnregistrationRequest=y.RegistrationRequest=y.DocumentSelector=y.NotebookCellTextDocumentFilter=y.NotebookDocumentFilter=y.TextDocumentFilter=void 0;y.InlineValueRequest=y.TypeHierarchySupertypesRequest=y.TypeHierarchySubtypesRequest=y.TypeHierarchyPrepareRequest=y.MonikerRequest=y.MonikerKind=y.UniquenessLevel=y.WillDeleteFilesRequest=y.DidDeleteFilesNotification=y.WillRenameFilesRequest=y.DidRenameFilesNotification=y.WillCreateFilesRequest=y.DidCreateFilesNotification=y.FileOperationPatternKind=y.LinkedEditingRangeRequest=y.ShowDocumentRequest=y.SemanticTokensRegistrationType=y.SemanticTokensRefreshRequest=y.SemanticTokensRangeRequest=y.SemanticTokensDeltaRequest=y.SemanticTokensRequest=y.TokenFormat=y.CallHierarchyPrepareRequest=y.CallHierarchyOutgoingCallsRequest=y.CallHierarchyIncomingCallsRequest=y.WorkDoneProgressCancelNotification=y.WorkDoneProgressCreateRequest=y.WorkDoneProgress=y.SelectionRangeRequest=y.DeclarationRequest=y.FoldingRangeRequest=y.ColorPresentationRequest=y.DocumentColorRequest=y.ConfigurationRequest=y.DidChangeWorkspaceFoldersNotification=y.WorkspaceFoldersRequest=y.TypeDefinitionRequest=y.ImplementationRequest=y.ApplyWorkspaceEditRequest=y.ExecuteCommandRequest=y.PrepareRenameRequest=y.RenameRequest=y.PrepareSupportDefaultBehavior=y.DocumentOnTypeFormattingRequest=y.DocumentRangeFormattingRequest=y.DocumentFormattingRequest=y.DocumentLinkResolveRequest=y.DocumentLinkRequest=y.CodeLensRefreshRequest=y.CodeLensResolveRequest=void 0;y.InlayHintRefreshRequest=y.InlayHintResolveRequest=y.InlayHintRequest=y.InlineValueRefreshRequest=void 0;var re=Me(),kt=Po(),OR=uf();Object.defineProperty(y,"ImplementationRequest",{enumerable:!0,get:function(){return OR.ImplementationRequest}});var IR=lf();Object.defineProperty(y,"TypeDefinitionRequest",{enumerable:!0,get:function(){return IR.TypeDefinitionRequest}});var qf=ff();Object.defineProperty(y,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return qf.WorkspaceFoldersRequest}});Object.defineProperty(y,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return qf.DidChangeWorkspaceFoldersNotification}});var NR=pf();Object.defineProperty(y,"ConfigurationRequest",{enumerable:!0,get:function(){return NR.ConfigurationRequest}});var Of=gf();Object.defineProperty(y,"DocumentColorRequest",{enumerable:!0,get:function(){return Of.DocumentColorRequest}});Object.defineProperty(y,"ColorPresentationRequest",{enumerable:!0,get:function(){return Of.ColorPresentationRequest}});var FR=mf();Object.defineProperty(y,"FoldingRangeRequest",{enumerable:!0,get:function(){return FR.FoldingRangeRequest}});var LR=vf();Object.defineProperty(y,"DeclarationRequest",{enumerable:!0,get:function(){return LR.DeclarationRequest}});var AR=yf();Object.defineProperty(y,"SelectionRangeRequest",{enumerable:!0,get:function(){return AR.SelectionRangeRequest}});var ya=wf();Object.defineProperty(y,"WorkDoneProgress",{enumerable:!0,get:function(){return ya.WorkDoneProgress}});Object.defineProperty(y,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return ya.WorkDoneProgressCreateRequest}});Object.defineProperty(y,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return ya.WorkDoneProgressCancelNotification}});var Ca=Rf();Object.defineProperty(y,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Ca.CallHierarchyIncomingCallsRequest}});Object.defineProperty(y,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Ca.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(y,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Ca.CallHierarchyPrepareRequest}});var Xr=bf();Object.defineProperty(y,"TokenFormat",{enumerable:!0,get:function(){return Xr.TokenFormat}});Object.defineProperty(y,"SemanticTokensRequest",{enumerable:!0,get:function(){return Xr.SemanticTokensRequest}});Object.defineProperty(y,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return Xr.SemanticTokensDeltaRequest}});Object.defineProperty(y,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return Xr.SemanticTokensRangeRequest}});Object.defineProperty(y,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return Xr.SemanticTokensRefreshRequest}});Object.defineProperty(y,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return Xr.SemanticTokensRegistrationType}});var MR=Df();Object.defineProperty(y,"ShowDocumentRequest",{enumerable:!0,get:function(){return MR.ShowDocumentRequest}});var jR=Tf();Object.defineProperty(y,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return jR.LinkedEditingRangeRequest}});var Tr=Sf();Object.defineProperty(y,"FileOperationPatternKind",{enumerable:!0,get:function(){return Tr.FileOperationPatternKind}});Object.defineProperty(y,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Tr.DidCreateFilesNotification}});Object.defineProperty(y,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Tr.WillCreateFilesRequest}});Object.defineProperty(y,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Tr.DidRenameFilesNotification}});Object.defineProperty(y,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Tr.WillRenameFilesRequest}});Object.defineProperty(y,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Tr.DidDeleteFilesNotification}});Object.defineProperty(y,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Tr.WillDeleteFilesRequest}});var wa=_f();Object.defineProperty(y,"UniquenessLevel",{enumerable:!0,get:function(){return wa.UniquenessLevel}});Object.defineProperty(y,"MonikerKind",{enumerable:!0,get:function(){return wa.MonikerKind}});Object.defineProperty(y,"MonikerRequest",{enumerable:!0,get:function(){return wa.MonikerRequest}});var Ra=Pf();Object.defineProperty(y,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Ra.TypeHierarchyPrepareRequest}});Object.defineProperty(y,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Ra.TypeHierarchySubtypesRequest}});Object.defineProperty(y,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Ra.TypeHierarchySupertypesRequest}});var If=xf();Object.defineProperty(y,"InlineValueRequest",{enumerable:!0,get:function(){return If.InlineValueRequest}});Object.defineProperty(y,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return If.InlineValueRefreshRequest}});var ba=kf();Object.defineProperty(y,"InlayHintRequest",{enumerable:!0,get:function(){return ba.InlayHintRequest}});Object.defineProperty(y,"InlayHintResolveRequest",{enumerable:!0,get:function(){return ba.InlayHintResolveRequest}});Object.defineProperty(y,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return ba.InlayHintRefreshRequest}});var Nf;(function(n){function e(t){let r=t;return kt.string(r.language)||kt.string(r.scheme)||kt.string(r.pattern)}n.is=e})(Nf=y.TextDocumentFilter||(y.TextDocumentFilter={}));var Ff;(function(n){function e(t){let r=t;return kt.objectLiteral(r)&&(kt.string(r.notebookType)||kt.string(r.scheme)||kt.string(r.pattern))}n.is=e})(Ff=y.NotebookDocumentFilter||(y.NotebookDocumentFilter={}));var Lf;(function(n){function e(t){let r=t;return kt.objectLiteral(r)&&(kt.string(r.notebook)||Ff.is(r.notebook))&&(r.language===void 0||kt.string(r.language))}n.is=e})(Lf=y.NotebookCellTextDocumentFilter||(y.NotebookCellTextDocumentFilter={}));var Af;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!kt.string(r)&&!Nf.is(r)&&!Lf.is(r))return!1;return!0}n.is=e})(Af=y.DocumentSelector||(y.DocumentSelector={}));var $R;(function(n){n.type=new re.ProtocolRequestType("client/registerCapability")})($R=y.RegistrationRequest||(y.RegistrationRequest={}));var HR;(function(n){n.type=new re.ProtocolRequestType("client/unregisterCapability")})(HR=y.UnregistrationRequest||(y.UnregistrationRequest={}));var WR;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(WR=y.ResourceOperationKind||(y.ResourceOperationKind={}));var zR;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(zR=y.FailureHandlingKind||(y.FailureHandlingKind={}));var UR;(function(n){function e(t){let r=t;return r&&kt.string(r.id)&&r.id.length>0}n.hasId=e})(UR=y.StaticRegistrationOptions||(y.StaticRegistrationOptions={}));var KR;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Af.is(r.documentSelector))}n.is=e})(KR=y.TextDocumentRegistrationOptions||(y.TextDocumentRegistrationOptions={}));var VR;(function(n){function e(r){let i=r;return kt.objectLiteral(i)&&(i.workDoneProgress===void 0||kt.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&kt.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(VR=y.WorkDoneProgressOptions||(y.WorkDoneProgressOptions={}));var BR;(function(n){n.type=new re.ProtocolRequestType("initialize")})(BR=y.InitializeRequest||(y.InitializeRequest={}));var GR;(function(n){n.unknownProtocolVersion=1})(GR=y.InitializeError||(y.InitializeError={}));var XR;(function(n){n.type=new re.ProtocolNotificationType("initialized")})(XR=y.InitializedNotification||(y.InitializedNotification={}));var QR;(function(n){n.type=new re.ProtocolRequestType0("shutdown")})(QR=y.ShutdownRequest||(y.ShutdownRequest={}));var JR;(function(n){n.type=new re.ProtocolNotificationType0("exit")})(JR=y.ExitNotification||(y.ExitNotification={}));var YR;(function(n){n.type=new re.ProtocolNotificationType("workspace/didChangeConfiguration")})(YR=y.DidChangeConfigurationNotification||(y.DidChangeConfigurationNotification={}));var ZR;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4})(ZR=y.MessageType||(y.MessageType={}));var eb;(function(n){n.type=new re.ProtocolNotificationType("window/showMessage")})(eb=y.ShowMessageNotification||(y.ShowMessageNotification={}));var tb;(function(n){n.type=new re.ProtocolRequestType("window/showMessageRequest")})(tb=y.ShowMessageRequest||(y.ShowMessageRequest={}));var nb;(function(n){n.type=new re.ProtocolNotificationType("window/logMessage")})(nb=y.LogMessageNotification||(y.LogMessageNotification={}));var rb;(function(n){n.type=new re.ProtocolNotificationType("telemetry/event")})(rb=y.TelemetryEventNotification||(y.TelemetryEventNotification={}));var ib;(function(n){n.None=0,n.Full=1,n.Incremental=2})(ib=y.TextDocumentSyncKind||(y.TextDocumentSyncKind={}));var ob;(function(n){n.method="textDocument/didOpen",n.type=new re.ProtocolNotificationType(n.method)})(ob=y.DidOpenTextDocumentNotification||(y.DidOpenTextDocumentNotification={}));var sb;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(sb=y.TextDocumentContentChangeEvent||(y.TextDocumentContentChangeEvent={}));var ab;(function(n){n.method="textDocument/didChange",n.type=new re.ProtocolNotificationType(n.method)})(ab=y.DidChangeTextDocumentNotification||(y.DidChangeTextDocumentNotification={}));var cb;(function(n){n.method="textDocument/didClose",n.type=new re.ProtocolNotificationType(n.method)})(cb=y.DidCloseTextDocumentNotification||(y.DidCloseTextDocumentNotification={}));var ub;(function(n){n.method="textDocument/didSave",n.type=new re.ProtocolNotificationType(n.method)})(ub=y.DidSaveTextDocumentNotification||(y.DidSaveTextDocumentNotification={}));var lb;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(lb=y.TextDocumentSaveReason||(y.TextDocumentSaveReason={}));var db;(function(n){n.method="textDocument/willSave",n.type=new re.ProtocolNotificationType(n.method)})(db=y.WillSaveTextDocumentNotification||(y.WillSaveTextDocumentNotification={}));var fb;(function(n){n.method="textDocument/willSaveWaitUntil",n.type=new re.ProtocolRequestType(n.method)})(fb=y.WillSaveTextDocumentWaitUntilRequest||(y.WillSaveTextDocumentWaitUntilRequest={}));var pb;(function(n){n.type=new re.ProtocolNotificationType("workspace/didChangeWatchedFiles")})(pb=y.DidChangeWatchedFilesNotification||(y.DidChangeWatchedFilesNotification={}));var hb;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(hb=y.FileChangeType||(y.FileChangeType={}));var gb;(function(n){n.Create=1,n.Change=2,n.Delete=4})(gb=y.WatchKind||(y.WatchKind={}));var mb;(function(n){n.type=new re.ProtocolNotificationType("textDocument/publishDiagnostics")})(mb=y.PublishDiagnosticsNotification||(y.PublishDiagnosticsNotification={}));var vb;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(vb=y.CompletionTriggerKind||(y.CompletionTriggerKind={}));var yb;(function(n){n.method="textDocument/completion",n.type=new re.ProtocolRequestType(n.method)})(yb=y.CompletionRequest||(y.CompletionRequest={}));var Cb;(function(n){n.method="completionItem/resolve",n.type=new re.ProtocolRequestType(n.method)})(Cb=y.CompletionResolveRequest||(y.CompletionResolveRequest={}));var wb;(function(n){n.method="textDocument/hover",n.type=new re.ProtocolRequestType(n.method)})(wb=y.HoverRequest||(y.HoverRequest={}));var Rb;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(Rb=y.SignatureHelpTriggerKind||(y.SignatureHelpTriggerKind={}));var bb;(function(n){n.method="textDocument/signatureHelp",n.type=new re.ProtocolRequestType(n.method)})(bb=y.SignatureHelpRequest||(y.SignatureHelpRequest={}));var Db;(function(n){n.method="textDocument/definition",n.type=new re.ProtocolRequestType(n.method)})(Db=y.DefinitionRequest||(y.DefinitionRequest={}));var Tb;(function(n){n.method="textDocument/references",n.type=new re.ProtocolRequestType(n.method)})(Tb=y.ReferencesRequest||(y.ReferencesRequest={}));var Sb;(function(n){n.method="textDocument/documentHighlight",n.type=new re.ProtocolRequestType(n.method)})(Sb=y.DocumentHighlightRequest||(y.DocumentHighlightRequest={}));var _b;(function(n){n.method="textDocument/documentSymbol",n.type=new re.ProtocolRequestType(n.method)})(_b=y.DocumentSymbolRequest||(y.DocumentSymbolRequest={}));var Pb;(function(n){n.method="textDocument/codeAction",n.type=new re.ProtocolRequestType(n.method)})(Pb=y.CodeActionRequest||(y.CodeActionRequest={}));var Eb;(function(n){n.method="codeAction/resolve",n.type=new re.ProtocolRequestType(n.method)})(Eb=y.CodeActionResolveRequest||(y.CodeActionResolveRequest={}));var xb;(function(n){n.method="workspace/symbol",n.type=new re.ProtocolRequestType(n.method)})(xb=y.WorkspaceSymbolRequest||(y.WorkspaceSymbolRequest={}));var kb;(function(n){n.method="workspaceSymbol/resolve",n.type=new re.ProtocolRequestType(n.method)})(kb=y.WorkspaceSymbolResolveRequest||(y.WorkspaceSymbolResolveRequest={}));var qb;(function(n){n.method="textDocument/codeLens",n.type=new re.ProtocolRequestType(n.method)})(qb=y.CodeLensRequest||(y.CodeLensRequest={}));var Ob;(function(n){n.method="codeLens/resolve",n.type=new re.ProtocolRequestType(n.method)})(Ob=y.CodeLensResolveRequest||(y.CodeLensResolveRequest={}));var Ib;(function(n){n.method="workspace/codeLens/refresh",n.type=new re.ProtocolRequestType0(n.method)})(Ib=y.CodeLensRefreshRequest||(y.CodeLensRefreshRequest={}));var Nb;(function(n){n.method="textDocument/documentLink",n.type=new re.ProtocolRequestType(n.method)})(Nb=y.DocumentLinkRequest||(y.DocumentLinkRequest={}));var Fb;(function(n){n.method="documentLink/resolve",n.type=new re.ProtocolRequestType(n.method)})(Fb=y.DocumentLinkResolveRequest||(y.DocumentLinkResolveRequest={}));var Lb;(function(n){n.method="textDocument/formatting",n.type=new re.ProtocolRequestType(n.method)})(Lb=y.DocumentFormattingRequest||(y.DocumentFormattingRequest={}));var Ab;(function(n){n.method="textDocument/rangeFormatting",n.type=new re.ProtocolRequestType(n.method)})(Ab=y.DocumentRangeFormattingRequest||(y.DocumentRangeFormattingRequest={}));var Mb;(function(n){n.method="textDocument/onTypeFormatting",n.type=new re.ProtocolRequestType(n.method)})(Mb=y.DocumentOnTypeFormattingRequest||(y.DocumentOnTypeFormattingRequest={}));var jb;(function(n){n.Identifier=1})(jb=y.PrepareSupportDefaultBehavior||(y.PrepareSupportDefaultBehavior={}));var $b;(function(n){n.method="textDocument/rename",n.type=new re.ProtocolRequestType(n.method)})($b=y.RenameRequest||(y.RenameRequest={}));var Hb;(function(n){n.method="textDocument/prepareRename",n.type=new re.ProtocolRequestType(n.method)})(Hb=y.PrepareRenameRequest||(y.PrepareRenameRequest={}));var Wb;(function(n){n.type=new re.ProtocolRequestType("workspace/executeCommand")})(Wb=y.ExecuteCommandRequest||(y.ExecuteCommandRequest={}));var zb;(function(n){n.type=new re.ProtocolRequestType("workspace/applyEdit")})(zb=y.ApplyWorkspaceEditRequest||(y.ApplyWorkspaceEditRequest={}))});var $f=k(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.createProtocolConnection=void 0;var jf=Dr();function Ub(n,e,t,r){return jf.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,jf.createMessageConnection)(n,e,t,r)}Eo.createProtocolConnection=Ub});var Wf=k(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.DiagnosticRefreshRequest=ft.WorkspaceDiagnosticRequest=ft.DocumentDiagnosticRequest=ft.DocumentDiagnosticReportKind=ft.DiagnosticServerCancellationData=void 0;var Hf=Dr(),Kb=Po(),Da=Me(),Vb;(function(n){function e(t){let r=t;return r&&Kb.boolean(r.retriggerRequest)}n.is=e})(Vb=ft.DiagnosticServerCancellationData||(ft.DiagnosticServerCancellationData={}));var Bb;(function(n){n.full="full",n.unChanged="unChanged"})(Bb=ft.DocumentDiagnosticReportKind||(ft.DocumentDiagnosticReportKind={}));var Gb;(function(n){n.method="textDocument/diagnostic",n.type=new Da.ProtocolRequestType(n.method),n.partialResult=new Hf.ProgressType})(Gb=ft.DocumentDiagnosticRequest||(ft.DocumentDiagnosticRequest={}));var Xb;(function(n){n.method="workspace/diagnostic",n.type=new Da.ProtocolRequestType(n.method),n.partialResult=new Hf.ProgressType})(Xb=ft.WorkspaceDiagnosticRequest||(ft.WorkspaceDiagnosticRequest={}));var Qb;(function(n){n.method="workspace/diagnostic/refresh",n.type=new Da.ProtocolRequestType0(n.method)})(Qb=ft.DiagnosticRefreshRequest||(ft.DiagnosticRefreshRequest={}))});var Kf=k(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.DidCloseNotebookDocumentNotification=ye.DidSaveNotebookDocumentNotification=ye.DidChangeNotebookDocumentNotification=ye.NotebookCellArrayChange=ye.DidOpenNotebookDocumentNotification=ye.NotebookDocumentSyncRegistrationType=ye.NotebookDocument=ye.NotebookCell=ye.ExecutionSummary=ye.NotebookCellKind=void 0;var $i=ha(),gn=Po(),Hi=Me(),zf;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(zf=ye.NotebookCellKind||(ye.NotebookCellKind={}));var Uf;(function(n){function e(i,o){let s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){let o=i;return gn.objectLiteral(o)&&$i.uinteger.is(o.executionOrder)&&(o.success===void 0||gn.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})(Uf=ye.ExecutionSummary||(ye.ExecutionSummary={}));var Ta;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){let s=o;return gn.objectLiteral(s)&&zf.is(s.kind)&&$i.DocumentUri.is(s.document)&&(s.metadata===void 0||gn.objectLiteral(s.metadata))}n.is=t;function r(o,s){let a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!Uf.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;let a=Array.isArray(o),c=Array.isArray(s);if(a!==c)return!1;if(a&&c){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!i(o[l],s[l]))return!1}if(gn.objectLiteral(o)&&gn.objectLiteral(s)){let l=Object.keys(o),g=Object.keys(s);if(l.length!==g.length||(l.sort(),g.sort(),!i(l,g)))return!1;for(let v=0;v<l.length;v++){let h=l[v];if(!i(o[h],s[h]))return!1}}return!0}})(Ta=ye.NotebookCell||(ye.NotebookCell={}));var Jb;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){let i=r;return gn.objectLiteral(i)&&gn.string(i.uri)&&$i.integer.is(i.version)&&gn.typedArray(i.cells,Ta.is)}n.is=t})(Jb=ye.NotebookDocument||(ye.NotebookDocument={}));var Yb;(function(n){n.method="notebookDocument/sync",n.type=new Hi.RegistrationType(n.method)})(Yb=ye.NotebookDocumentSyncRegistrationType||(ye.NotebookDocumentSyncRegistrationType={}));var Zb;(function(n){n.method="notebookDocument/didOpen",n.type=new Hi.ProtocolNotificationType(n.method)})(Zb=ye.DidOpenNotebookDocumentNotification||(ye.DidOpenNotebookDocumentNotification={}));var eD;(function(n){function e(r){let i=r;return gn.objectLiteral(i)&&$i.uinteger.is(i.start)&&$i.uinteger.is(i.deleteCount)&&(i.cells===void 0||gn.typedArray(i.cells,Ta.is))}n.is=e;function t(r,i,o){let s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(eD=ye.NotebookCellArrayChange||(ye.NotebookCellArrayChange={}));var tD;(function(n){n.method="notebookDocument/didChange",n.type=new Hi.ProtocolNotificationType(n.method)})(tD=ye.DidChangeNotebookDocumentNotification||(ye.DidChangeNotebookDocumentNotification={}));var nD;(function(n){n.method="notebookDocument/didSave",n.type=new Hi.ProtocolNotificationType(n.method)})(nD=ye.DidSaveNotebookDocumentNotification||(ye.DidSaveNotebookDocumentNotification={}));var rD;(function(n){n.method="notebookDocument/didClose",n.type=new Hi.ProtocolNotificationType(n.method)})(rD=ye.DidCloseNotebookDocumentNotification||(ye.DidCloseNotebookDocumentNotification={}))});var Vf=k(st=>{"use strict";var iD=st&&st.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),xo=st&&st.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&iD(e,n,t)};Object.defineProperty(st,"__esModule",{value:!0});st.Proposed=st.LSPErrorCodes=st.createProtocolConnection=void 0;xo(Dr(),st);xo(ha(),st);xo(Me(),st);xo(Mf(),st);var oD=$f();Object.defineProperty(st,"createProtocolConnection",{enumerable:!0,get:function(){return oD.createProtocolConnection}});var sD;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(sD=st.LSPErrorCodes||(st.LSPErrorCodes={}));var Wi=Wf(),rr=Kf(),aD;(function(n){n.DiagnosticServerCancellationData=Wi.DiagnosticServerCancellationData,n.DocumentDiagnosticReportKind=Wi.DocumentDiagnosticReportKind,n.DocumentDiagnosticRequest=Wi.DocumentDiagnosticRequest,n.WorkspaceDiagnosticRequest=Wi.WorkspaceDiagnosticRequest,n.DiagnosticRefreshRequest=Wi.DiagnosticRefreshRequest,n.NotebookCellKind=rr.NotebookCellKind,n.NotebookCell=rr.NotebookCell,n.NotebookDocument=rr.NotebookDocument,n.NotebookDocumentSyncRegistrationType=rr.NotebookDocumentSyncRegistrationType,n.DidOpenNotebookDocumentNotification=rr.DidOpenNotebookDocumentNotification,n.DidChangeNotebookDocumentNotification=rr.DidChangeNotebookDocumentNotification,n.DidSaveNotebookDocumentNotification=rr.DidSaveNotebookDocumentNotification,n.DidCloseNotebookDocumentNotification=rr.DidCloseNotebookDocumentNotification})(aD=st.Proposed||(st.Proposed={}))});var Te=k(bn=>{"use strict";var cD=bn&&bn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Bf=bn&&bn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&cD(e,n,t)};Object.defineProperty(bn,"__esModule",{value:!0});bn.createProtocolConnection=void 0;var uD=pa();Bf(pa(),bn);Bf(Vf(),bn);function lD(n,e,t,r){return(0,uD.createMessageConnection)(n,e,t,r)}bn.createProtocolConnection=lD});var _a=k(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.toJSONObject=Jr.ConfigurationFeature=void 0;var Sa=require("vscode"),dD=Te(),Gf=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(dD.ConfigurationRequest.type,(t,r)=>{let i=s=>{let a=[];for(let c of s.items){let l=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(l,c.section!==null?c.section:void 0))}return a},o=e.clientOptions.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Qr(Sa.workspace.getConfiguration(void 0,e).get(t));else{let o=Sa.workspace.getConfiguration(t.substr(0,i),e);o&&(r=Qr(o.get(t.substr(i+1))))}}else{let i=Sa.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=Qr(i.get(o)))}return r===void 0&&(r=null),r}dispose(){}};Jr.ConfigurationFeature=Gf;function Qr(n){if(n){if(Array.isArray(n))return n.map(Qr);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Qr(n[t]));return e}}return n}Jr.toJSONObject=Qr});var qo=k(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.forEach=tn.mapAsync=tn.map=tn.Semaphore=tn.Delayer=void 0;var zi=Te(),Qf=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,zi.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};tn.Delayer=Qf;var Jf=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,zi.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};tn.Semaphore=Jf;var Xf=15,ko=class{constructor(e=Xf){this.yieldAfter=Math.max(e,Xf),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function fD(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new ko(r==null?void 0:r.yieldAfter);function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=e(n[l]),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,zi.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}tn.map=fD;async function pD(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new ko(r==null?void 0:r.yieldAfter);async function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=await e(n[l],t),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,zi.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}tn.mapAsync=pD;async function hD(n,e,t,r){if(n.length===0)return;let i=new ko(r==null?void 0:r.yieldAfter);function o(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),c+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(a=>{(0,zi.RAL)().timer.setImmediate(()=>{a(o(s))})})}tn.forEach=hD});var Ea=k(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});var gD=require("vscode"),Yf=class extends gD.CompletionItem{constructor(e){super(e)}};Pa.default=Yf});var ka=k(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});var mD=require("vscode"),Zf=class extends mD.CodeLens{constructor(e){super(e)}};xa.default=Zf});var Oa=k(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});var vD=require("vscode"),ep=class extends vD.DocumentLink{constructor(e,t){super(e,t)}};qa.default=ep});var Na=k(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});var yD=require("vscode"),tp=class extends yD.CodeAction{constructor(e,t){super(e);this.data=t}};Ia.default=tp});var La=k(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.ProtocolDiagnostic=Sr.DiagnosticCode=void 0;var CD=require("vscode"),Fa=wn(),wD;(function(n){function e(t){let r=t;return r!=null&&(Fa.number(r.value)||Fa.string(r.value))&&Fa.string(r.target)}n.is=e})(wD=Sr.DiagnosticCode||(Sr.DiagnosticCode={}));var np=class extends CD.Diagnostic{constructor(e,t,r,i){super(e,t,r);this.data=i,this.hasDiagnosticCode=!1}};Sr.ProtocolDiagnostic=np});var Ma=k(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});var RD=require("vscode"),rp=class extends RD.CallHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s);a!==void 0&&(this.data=a)}};Aa.default=rp});var $a=k(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});var bD=require("vscode"),ip=class extends bD.TypeHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s);a!==void 0&&(this.data=a)}};ja.default=ip});var Wa=k(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});var Oo=require("vscode"),op=class extends Oo.SymbolInformation{constructor(e,t,r,i,o){let s=!(i instanceof Oo.Uri);super(e,t,r,s?i:new Oo.Location(i,new Oo.Range(0,0,0,0)));this.hasRange=s,o!==void 0&&(this.data=o)}};Ha.default=op});var Ua=k(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});var DD=require("vscode"),sp=class extends DD.InlayHint{constructor(e,t,r){super(e,t,r)}};za.default=sp});var up=k(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.createConverter=void 0;var Ze=require("vscode"),oe=Te(),Yr=wn(),ap=qo(),TD=Ea(),SD=ka(),_D=Oa(),PD=Na(),cp=La(),ED=Ma(),xD=$a(),kD=Wa(),qD=Ua(),Ka;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Ka||(Ka={}));function OD(n){let t=n||(p=>p.toString());function r(p){return t(p)}function i(p){return{uri:t(p.uri)}}function o(p){return{uri:t(p.uri),languageId:p.languageId,version:p.version,text:p.getText()}}function s(p){return{uri:t(p.uri),version:p.version}}function a(p){return{textDocument:o(p)}}function c(p){let E=p;return!!E.document&&!!E.contentChanges}function l(p){let E=p;return!!E.uri&&!!E.version}function g(p){if(l(p))return{textDocument:{uri:t(p.uri),version:p.version},contentChanges:[{text:p.getText()}]};if(c(p)){let E=p.document;return{textDocument:{uri:t(E.uri),version:E.version},contentChanges:p.contentChanges.map(S=>{let f=S.range;return{range:{start:{line:f.start.line,character:f.start.character},end:{line:f.end.line,character:f.end.character}},rangeLength:S.rangeLength,text:S.text}})}}else throw Error("Unsupported text document change parameter")}function v(p){return{textDocument:i(p)}}function h(p,E=!1){let z={textDocument:i(p)};return E&&(z.text=p.getText()),z}function C(p){switch(p){case Ze.TextDocumentSaveReason.Manual:return oe.TextDocumentSaveReason.Manual;case Ze.TextDocumentSaveReason.AfterDelay:return oe.TextDocumentSaveReason.AfterDelay;case Ze.TextDocumentSaveReason.FocusOut:return oe.TextDocumentSaveReason.FocusOut}return oe.TextDocumentSaveReason.Manual}function b(p){return{textDocument:i(p.document),reason:C(p.reason)}}function x(p){return{files:p.files.map(E=>({uri:t(E)}))}}function q(p){return{files:p.files.map(E=>({oldUri:t(E.oldUri),newUri:t(E.newUri)}))}}function O(p){return{files:p.files.map(E=>({uri:t(E)}))}}function I(p){return{files:p.files.map(E=>({uri:t(E)}))}}function N(p){return{files:p.files.map(E=>({oldUri:t(E.oldUri),newUri:t(E.newUri)}))}}function $(p){return{files:p.files.map(E=>({uri:t(E)}))}}function K(p,E){return{textDocument:i(p),position:at(E)}}function de(p){switch(p){case Ze.CompletionTriggerKind.TriggerCharacter:return oe.CompletionTriggerKind.TriggerCharacter;case Ze.CompletionTriggerKind.TriggerForIncompleteCompletions:return oe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return oe.CompletionTriggerKind.Invoked}}function se(p,E,z){return{textDocument:i(p),position:at(E),context:{triggerKind:de(z.triggerKind),triggerCharacter:z.triggerCharacter}}}function He(p){switch(p){case Ze.SignatureHelpTriggerKind.Invoke:return oe.SignatureHelpTriggerKind.Invoked;case Ze.SignatureHelpTriggerKind.TriggerCharacter:return oe.SignatureHelpTriggerKind.TriggerCharacter;case Ze.SignatureHelpTriggerKind.ContentChange:return oe.SignatureHelpTriggerKind.ContentChange}}function Ge(p){return{label:p.label}}function rt(p){return p.map(Ge)}function Tt(p){return{label:p.label,parameters:rt(p.parameters)}}function gt(p){return p.map(Tt)}function mt(p){return p===void 0?p:{signatures:gt(p.signatures),activeSignature:p.activeSignature,activeParameter:p.activeParameter}}function St(p,E,z){return{textDocument:i(p),position:at(E),context:{isRetrigger:z.isRetrigger,triggerCharacter:z.triggerCharacter,triggerKind:He(z.triggerKind),activeSignatureHelp:mt(z.activeSignatureHelp)}}}function at(p){return{line:p.line,character:p.character}}function vt(p){return p==null?p:{line:p.line>oe.uinteger.MAX_VALUE?oe.uinteger.MAX_VALUE:p.line,character:p.character>oe.uinteger.MAX_VALUE?oe.uinteger.MAX_VALUE:p.character}}function xn(p,E){return ap.map(p,vt,E)}function Le(p){return p==null?p:{start:vt(p.start),end:vt(p.end)}}function tt(p){return p==null?p:oe.Location.create(r(p.uri),Le(p.range))}function ct(p){switch(p){case Ze.DiagnosticSeverity.Error:return oe.DiagnosticSeverity.Error;case Ze.DiagnosticSeverity.Warning:return oe.DiagnosticSeverity.Warning;case Ze.DiagnosticSeverity.Information:return oe.DiagnosticSeverity.Information;case Ze.DiagnosticSeverity.Hint:return oe.DiagnosticSeverity.Hint}}function Ft(p){if(!p)return;let E=[];for(let z of p){let S=Xe(z);S!==void 0&&E.push(S)}return E.length>0?E:void 0}function Xe(p){switch(p){case Ze.DiagnosticTag.Unnecessary:return oe.DiagnosticTag.Unnecessary;case Ze.DiagnosticTag.Deprecated:return oe.DiagnosticTag.Deprecated;default:return}}function ur(p){return{message:p.message,location:tt(p.location)}}function Vn(p){return p.map(ur)}function Bn(p){if(p!=null)return Yr.number(p)||Yr.string(p)?p:{value:p.value,target:r(p.target)}}function kn(p){let E=oe.Diagnostic.create(Le(p.range),p.message),z=p instanceof cp.ProtocolDiagnostic?p:void 0;z!==void 0&&z.data!==void 0&&(E.data=z.data);let S=Bn(p.code);return cp.DiagnosticCode.is(S)?z!==void 0&&z.hasDiagnosticCode?E.code=S:(E.code=S.value,E.codeDescription={href:S.target}):E.code=S,Yr.number(p.severity)&&(E.severity=ct(p.severity)),Array.isArray(p.tags)&&(E.tags=Ft(p.tags)),p.relatedInformation&&(E.relatedInformation=Vn(p.relatedInformation)),p.source&&(E.source=p.source),E}function qn(p,E){return p==null?p:ap.map(p,kn,E)}function lr(p,E){switch(p){case"$string":return E;case oe.MarkupKind.PlainText:return{kind:p,value:E};case oe.MarkupKind.Markdown:return{kind:p,value:E.value};default:return`Unsupported Markup content received. Kind is: ${p}`}}function Gn(p){switch(p){case Ze.CompletionItemTag.Deprecated:return oe.CompletionItemTag.Deprecated}}function Xn(p){if(p===void 0)return p;let E=[];for(let z of p){let S=Gn(z);S!==void 0&&E.push(S)}return E}function yt(p,E){return E!==void 0?E:p+1}function Gt(p,E=!1){let z,S;Yr.string(p.label)?z=p.label:(z=p.label.label,E&&(p.label.detail!==void 0||p.label.description!==void 0)&&(S={detail:p.label.detail,description:p.label.description}));let f={label:z};S!==void 0&&(f.labelDetails=S);let D=p instanceof TD.default?p:void 0;p.detail&&(f.detail=p.detail),p.documentation&&(!D||D.documentationFormat==="$string"?f.documentation=p.documentation:f.documentation=lr(D.documentationFormat,p.documentation)),p.filterText&&(f.filterText=p.filterText),Qn(f,p),Yr.number(p.kind)&&(f.kind=yt(p.kind,D&&D.originalItemKind)),p.sortText&&(f.sortText=p.sortText),p.additionalTextEdits&&(f.additionalTextEdits=yn(p.additionalTextEdits)),p.commitCharacters&&(f.commitCharacters=p.commitCharacters.slice()),p.command&&(f.command=Ht(p.command)),(p.preselect===!0||p.preselect===!1)&&(f.preselect=p.preselect);let T=Xn(p.tags);if(D){if(D.data!==void 0&&(f.data=D.data),D.deprecated===!0||D.deprecated===!1){if(D.deprecated===!0&&T!==void 0&&T.length>0){let m=T.indexOf(Ze.CompletionItemTag.Deprecated);m!==-1&&T.splice(m,1)}f.deprecated=D.deprecated}D.insertTextMode!==void 0&&(f.insertTextMode=D.insertTextMode)}return T!==void 0&&T.length>0&&(f.tags=T),f.insertTextMode===void 0&&p.keepWhitespace===!0&&(f.insertTextMode=oe.InsertTextMode.adjustIndentation),f}function Qn(p,E){let z=oe.InsertTextFormat.PlainText,S,f;E.textEdit?(S=E.textEdit.newText,f=E.textEdit.range):E.insertText instanceof Ze.SnippetString?(z=oe.InsertTextFormat.Snippet,S=E.insertText.value):S=E.insertText,E.range&&(f=E.range),p.insertTextFormat=z,E.fromEdit&&S!==void 0&&f!==void 0?p.textEdit=Mt(S,f):p.insertText=S}function Mt(p,E){return Ka.is(E)?oe.InsertReplaceEdit.create(p,Le(E.inserting),Le(E.replacing)):{newText:p,range:Le(E)}}function On(p){return{range:Le(p.range),newText:p.newText}}function yn(p){return p==null?p:p.map(On)}function jt(p){return p<=Ze.SymbolKind.TypeParameter?p+1:oe.SymbolKind.Property}function Lt(p){return p}function Qe(p){return p.map(Lt)}function dr(p,E,z){return{textDocument:i(p),position:at(E),context:{includeDeclaration:z.includeDeclaration}}}async function _t(p,E){let z=oe.CodeAction.create(p.title);if(p instanceof PD.default&&p.data!==void 0&&(z.data=p.data),p.kind!==void 0&&(z.kind=In(p.kind)),p.diagnostics!==void 0&&(z.diagnostics=await qn(p.diagnostics,E)),p.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return p.command!==void 0&&(z.command=Ht(p.command)),p.isPreferred!==void 0&&(z.isPreferred=p.isPreferred),p.disabled!==void 0&&(z.disabled={reason:p.disabled.reason}),z}async function $t(p,E){if(p==null)return p;let z;return p.only&&Yr.string(p.only.value)&&(z=[p.only.value]),oe.CodeActionContext.create(await qn(p.diagnostics,E),z,Cn(p.triggerKind))}function Cn(p){switch(p){case Ze.CodeActionTriggerKind.Invoke:return oe.CodeActionTriggerKind.Invoked;case Ze.CodeActionTriggerKind.Automatic:return oe.CodeActionTriggerKind.Automatic;default:return}}function In(p){if(p!=null)return p.value}function Nn(p){return p==null?p:oe.InlineValueContext.create(p.frameId,p.stoppedLocation)}function Ht(p){let E=oe.Command.create(p.title,p.command);return p.arguments&&(E.arguments=p.arguments),E}function Xt(p){let E=oe.CodeLens.create(Le(p.range));return p.command&&(E.command=Ht(p.command)),p instanceof SD.default&&p.data&&(E.data=p.data),E}function R(p,E){let z={tabSize:p.tabSize,insertSpaces:p.insertSpaces};return E.trimTrailingWhitespace&&(z.trimTrailingWhitespace=!0),E.trimFinalNewlines&&(z.trimFinalNewlines=!0),E.insertFinalNewline&&(z.insertFinalNewline=!0),z}function F(p){return{textDocument:i(p)}}function H(p){return{textDocument:i(p)}}function V(p){let E=oe.DocumentLink.create(Le(p.range));p.target&&(E.target=r(p.target)),p.tooltip!==void 0&&(E.tooltip=p.tooltip);let z=p instanceof _D.default?p:void 0;return z&&z.data&&(E.data=z.data),E}function he(p){return{textDocument:i(p)}}function ge(p){let E={name:p.name,kind:jt(p.kind),uri:r(p.uri),range:Le(p.range),selectionRange:Le(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(E.detail=p.detail),p.tags!==void 0&&(E.tags=Qe(p.tags)),p instanceof ED.default&&p.data!==void 0&&(E.data=p.data),E}function me(p){let E={name:p.name,kind:jt(p.kind),uri:r(p.uri),range:Le(p.range),selectionRange:Le(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(E.detail=p.detail),p.tags!==void 0&&(E.tags=Qe(p.tags)),p instanceof xD.default&&p.data!==void 0&&(E.data=p.data),E}function ke(p){let E=p instanceof kD.default?{name:p.name,kind:jt(p.kind),location:p.hasRange?tt(p.location):{uri:t(p.location.uri)},data:p.data}:{name:p.name,kind:jt(p.kind),location:tt(p.location)};return p.tags!==void 0&&(E.tags=Qe(p.tags)),p.containerName!==""&&(E.containerName=p.containerName),E}function ce(p){let E=typeof p.label=="string"?p.label:p.label.map(Ce),z=oe.InlayHint.create(vt(p.position),E);return p.kind!==void 0&&(z.kind=p.kind),p.textEdits!==void 0&&(z.textEdits=yn(p.textEdits)),p.tooltip!==void 0&&(z.tooltip=ue(p.tooltip)),p.paddingLeft!==void 0&&(z.paddingLeft=p.paddingLeft),p.paddingRight!==void 0&&(z.paddingRight=p.paddingRight),p instanceof qD.default&&p.data!==void 0&&(z.data=p.data),z}function Ce(p){let E=oe.InlayHintLabelPart.create(p.value);return p.location!==void 0&&(E.location=tt(p.location)),p.command!==void 0&&(E.command=Ht(p.command)),p.tooltip!==void 0&&(E.tooltip=ue(p.tooltip)),E}function ue(p){return typeof p=="string"?p:{kind:oe.MarkupKind.Markdown,value:p.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:g,asCloseTextDocumentParams:v,asSaveTextDocumentParams:h,asWillSaveTextDocumentParams:b,asDidCreateFilesParams:x,asDidRenameFilesParams:q,asDidDeleteFilesParams:O,asWillCreateFilesParams:I,asWillRenameFilesParams:N,asWillDeleteFilesParams:$,asTextDocumentPositionParams:K,asCompletionParams:se,asSignatureHelpParams:St,asWorkerPosition:at,asRange:Le,asPosition:vt,asPositions:xn,asLocation:tt,asDiagnosticSeverity:ct,asDiagnosticTag:Xe,asDiagnostic:kn,asDiagnostics:qn,asCompletionItem:Gt,asTextEdit:On,asSymbolKind:jt,asSymbolTag:Lt,asSymbolTags:Qe,asReferenceParams:dr,asCodeAction:_t,asCodeActionContext:$t,asInlineValueContext:Nn,asCommand:Ht,asCodeLens:Xt,asFormattingOptions:R,asDocumentSymbolParams:F,asCodeLensParams:H,asDocumentLink:V,asDocumentLinkParams:he,asCallHierarchyItem:ge,asTypeHierarchyItem:me,asInlayHint:ce,asWorkspaceSymbol:ke}}Io.createConverter=OD});var fp=k(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.createConverter=void 0;var W=require("vscode"),ne=Te(),mn=wn(),Re=qo(),ID=Ea(),ND=ka(),FD=Oa(),LD=Na(),lp=La(),AD=Ma(),MD=$a(),jD=Wa(),$D=Ua(),dp=Te(),No;(function(n){function e(t){let r=t;return r&&mn.string(r.language)&&mn.string(r.value)}n.is=e})(No||(No={}));function HD(n,e,t){let i=n||(u=>W.Uri.parse(u));function o(u){return i(u)}function s(u){let _=[];for(let j of u)if(typeof j=="string")_.push(j);else if(dp.TextDocumentFilter.is(j))_.push({language:j.language,scheme:j.scheme,pattern:j.pattern});else if(dp.NotebookCellTextDocumentFilter.is(j))if(typeof j.notebook=="string")_.push({notebookType:j.notebook,language:j.language});else{let J=j.notebook.notebookType??"*";_.push({notebookType:J,scheme:j.notebook.scheme,pattern:j.notebook.pattern,language:j.language})}return _}async function a(u,_){return Re.map(u,l,_)}function c(u){let _=new Array(u.length);for(let j=0;j<u.length;j++)_[j]=l(u[j]);return _}function l(u){let _=new lp.ProtocolDiagnostic(b(u.range),u.message,q(u.severity),u.data);if(u.code!==void 0){if(typeof u.code=="string"||typeof u.code=="number")ne.CodeDescription.is(u.codeDescription)?_.code={value:u.code,target:o(u.codeDescription.href)}:_.code=u.code;else if(lp.DiagnosticCode.is(u.code)){_.hasDiagnosticCode=!0;let j=u.code;_.code={value:j.value,target:o(j.target)}}}return u.source&&(_.source=u.source),u.relatedInformation&&(_.relatedInformation=g(u.relatedInformation)),Array.isArray(u.tags)&&(_.tags=v(u.tags)),_}function g(u){let _=new Array(u.length);for(let j=0;j<u.length;j++){let J=u[j];_[j]=new W.DiagnosticRelatedInformation(Xe(J.location),J.message)}return _}function v(u){if(!u)return;let _=[];for(let j of u){let J=h(j);J!==void 0&&_.push(J)}return _.length>0?_:void 0}function h(u){switch(u){case ne.DiagnosticTag.Unnecessary:return W.DiagnosticTag.Unnecessary;case ne.DiagnosticTag.Deprecated:return W.DiagnosticTag.Deprecated;default:return}}function C(u){return u?new W.Position(u.line,u.character):void 0}function b(u){return u?new W.Range(u.start.line,u.start.character,u.end.line,u.end.character):void 0}async function x(u,_){return Re.map(u,j=>new W.Range(j.start.line,j.start.character,j.end.line,j.end.character),_)}function q(u){if(u==null)return W.DiagnosticSeverity.Error;switch(u){case ne.DiagnosticSeverity.Error:return W.DiagnosticSeverity.Error;case ne.DiagnosticSeverity.Warning:return W.DiagnosticSeverity.Warning;case ne.DiagnosticSeverity.Information:return W.DiagnosticSeverity.Information;case ne.DiagnosticSeverity.Hint:return W.DiagnosticSeverity.Hint}return W.DiagnosticSeverity.Error}function O(u){if(mn.string(u))return N(u);if(No.is(u))return N().appendCodeblock(u.value,u.language);if(Array.isArray(u)){let _=[];for(let j of u){let J=N();No.is(j)?J.appendCodeblock(j.value,j.language):J.appendMarkdown(j),_.push(J)}return _}else return N(u)}function I(u){if(mn.string(u))return u;switch(u.kind){case ne.MarkupKind.Markdown:return N(u.value);case ne.MarkupKind.PlainText:return u.value;default:return`Unsupported Markup content received. Kind is: ${u.kind}`}}function N(u){let _;if(u===void 0||typeof u=="string")_=new W.MarkdownString(u);else switch(u.kind){case ne.MarkupKind.Markdown:_=new W.MarkdownString(u.value);break;case ne.MarkupKind.PlainText:_=new W.MarkdownString,_.appendText(u.value);break;default:_=new W.MarkdownString,_.appendText(`Unsupported Markup content received. Kind is: ${u.kind}`);break}return _.isTrusted=e,_.supportHtml=t,_}function $(u){if(!!u)return new W.Hover(O(u.contents),b(u.range))}async function K(u,_,j){if(!u)return;if(Array.isArray(u))return Re.map(u,fr=>rt(fr,_),j);let J=u,{range:ut,inserting:it,replacing:Z,commitCharacters:on}=de(J,_),sn=await Re.map(J.items,fr=>{var di,zc;let Lr=rt(fr,on,(di=J.itemDefaults)==null?void 0:di.insertTextMode,(zc=J.itemDefaults)==null?void 0:zc.insertTextFormat);return Lr.range===void 0&&(ut!==void 0?Lr.range=ut:it!==void 0&&Z!==void 0&&(Lr.range={inserting:it,replacing:Z})),Lr},j);return new W.CompletionList(sn,J.isIncomplete)}function de(u,_){var ut,it;let j=(ut=u.itemDefaults)==null?void 0:ut.editRange,J=((it=u.itemDefaults)==null?void 0:it.commitCharacters)??_;return ne.Range.is(j)?{range:b(j),inserting:void 0,replacing:void 0,commitCharacters:J}:j!==void 0?{range:void 0,inserting:b(j.insert),replacing:b(j.replace),commitCharacters:J}:{range:void 0,inserting:void 0,replacing:void 0,commitCharacters:J}}function se(u){return ne.CompletionItemKind.Text<=u&&u<=ne.CompletionItemKind.TypeParameter?[u-1,void 0]:[W.CompletionItemKind.Text,u]}function He(u){switch(u){case ne.CompletionItemTag.Deprecated:return W.CompletionItemTag.Deprecated}}function Ge(u){if(u==null)return[];let _=[];for(let j of u){let J=He(j);J!==void 0&&_.push(J)}return _}function rt(u,_,j,J){let ut=Ge(u.tags),it=Tt(u),Z=new ID.default(it);u.detail&&(Z.detail=u.detail),u.documentation&&(Z.documentation=I(u.documentation),Z.documentationFormat=mn.string(u.documentation)?"$string":u.documentation.kind),u.filterText&&(Z.filterText=u.filterText);let on=gt(u,J);if(on&&(Z.insertText=on.text,Z.range=on.range,Z.fromEdit=on.fromEdit),mn.number(u.kind)){let[Lr,di]=se(u.kind);Z.kind=Lr,di&&(Z.originalItemKind=di)}u.sortText&&(Z.sortText=u.sortText),u.additionalTextEdits&&(Z.additionalTextEdits=vt(u.additionalTextEdits));let sn=u.commitCharacters!==void 0?mn.stringArray(u.commitCharacters)?u.commitCharacters:void 0:_;sn&&(Z.commitCharacters=sn.slice()),u.command&&(Z.command=Qe(u.command)),(u.deprecated===!0||u.deprecated===!1)&&(Z.deprecated=u.deprecated,u.deprecated===!0&&ut.push(W.CompletionItemTag.Deprecated)),(u.preselect===!0||u.preselect===!1)&&(Z.preselect=u.preselect),u.data!==void 0&&(Z.data=u.data),ut.length>0&&(Z.tags=ut);let fr=u.insertTextMode??j;return fr!==void 0&&(Z.insertTextMode=fr,fr===ne.InsertTextMode.asIs&&(Z.keepWhitespace=!0)),Z}function Tt(u){return ne.CompletionItemLabelDetails.is(u.labelDetails)?{label:u.label,detail:u.labelDetails.detail,description:u.labelDetails.description}:u.label}function gt(u,_){let j=u.insertTextFormat??_;return u.textEdit?j===ne.InsertTextFormat.Snippet?{text:new W.SnippetString(u.textEdit.newText),range:mt(u.textEdit),fromEdit:!0}:{text:u.textEdit.newText,range:mt(u.textEdit),fromEdit:!0}:u.insertText?j===ne.InsertTextFormat.Snippet?{text:new W.SnippetString(u.insertText),fromEdit:!1}:{text:u.insertText,fromEdit:!1}:void 0}function mt(u){return ne.InsertReplaceEdit.is(u)?{inserting:b(u.insert),replacing:b(u.replace)}:b(u.range)}function St(u){if(!!u)return new W.TextEdit(b(u.range),u.newText)}async function at(u,_){if(!!u)return Re.map(u,St,_)}function vt(u){if(!u)return;let _=new Array(u.length);for(let j=0;j<u.length;j++)_[j]=St(u[j]);return _}async function xn(u,_){if(!u)return;let j=new W.SignatureHelp;return mn.number(u.activeSignature)?j.activeSignature=u.activeSignature:j.activeSignature=0,mn.number(u.activeParameter)?j.activeParameter=u.activeParameter:j.activeParameter=0,u.signatures&&(j.signatures=await Le(u.signatures,_)),j}async function Le(u,_){return Re.mapAsync(u,tt,_)}async function tt(u,_){let j=new W.SignatureInformation(u.label);return u.documentation!==void 0&&(j.documentation=I(u.documentation)),u.parameters!==void 0&&(j.parameters=await ct(u.parameters,_)),u.activeParameter!==void 0&&(j.activeParameter=u.activeParameter),j}function ct(u,_){return Re.map(u,Ft,_)}function Ft(u){let _=new W.ParameterInformation(u.label);return u.documentation&&(_.documentation=I(u.documentation)),_}function Xe(u){return u?new W.Location(i(u.uri),b(u.range)):void 0}async function ur(u,_){if(!!u)return kn(u,_)}async function Vn(u,_){if(!!u)return kn(u,_)}function Bn(u){if(!u)return;let _={targetUri:i(u.targetUri),targetRange:b(u.targetRange),originSelectionRange:b(u.originSelectionRange),targetSelectionRange:b(u.targetSelectionRange)};if(!_.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return _}async function kn(u,_){if(!!u)if(mn.array(u)){if(u.length===0)return[];if(ne.LocationLink.is(u[0])){let j=u;return Re.map(j,Bn,_)}else{let j=u;return Re.map(j,Xe,_)}}else return ne.LocationLink.is(u)?[Bn(u)]:Xe(u)}async function qn(u,_){if(!!u)return Re.map(u,Xe,_)}async function lr(u,_){if(!!u)return Re.map(u,Gn,_)}function Gn(u){let _=new W.DocumentHighlight(b(u.range));return mn.number(u.kind)&&(_.kind=Xn(u.kind)),_}function Xn(u){switch(u){case ne.DocumentHighlightKind.Text:return W.DocumentHighlightKind.Text;case ne.DocumentHighlightKind.Read:return W.DocumentHighlightKind.Read;case ne.DocumentHighlightKind.Write:return W.DocumentHighlightKind.Write}return W.DocumentHighlightKind.Text}async function yt(u,_){if(!!u)return Re.map(u,On,_)}function Gt(u){return u<=ne.SymbolKind.TypeParameter?u-1:W.SymbolKind.Property}function Qn(u){switch(u){case ne.SymbolTag.Deprecated:return W.SymbolTag.Deprecated;default:return}}function Mt(u){if(u==null)return;let _=[];for(let j of u){let J=Qn(j);J!==void 0&&_.push(J)}return _.length===0?void 0:_}function On(u){let _=u.data,j=u.location,J=j.range===void 0||_!==void 0?new jD.default(u.name,Gt(u.kind),u.containerName??"",j.range===void 0?i(j.uri):new W.Location(i(u.location.uri),b(j.range)),_):new W.SymbolInformation(u.name,Gt(u.kind),u.containerName??"",new W.Location(i(u.location.uri),b(j.range)));return Lt(J,u),J}async function yn(u,_){if(u!=null)return Re.map(u,jt,_)}function jt(u){let _=new W.DocumentSymbol(u.name,u.detail||"",Gt(u.kind),b(u.range),b(u.selectionRange));if(Lt(_,u),u.children!==void 0&&u.children.length>0){let j=[];for(let J of u.children)j.push(jt(J));_.children=j}return _}function Lt(u,_){u.tags=Mt(_.tags),_.deprecated&&(u.tags?u.tags.includes(W.SymbolTag.Deprecated)||(u.tags=u.tags.concat(W.SymbolTag.Deprecated)):u.tags=[W.SymbolTag.Deprecated])}function Qe(u){let _={title:u.title,command:u.command};return u.arguments&&(_.arguments=u.arguments),_}async function dr(u,_){if(!!u)return Re.map(u,Qe,_)}let _t=new Map;_t.set(ne.CodeActionKind.Empty,W.CodeActionKind.Empty),_t.set(ne.CodeActionKind.QuickFix,W.CodeActionKind.QuickFix),_t.set(ne.CodeActionKind.Refactor,W.CodeActionKind.Refactor),_t.set(ne.CodeActionKind.RefactorExtract,W.CodeActionKind.RefactorExtract),_t.set(ne.CodeActionKind.RefactorInline,W.CodeActionKind.RefactorInline),_t.set(ne.CodeActionKind.RefactorRewrite,W.CodeActionKind.RefactorRewrite),_t.set(ne.CodeActionKind.Source,W.CodeActionKind.Source),_t.set(ne.CodeActionKind.SourceOrganizeImports,W.CodeActionKind.SourceOrganizeImports);function $t(u){if(u==null)return;let _=_t.get(u);if(_)return _;let j=u.split(".");_=W.CodeActionKind.Empty;for(let J of j)_=_.append(J);return _}function Cn(u){if(u!=null)return u.map(_=>$t(_))}async function In(u,_){if(u==null)return;let j=new LD.default(u.title,u.data);return u.kind!==void 0&&(j.kind=$t(u.kind)),u.diagnostics!==void 0&&(j.diagnostics=c(u.diagnostics)),u.edit!==void 0&&(j.edit=await R(u.edit,_)),u.command!==void 0&&(j.command=Qe(u.command)),u.isPreferred!==void 0&&(j.isPreferred=u.isPreferred),u.disabled!==void 0&&(j.disabled={reason:u.disabled.reason}),j}function Nn(u,_){return Re.mapAsync(u,async j=>ne.Command.is(j)?Qe(j):In(j,_),_)}function Ht(u){if(!u)return;let _=new ND.default(b(u.range));return u.command&&(_.command=Qe(u.command)),u.data!==void 0&&u.data!==null&&(_.data=u.data),_}async function Xt(u,_){if(!!u)return Re.map(u,Ht,_)}async function R(u,_){if(!u)return;let j=new Map;if(u.changeAnnotations!==void 0){let it=u.changeAnnotations;await Re.forEach(Object.keys(it),Z=>{let on=F(it[Z]);j.set(Z,on)},_)}let J=it=>{if(it!==void 0)return j.get(it)},ut=new W.WorkspaceEdit;if(u.documentChanges){let it=u.documentChanges;await Re.forEach(it,Z=>{if(ne.CreateFile.is(Z))ut.createFile(i(Z.uri),Z.options,J(Z.annotationId));else if(ne.RenameFile.is(Z))ut.renameFile(i(Z.oldUri),i(Z.newUri),Z.options,J(Z.annotationId));else if(ne.DeleteFile.is(Z))ut.deleteFile(i(Z.uri),Z.options,J(Z.annotationId));else if(ne.TextDocumentEdit.is(Z)){let on=i(Z.textDocument.uri);for(let sn of Z.edits)ne.AnnotatedTextEdit.is(sn)?ut.replace(on,b(sn.range),sn.newText,J(sn.annotationId)):ut.replace(on,b(sn.range),sn.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Z,void 0,4)}`)},_)}else if(u.changes){let it=u.changes;await Re.forEach(Object.keys(it),Z=>{ut.set(i(Z),vt(it[Z]))},_)}return ut}function F(u){if(u!==void 0)return{label:u.label,needsConfirmation:!!u.needsConfirmation,description:u.description}}function H(u){let _=b(u.range),j=u.target?o(u.target):void 0,J=new FD.default(_,j);return u.tooltip!==void 0&&(J.tooltip=u.tooltip),u.data!==void 0&&u.data!==null&&(J.data=u.data),J}async function V(u,_){if(!!u)return Re.map(u,H,_)}function he(u){return new W.Color(u.red,u.green,u.blue,u.alpha)}function ge(u){return new W.ColorInformation(b(u.range),he(u.color))}async function me(u,_){if(!!u)return Re.map(u,ge,_)}function ke(u){let _=new W.ColorPresentation(u.label);return _.additionalTextEdits=vt(u.additionalTextEdits),u.textEdit&&(_.textEdit=St(u.textEdit)),_}async function ce(u,_){if(!!u)return Re.map(u,ke,_)}function Ce(u){if(u)switch(u){case ne.FoldingRangeKind.Comment:return W.FoldingRangeKind.Comment;case ne.FoldingRangeKind.Imports:return W.FoldingRangeKind.Imports;case ne.FoldingRangeKind.Region:return W.FoldingRangeKind.Region}}function ue(u){return new W.FoldingRange(u.startLine,u.endLine,Ce(u.kind))}async function p(u,_){if(!!u)return Re.map(u,ue,_)}function E(u){return new W.SelectionRange(b(u.range),u.parent?E(u.parent):void 0)}async function z(u,_){return Array.isArray(u)?Re.map(u,E,_):[]}function S(u){return ne.InlineValueText.is(u)?new W.InlineValueText(b(u.range),u.text):ne.InlineValueVariableLookup.is(u)?new W.InlineValueVariableLookup(b(u.range),u.variableName,u.caseSensitiveLookup):new W.InlineValueEvaluatableExpression(b(u.range),u.expression)}async function f(u,_){return Array.isArray(u)?Re.map(u,S,_):[]}async function D(u,_){let j=typeof u.label=="string"?u.label:await Re.map(u.label,T,_),J=new $D.default(C(u.position),j);return u.kind!==void 0&&(J.kind=u.kind),u.textEdits!==void 0&&(J.textEdits=await at(u.textEdits,_)),u.tooltip!==void 0&&(J.tooltip=m(u.tooltip)),u.paddingLeft!==void 0&&(J.paddingLeft=u.paddingLeft),u.paddingRight!==void 0&&(J.paddingRight=u.paddingRight),u.data!==void 0&&(J.data=u.data),J}function T(u){let _=new W.InlayHintLabelPart(u.value);return u.location!==void 0&&(_.location=Xe(u.location)),u.tooltip!==void 0&&(_.tooltip=m(u.tooltip)),u.command!==void 0&&(_.command=Qe(u.command)),_}function m(u){return typeof u=="string"?u:N(u)}async function d(u,_){if(!!Array.isArray(u))return Re.mapAsync(u,D,_)}function P(u){if(u===null)return;let _=new AD.default(Gt(u.kind),u.name,u.detail||"",o(u.uri),b(u.range),b(u.selectionRange),u.data);return u.tags!==void 0&&(_.tags=Mt(u.tags)),_}async function L(u,_){if(u!==null)return Re.map(u,P,_)}async function te(u,_){return new W.CallHierarchyIncomingCall(P(u.from),await x(u.fromRanges,_))}async function Pe(u,_){if(u!==null)return Re.mapAsync(u,te,_)}async function Ae(u,_){return new W.CallHierarchyOutgoingCall(P(u.to),await x(u.fromRanges,_))}async function Wt(u,_){if(u!==null)return Re.mapAsync(u,Ae,_)}async function zt(u,_){if(u!=null)return new W.SemanticTokens(new Uint32Array(u.data),u.resultId)}function Qt(u){return new W.SemanticTokensEdit(u.start,u.deleteCount,u.data!==void 0?new Uint32Array(u.data):void 0)}async function fe(u,_){if(u!=null)return new W.SemanticTokensEdits(u.edits.map(Qt),u.resultId)}function Jn(u){return u}async function Fr(u,_){if(u!=null)return new W.LinkedEditingRanges(await x(u.ranges,_),io(u.wordPattern))}function io(u){if(u!=null)return new RegExp(u)}function Wc(u){if(u===null)return;let _=new MD.default(Gt(u.kind),u.name,u.detail||"",o(u.uri),b(u.range),b(u.selectionRange),u.data);return u.tags!==void 0&&(_.tags=Mt(u.tags)),_}async function Cv(u,_){if(u!==null)return Re.map(u,Wc,_)}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:b,asRanges:x,asPosition:C,asDiagnosticSeverity:q,asDiagnosticTag:h,asHover:$,asCompletionResult:K,asCompletionItem:rt,asTextEdit:St,asTextEdits:at,asSignatureHelp:xn,asSignatureInformations:Le,asSignatureInformation:tt,asParameterInformations:ct,asParameterInformation:Ft,asDeclarationResult:ur,asDefinitionResult:Vn,asLocation:Xe,asReferences:qn,asDocumentHighlights:lr,asDocumentHighlight:Gn,asDocumentHighlightKind:Xn,asSymbolKind:Gt,asSymbolTag:Qn,asSymbolTags:Mt,asSymbolInformations:yt,asSymbolInformation:On,asDocumentSymbols:yn,asDocumentSymbol:jt,asCommand:Qe,asCommands:dr,asCodeAction:In,asCodeActionKind:$t,asCodeActionKinds:Cn,asCodeActionResult:Nn,asCodeLens:Ht,asCodeLenses:Xt,asWorkspaceEdit:R,asDocumentLink:H,asDocumentLinks:V,asFoldingRangeKind:Ce,asFoldingRange:ue,asFoldingRanges:p,asColor:he,asColorInformation:ge,asColorInformations:me,asColorPresentation:ke,asColorPresentations:ce,asSelectionRange:E,asSelectionRanges:z,asInlineValue:S,asInlineValues:f,asInlayHint:D,asInlayHints:d,asSemanticTokensLegend:Jn,asSemanticTokens:zt,asSemanticTokensEdit:Qt,asSemanticTokensEdits:fe,asCallHierarchyItem:P,asCallHierarchyItems:L,asCallHierarchyIncomingCall:te,asCallHierarchyIncomingCalls:Pe,asCallHierarchyOutgoingCall:Ae,asCallHierarchyOutgoingCalls:Wt,asLinkedEditingRanges:Fr,asTypeHierarchyItem:Wc,asTypeHierarchyItems:Cv}}Fo.createConverter=HD});var Zr=k(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.generateUuid=nn.parse=nn.isUUID=nn.v4=nn.empty=void 0;var Lo=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},le=class extends Lo{constructor(){super([le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),"-",le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),"-","4",le._randomHex(),le._randomHex(),le._randomHex(),"-",le._oneOf(le._timeHighBits),le._randomHex(),le._randomHex(),le._randomHex(),"-",le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return le._oneOf(le._chars)}};le._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];le._timeHighBits=["8","9","a","b"];nn.empty=new Lo("00000000-0000-0000-0000-000000000000");function pp(){return new le}nn.v4=pp;var WD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function hp(n){return WD.test(n)}nn.isUUID=hp;function zD(n){if(!hp(n))throw new Error("invalid uuid");return new Lo(n)}nn.parse=zD;function UD(){return pp().asHex()}nn.generateUuid=UD});var Va=k(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.ProgressPart=void 0;var gp=require("vscode"),mp=Te(),vp=wn(),yp=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(mp.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&gp.window.withProgress({location:gp.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(mp.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&vp.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(vp.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};Ao.ProgressPart=yp});var pt=k(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.BaseLanguageClient=xe.LSPCancellationError=xe.MessageTransports=xe.TextDocumentFeature=xe.State=xe.RevealOutputChannelOn=xe.DiagnosticPullMode=xe.CloseAction=xe.ErrorAction=void 0;var U=require("vscode"),w=Te(),KD=_a(),VD=up(),BD=fp(),Se=wn(),Ba=qo(),_e=Zr(),GD=Va(),Cp=class{error(e){(0,w.RAL)().console.error(e)}warn(e){(0,w.RAL)().console.warn(e)}info(e){(0,w.RAL)().console.info(e)}log(e){(0,w.RAL)().console.log(e)}};function XD(n,e,t,r,i){let o=new Cp,s=(0,w.createProtocolConnection)(n,e,o,i);return s.onError(c=>{t(c[0],c[1],c[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:(c,...l)=>s.sendRequest(c,...l),onRequest:(c,l)=>s.onRequest(c,l),sendNotification:(c,l)=>s.sendNotification(c,l),onNotification:(c,l)=>s.onNotification(c,l),onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(c,l,g)=>{let v={sendNotification:!1,traceFormat:w.TraceFormat.Text};g===void 0?s.trace(c,l,v):(Se.boolean(g),s.trace(c,l,g))},initialize:c=>s.sendRequest(w.InitializeRequest.type,c),shutdown:()=>s.sendRequest(w.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(w.ExitNotification.type),onLogMessage:c=>s.onNotification(w.LogMessageNotification.type,c),onShowMessage:c=>s.onNotification(w.ShowMessageNotification.type,c),onTelemetry:c=>s.onNotification(w.TelemetryEventNotification.type,c),didChangeConfiguration:c=>s.sendNotification(w.DidChangeConfigurationNotification.type,c),didChangeWatchedFiles:c=>s.sendNotification(w.DidChangeWatchedFilesNotification.type,c),didOpenTextDocument:c=>s.sendNotification(w.DidOpenTextDocumentNotification.type,c),didChangeTextDocument:c=>s.sendNotification(w.DidChangeTextDocumentNotification.type,c),didCloseTextDocument:c=>s.sendNotification(w.DidCloseTextDocumentNotification.type,c),didSaveTextDocument:c=>s.sendNotification(w.DidSaveTextDocumentNotification.type,c),onDiagnostics:c=>s.onNotification(w.PublishDiagnosticsNotification.type,c),end:()=>s.end(),dispose:()=>s.dispose()}}var jo;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(jo=xe.ErrorAction||(xe.ErrorAction={}));var _r;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(_r=xe.CloseAction||(xe.CloseAction={}));var wp=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:jo.Continue}:{action:jo.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:_r.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:_r.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:_r.Restart})}},QD;(function(n){n.onType="onType",n.onSave="onSave"})(QD=xe.DiagnosticPullMode||(xe.DiagnosticPullMode={}));var Ui;(function(n){n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Ui=xe.RevealOutputChannelOn||(xe.RevealOutputChannelOn={}));var Mo;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Mo=xe.State||(xe.State={}));var Ne;(function(n){n[n.Initial=0]="Initial",n[n.Starting=1]="Starting",n[n.StartFailed=2]="StartFailed",n[n.Running=3]="Running",n[n.Stopping=4]="Stopping",n[n.Stopped=5]="Stopped"})(Ne||(Ne={}));var Rp=[w.SymbolKind.File,w.SymbolKind.Module,w.SymbolKind.Namespace,w.SymbolKind.Package,w.SymbolKind.Class,w.SymbolKind.Method,w.SymbolKind.Property,w.SymbolKind.Field,w.SymbolKind.Constructor,w.SymbolKind.Enum,w.SymbolKind.Interface,w.SymbolKind.Function,w.SymbolKind.Variable,w.SymbolKind.Constant,w.SymbolKind.String,w.SymbolKind.Number,w.SymbolKind.Boolean,w.SymbolKind.Array,w.SymbolKind.Object,w.SymbolKind.Key,w.SymbolKind.Null,w.SymbolKind.EnumMember,w.SymbolKind.Struct,w.SymbolKind.Event,w.SymbolKind.Operator,w.SymbolKind.TypeParameter],JD=[w.CompletionItemKind.Text,w.CompletionItemKind.Method,w.CompletionItemKind.Function,w.CompletionItemKind.Constructor,w.CompletionItemKind.Field,w.CompletionItemKind.Variable,w.CompletionItemKind.Class,w.CompletionItemKind.Interface,w.CompletionItemKind.Module,w.CompletionItemKind.Property,w.CompletionItemKind.Unit,w.CompletionItemKind.Value,w.CompletionItemKind.Enum,w.CompletionItemKind.Keyword,w.CompletionItemKind.Snippet,w.CompletionItemKind.Color,w.CompletionItemKind.File,w.CompletionItemKind.Reference,w.CompletionItemKind.Folder,w.CompletionItemKind.EnumMember,w.CompletionItemKind.Constant,w.CompletionItemKind.Struct,w.CompletionItemKind.Event,w.CompletionItemKind.Operator,w.CompletionItemKind.TypeParameter],bp=[w.SymbolTag.Deprecated];function X(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Ki;(function(n){function e(t){let r=U.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(Ki||(Ki={}));var Ga;(function(n){function e(t){let r=t;return r&&Se.func(r.register)&&Se.func(r.unregister)&&Se.func(r.dispose)&&r.registrationType!==void 0}n.is=e})(Ga||(Ga={}));var Dn=class{constructor(e,t,r,i,o,s){this._client=e,this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._selectorFilter=s,this._selectors=new Map,this._onNotificationSent=new U.EventEmitter}static textDocumentFilter(e,t){for(let r of e)if(U.languages.match(r,t))return!0;return!1}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i).catch(),this.notificationSent(r,this._type,i)};if(!this._selectorFilter||this._selectorFilter(this._selectors.values(),e))return this._middleware?this._middleware(e,r=>t(r)):t(e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(U.languages.match(t,e))return{send:r=>this.callback(r)}}},Dp=class extends Dn{constructor(e,t){super(e,U.workspace.onDidOpenTextDocument,w.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),Dn.textDocumentFilter);this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return w.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);U.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&U.languages.match(t,r)){let o=this._client.clientOptions.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.set(e.uri.toString(),e)}},Tp=class extends Dn{constructor(e,t){super(e,U.workspace.onDidCloseTextDocument,w.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,r=>e.code2ProtocolConverter.asCloseTextDocumentParams(r),Dn.textDocumentFilter);this._syncedDocuments=t}get registrationType(){return w.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(U.languages.match(t,i)&&!this._selectorFilter(r,i)){let o=this._client.clientOptions.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}},Sp=class{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1,this._onNotificationSent=new U.EventEmitter}get registrationType(){return w.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==w.TextDocumentSyncKind.None&&this.register({id:_e.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=U.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}))}async callback(e){if(e.contentChanges.length===0)return;let t=[];for(let r of this._changeData.values())if(U.languages.match(r.documentSelector,e.document)){let i=this._client.clientOptions.middleware;if(r.syncKind===w.TextDocumentSyncKind.Incremental){let o=async s=>{let a=this._client.code2ProtocolConverter.asChangeTextDocumentParams(s);await this._client.sendNotification(w.DidChangeTextDocumentNotification.type,a),this.notificationSent(s,w.DidChangeTextDocumentNotification.type,a)};t.push(i.didChange?i.didChange(e,s=>o(s)):o(e))}else if(r.syncKind===w.TextDocumentSyncKind.Full){let o=async s=>{let a=async c=>{let l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c.document);await this._client.sendNotification(w.DidChangeTextDocumentNotification.type,l),this.notificationSent(c,w.DidChangeTextDocumentNotification.type,l)};return this._changeDelayer?(this._changeDelayer.uri!==s.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=s.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>a(s))):(this._changeDelayer={uri:s.document.uri.toString(),delayer:new Ba.Delayer(200)},this._changeDelayer.delayer.trigger(()=>a(s),-1))};t.push(i.didChange?i.didChange(e,s=>o(s)):o(e))}}return Promise.all(t).then(void 0,r=>{throw this._client.error(`Sending document notification ${w.DidChangeTextDocumentNotification.type.method} failed`,r),r})}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._changeData.delete(e),this._changeData.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer!==void 0&&this._changeDelayer.delayer.cancel(),this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!(this._forcingDelivery||!this._changeDelayer))try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(let t of this._changeData.values())if(U.languages.match(t.documentSelector,e))return{send:r=>this.callback(r)}}},_p=class extends Dn{constructor(e){super(e,U.workspace.onWillSaveTextDocument,w.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(t,r)=>Dn.textDocumentFilter(t,r.document))}get registrationType(){return w.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}},Pp=class{constructor(e){this._client=e,this._selectors=new Map}get registrationType(){return w.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=U.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Dn.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,r=i=>this._client.sendRequest(w.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}},Ep=class extends Dn{constructor(e){super(e,U.workspace.onDidSaveTextDocument,w.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),Dn.textDocumentFilter);this._includeText=!1}get registrationType(){return w.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:_e.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}},xp=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get registrationType(){return w.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){X(X(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){if(!Se.string(r.globPattern))continue;let i=!0,o=!0,s=!0;r.kind!==void 0&&r.kind!==null&&(i=(r.kind&w.WatchKind.Create)!==0,o=(r.kind&w.WatchKind.Change)!==0,s=(r.kind&w.WatchKind.Delete)!==0);let a=U.workspace.createFileSystemWatcher(r.globPattern,!i,!o,!s);this.hookListeners(a,i,o,s),t.push(a)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}},bt=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(w.TextDocumentRegistrationOptions.is(t)){let r=w.StaticRegistrationOptions.hasId(t)?t.id:_e.generateUuid(),i=t.documentSelector||e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(Se.boolean(t)&&t===!0||w.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=Se.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[_e.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Se.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&U.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e))return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};xe.TextDocumentFeature=bt;var kp=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}},qp=class extends bt{constructor(e){super(e,w.CompletionRequest.type);this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[w.MarkupKind.Markdown,w.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[w.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[w.InsertTextMode.asIs,w.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=w.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:JD},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)!=null&&a.labelDetailsSupport));let r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(c,l,g,v)=>{let h=this._client,C=this._client.clientOptions.middleware,b=(x,q,O,I)=>h.sendRequest(w.CompletionRequest.type,h.code2ProtocolConverter.asCompletionParams(x,q,O),I).then(N=>I.isCancellationRequested?null:h.protocol2CodeConverter.asCompletionResult(N,i,I),N=>h.handleFailedRequest(w.CompletionRequest.type,I,N,null));return C.provideCompletionItem?C.provideCompletionItem(c,l,v,g,b):b(c,l,v,g)},resolveCompletionItem:e.resolveProvider?(c,l)=>{let g=this._client,v=this._client.clientOptions.middleware,h=(C,b)=>g.sendRequest(w.CompletionResolveRequest.type,g.code2ProtocolConverter.asCompletionItem(C,!!this.labelDetailsSupport.get(t)),b).then(x=>b.isCancellationRequested?null:g.protocol2CodeConverter.asCompletionItem(x),x=>g.handleFailedRequest(w.CompletionResolveRequest.type,b,x,C));return v.resolveCompletionItem?v.resolveCompletionItem(c,l,h):h(c,l)}:void 0};return[U.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}},Op=class extends bt{constructor(e){super(e,w.HoverRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[w.MarkupKind.Markdown,w.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(w.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(w.HoverRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideHover?l.provideHover(i,o,s,c):c(i,o,s)}};return[U.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Ip=class extends bt{constructor(e){super(e,w.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[w.MarkupKind.Markdown,w.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSignatureHelp:(s,a,c,l)=>{let g=this._client,v=(C,b,x,q)=>g.sendRequest(w.SignatureHelpRequest.type,g.code2ProtocolConverter.asSignatureHelpParams(C,b,x),q).then(O=>q.isCancellationRequested?null:g.protocol2CodeConverter.asSignatureHelp(O,q),O=>g.handleFailedRequest(w.SignatureHelpRequest.type,q,O,null)),h=g.clientOptions.middleware;return h.provideSignatureHelp?h.provideSignatureHelp(s,a,l,c,v):v(s,a,l,c)}},i,o=this._client.protocol2CodeConverter.asDocumentSelector(t);if(e.retriggerCharacters===void 0){let s=e.triggerCharacters||[];i=U.languages.registerSignatureHelpProvider(o,r,...s)}else{let s={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};i=U.languages.registerSignatureHelpProvider(o,r,s)}return[i,r]}},Np=class extends bt{constructor(e){super(e,w.DefinitionRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(w.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(w.DefinitionRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDefinition?l.provideDefinition(i,o,s,c):c(i,o,s)}};return[U.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Fp=class extends bt{constructor(e){super(e,w.ReferencesRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,o,s,a)=>{let c=this._client,l=(v,h,C,b)=>c.sendRequest(w.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(v,h,C),b).then(x=>b.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(x,b),x=>c.handleFailedRequest(w.ReferencesRequest.type,b,x,null)),g=c.clientOptions.middleware;return g.provideReferences?g.provideReferences(i,o,s,a,l):l(i,o,s,a)}};return[U.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Lp=class extends bt{constructor(e){super(e,w.DocumentHighlightRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(w.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,h),C=>a.handleFailedRequest(w.DocumentHighlightRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,o,s,c):c(i,o,s)}};return[U.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Ap=class extends bt{constructor(e){super(e,w.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Rp},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:bp},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(o,s)=>{let a=this._client,c=(g,v)=>a.sendRequest(w.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(g),v).then(async h=>{if(v.isCancellationRequested||h===void 0||h===null)return null;if(h.length===0)return[];{let C=h[0];return w.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(h,v):await a.protocol2CodeConverter.asSymbolInformations(h,v)}},h=>a.handleFailedRequest(w.DocumentSymbolRequest.type,v,h,null)),l=a.clientOptions.middleware;return l.provideDocumentSymbols?l.provideDocumentSymbols(o,s,c):c(o,s)}},i=e.label!==void 0?{label:e.label}:void 0;return[U.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}},Mp=class extends kp{constructor(e){super(e,w.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=X(X(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Rp},t.tagSupport={valueSet:bp},t.resolveSupport={properties:["location.range"]}}initialize(e){!e.workspaceSymbolProvider||this.register({id:_e.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let o=this._client,s=(c,l)=>o.sendRequest(w.WorkspaceSymbolRequest.type,{query:c},l).then(g=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(g,l),g=>o.handleFailedRequest(w.WorkspaceSymbolRequest.type,l,g,null)),a=o.clientOptions.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let o=this._client,s=(c,l)=>o.sendRequest(w.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(c),l).then(g=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(g),g=>o.handleFailedRequest(w.WorkspaceSymbolResolveRequest.type,l,g,null)),a=o.clientOptions.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[U.languages.registerWorkspaceSymbolProvider(t),t]}},jp=class extends bt{constructor(e){super(e,w.CodeActionRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[w.CodeActionKind.Empty,w.CodeActionKind.QuickFix,w.CodeActionKind.Refactor,w.CodeActionKind.RefactorExtract,w.CodeActionKind.RefactorInline,w.CodeActionKind.RefactorRewrite,w.CodeActionKind.Source,w.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,o,s,a)=>{let c=this._client,l=async(v,h,C,b)=>{let x={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(h),context:await c.code2ProtocolConverter.asCodeActionContext(C,b)};return c.sendRequest(w.CodeActionRequest.type,x,b).then(q=>b.isCancellationRequested||q===null||q===void 0?null:c.protocol2CodeConverter.asCodeActionResult(q,b),q=>c.handleFailedRequest(w.CodeActionRequest.type,b,q,null))},g=c.clientOptions.middleware;return g.provideCodeActions?g.provideCodeActions(i,o,s,a,l):l(i,o,s,a)},resolveCodeAction:e.resolveProvider?(i,o)=>{let s=this._client,a=this._client.clientOptions.middleware,c=async(l,g)=>s.sendRequest(w.CodeActionResolveRequest.type,await s.code2ProtocolConverter.asCodeAction(l,g),g).then(v=>g.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(v,g),v=>s.handleFailedRequest(w.CodeActionResolveRequest.type,g,v,l));return a.resolveCodeAction?a.resolveCodeAction(i,o,c):c(i,o)}:void 0};return[U.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}},$p=class extends bt{constructor(e){super(e,w.CodeLensRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"codeLens").dynamicRegistration=!0,X(X(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(w.CodeLensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);!i||this.register({id:_e.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new U.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{let a=this._client,c=(g,v)=>a.sendRequest(w.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(g),v).then(h=>v.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(h,v),h=>a.handleFailedRequest(w.CodeLensRequest.type,v,h,null)),l=a.clientOptions.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,c):c(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{let a=this._client,c=(g,v)=>a.sendRequest(w.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(g),v).then(h=>v.isCancellationRequested?g:a.protocol2CodeConverter.asCodeLens(h),h=>a.handleFailedRequest(w.CodeLensResolveRequest.type,v,h,g)),l=a.clientOptions.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,c):c(o,s)}:void 0};return[U.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}},Hp=class extends bt{constructor(e){super(e,w.DocumentFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),options:a.code2ProtocolConverter.asFormattingOptions(v,Ki.fromConfiguration(g))};return a.sendRequest(w.DocumentFormattingRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(b,h),b=>a.handleFailedRequest(w.DocumentFormattingRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,o,s,c):c(i,o,s)}};return[U.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Wp=class extends bt{constructor(e){super(e,w.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,a)=>{let c=this._client,l=(v,h,C,b)=>{let x={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(h),options:c.code2ProtocolConverter.asFormattingOptions(C,Ki.fromConfiguration(v))};return c.sendRequest(w.DocumentRangeFormattingRequest.type,x,b).then(q=>b.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(q,b),q=>c.handleFailedRequest(w.DocumentRangeFormattingRequest.type,b,q,null))},g=c.clientOptions.middleware;return g.provideDocumentRangeFormattingEdits?g.provideDocumentRangeFormattingEdits(i,o,s,a,l):l(i,o,s,a)}};return[U.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},zp=class extends bt{constructor(e){super(e,w.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,a,c,l)=>{let g=this._client,v=(C,b,x,q,O)=>{let I={textDocument:g.code2ProtocolConverter.asTextDocumentIdentifier(C),position:g.code2ProtocolConverter.asPosition(b),ch:x,options:g.code2ProtocolConverter.asFormattingOptions(q,Ki.fromConfiguration(C))};return g.sendRequest(w.DocumentOnTypeFormattingRequest.type,I,O).then(N=>O.isCancellationRequested?null:g.protocol2CodeConverter.asTextEdits(N,O),N=>g.handleFailedRequest(w.DocumentOnTypeFormattingRequest.type,O,N,null))},h=g.clientOptions.middleware;return h.provideOnTypeFormattingEdits?h.provideOnTypeFormattingEdits(o,s,a,c,l,v):v(o,s,a,c,l)}},i=e.moreTriggerCharacter||[];return[U.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}},Up=class extends bt{constructor(e){super(e,w.RenameRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=w.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);!r||(Se.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:_e.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,o,s,a)=>{let c=this._client,l=(v,h,C,b)=>{let x={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),position:c.code2ProtocolConverter.asPosition(h),newName:C};return c.sendRequest(w.RenameRequest.type,x,b).then(q=>b.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(q,b),q=>c.handleFailedRequest(w.RenameRequest.type,b,q,null,!1))},g=c.clientOptions.middleware;return g.provideRenameEdits?g.provideRenameEdits(i,o,s,a,l):l(i,o,s,a)},prepareRename:e.prepareProvider?(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),position:a.code2ProtocolConverter.asPosition(v)};return a.sendRequest(w.PrepareRenameRequest.type,C,h).then(b=>h.isCancellationRequested?null:w.Range.is(b)?a.protocol2CodeConverter.asRange(b):this.isDefaultBehavior(b)?b.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):b&&w.Range.is(b.range)?{range:a.protocol2CodeConverter.asRange(b.range),placeholder:b.placeholder}:Promise.reject(new Error("The element can't be renamed.")),b=>{throw typeof b.message=="string"?new Error(b.message):new Error("The element can't be renamed.")})},l=a.clientOptions.middleware;return l.prepareRename?l.prepareRename(i,o,s,c):c(i,o,s)}:void 0};return[U.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}isDefaultBehavior(e){let t=e;return t&&Se.boolean(t.defaultBehavior)}},Kp=class extends bt{constructor(e){super(e,w.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{let s=this._client,a=(l,g)=>s.sendRequest(w.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),g).then(v=>g.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(v,g),v=>s.handleFailedRequest(w.DocumentLinkRequest.type,g,v,null)),c=s.clientOptions.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,o,a):a(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{let s=this._client,a=(l,g)=>s.sendRequest(w.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),g).then(v=>g.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(v),v=>s.handleFailedRequest(w.DocumentLinkResolveRequest.type,g,v,l)),c=s.clientOptions.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,o,a):a(i,o)}:void 0};return[U.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Vp=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return w.DidChangeConfigurationNotification.type}fillClientCapabilities(e){X(X(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;e!==void 0&&this.register({id:_e.generateUuid(),registerOptions:{section:e}})}register(e){let t=U.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let r;if(Se.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async s=>s===void 0?this._client.sendNotification(w.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(w.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)}),o=this.getMiddleware();(o?o(r,i):i(r)).catch(s=>{this._client.error(`Sending notification ${w.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function t(o,s){let a=o;for(let c=0;c<s.length-1;c++){let l=a[s[c]];l||(l=Object.create(null),a[s[c]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),c=null;if(a>=0?c=U.workspace.getConfiguration(s.substr(0,a),r).get(s.substr(a+1)):c=U.workspace.getConfiguration(void 0,r).get(s),c){let l=e[o].split(".");t(i,l)[l[l.length-1]]=(0,KD.toJSONObject)(c)}}return i}getMiddleware(){let e=this._client.clientOptions.middleware;if(e.workspace&&e.workspace.didChangeConfiguration)return e.workspace.didChangeConfiguration}},Bp=class{constructor(e){this._client=e,this._commands=new Map}get registrationType(){return w.ExecuteCommandRequest.type}fillClientCapabilities(e){X(X(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){!e.executeCommandProvider||this.register({id:_e.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.clientOptions.middleware,i=(o,s)=>{let a={command:o,arguments:s};return t.sendRequest(w.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(w.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let o=[];for(let s of e.registerOptions.commands)o.push(U.commands.registerCommand(s,(...a)=>r.executeCommand?r.executeCommand(s,a,i):i(s,a)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}},YD;(function(n){function e(t){return t&&w.MessageReader.is(t.reader)&&w.MessageWriter.is(t.writer)}n.is=e})(YD=xe.MessageTransports||(xe.MessageTransports={}));var Xa=class{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}},Qa=class extends U.CancellationError{constructor(e){super();this.data=e}};xe.LSPCancellationError=Qa;var ei=class{constructor(e,t,r){var o;this._traceFormat=w.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Ba.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=r.markdown.isTrusted===!0,i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Ui.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((o=r.connectionOptions)==null?void 0:o.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Ne.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new Ba.Delayer(250),this._onReady=new Promise((s,a)=>{this._onReadyCallbacks=new Xa(s,a)}),this._onStop=void 0,this._telemetryEmitter=new w.Emitter,this._stateChangeEmitter=new w.Emitter,this._trace=w.Trace.Off,this._tracer={log:(s,a)=>{Se.string(s)?this.logTrace(s,a):this.logObjectTrace(s)}},this._c2p=VD.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=BD.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){return this.state===Ne.Running?Mo.Running:this.state===Ne.Starting?Mo.Starting:Mo.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(r){throw this.error(`Sending request ${Se.string(e)?e:e.method} failed.`,r),r}}onRequest(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);try{return this._resolvedConnection.onRequest(e,t)}catch(r){throw this.error(`Registering request handler ${Se.string(e)?e:e.method} failed.`,r),r}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);this.forceDocumentSync();try{return this._resolvedConnection.sendNotification(e,t)}catch(r){throw this.error(`Sending notification ${Se.string(e)?e:e.method} failed.`,r),r}}onNotification(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);try{return this._resolvedConnection.onNotification(e,t)}catch(r){throw this.error(`Registering notification handler ${Se.string(e)?e:e.method} failed.`,r),r}}onProgress(e,t,r){if(!this.isConnectionActive())throw new Error("Language client is not ready yet when trying to send progress");try{if(w.WorkDoneProgress.is(e)){let i=this._clientOptions.middleware.handleWorkDoneProgress;if(i!==void 0)return this._resolvedConnection.onProgress(e,t,o=>{i(t,o,()=>r(o))})}return this._resolvedConnection.onProgress(e,t,r)}catch(i){throw this.error(`Registering progress handler for token ${t} failed.`,i),i}}sendProgress(e,t,r){if(!this.isConnectionActive())throw new Error("Language client is not ready yet when trying to send progress");return this.forceDocumentSync(),this._resolvedConnection.sendProgress(e,t,r).then(void 0,i=>{throw this.error(`Sending progress for token ${t} failed.`,i),i})}get name(){return this._name}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=U.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new wp(this,e??4)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(t=>{t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})},()=>this.info("Setting trace value failed",void 0,!1))},()=>{})}data2String(e){if(e instanceof w.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Se.string(e.stack)?e.stack:e.message:Se.string(e)?e:e.toString()}info(e,t,r=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Ui.Info&&this.showNotificationMessage(w.MessageType.Info,e)}warn(e,t,r=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Ui.Warn&&this.showNotificationMessage(w.MessageType.Warning,e)}error(e,t,r=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),(r==="force"||r&&this._clientOptions.revealOutputChannelOn<=Ui.Error)&&this.showNotificationMessage(w.MessageType.Error,e)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===w.MessageType.Error?U.window.showErrorMessage:e===w.MessageType.Warning?U.window.showWarningMessage:U.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.state===Ne.Initial||this.state===Ne.Stopping||this.state===Ne.Stopped}needsStop(){return this.state===Ne.Starting||this.state===Ne.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===Ne.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new Xa(e,t)})),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?U.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):U.languages.createDiagnosticCollection()),this.state=Ne.Starting,this.resolveConnection().then(e=>(e.onLogMessage(t=>{switch(t.type){case w.MessageType.Error:this.error(t.message,void 0,!1);break;case w.MessageType.Warning:this.warn(t.message,void 0,!1);break;case w.MessageType.Info:this.info(t.message,void 0,!1);break;default:this.outputChannel.appendLine(t.message)}}),e.onShowMessage(t=>{switch(t.type){case w.MessageType.Error:U.window.showErrorMessage(t.message);break;case w.MessageType.Warning:U.window.showWarningMessage(t.message);break;case w.MessageType.Info:U.window.showInformationMessage(t.message);break;default:U.window.showInformationMessage(t.message)}}),e.onRequest(w.ShowMessageRequest.type,t=>{let r;switch(t.type){case w.MessageType.Error:r=U.window.showErrorMessage;break;case w.MessageType.Warning:r=U.window.showWarningMessage;break;case w.MessageType.Info:r=U.window.showInformationMessage;break;default:r=U.window.showInformationMessage}let i=t.actions||[];return r(t.message,...i)}),e.onTelemetry(t=>{this._telemetryEmitter.fire(t)}),e.onRequest(w.ShowDocumentRequest.type,async t=>{var o;let r=async s=>{let a=this.protocol2CodeConverter.asUri(s.uri);try{if(s.external===!0)return{success:await U.env.openExternal(a)};{let c={};return s.selection!==void 0&&(c.selection=this.protocol2CodeConverter.asRange(s.selection)),s.takeFocus===void 0||s.takeFocus===!1?c.preserveFocus=!0:s.takeFocus===!0&&(c.preserveFocus=!1),await U.window.showTextDocument(a,c),{success:!0}}}catch{return{success:!0}}},i=(o=this._clientOptions.middleware.window)==null?void 0:o.showDocument;return i!==void 0?i(t,r):r(t)}),e.listen(),this.initialize(e))).catch(e=>{this.state=Ne.StartFailed,this._onReadyCallbacks.reject(e),this.error(`${this._name} client: couldn't create connection to server`,e,"force")}),new U.Disposable(()=>{this.needsStop()&&this.stop().catch(e=>{this.error("Stopping server failed.",e,!1)})})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:U.env.appName,version:U.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(U.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Se.func(t)?t():t,trace:w.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){let s=_e.generateUuid(),a=new GD.ProgressPart(e,s);return o.workDoneToken=s,this.doInitialize(e,o).then(c=>(a.done(),c),c=>{throw a.cancel(),c})}else return this.doInitialize(e,o)}doInitialize(e,t){return e.initialize(t).then(r=>{this._resolvedConnection=e,this._initializeResult=r,this.state=Ne.Running;let i;return Se.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===w.TextDocumentSyncKind.None?i={openClose:!1,change:w.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onDiagnostics(o=>this.handleDiagnostics(o)),e.onRequest(w.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(w.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(w.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o)),e.sendNotification(w.InitializedNotification.type,{}).then(()=>(this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),r))}).then(void 0,r=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(r)):r instanceof w.ResponseError&&r.data&&r.data.retry?U.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(r))}):(r&&r.message&&U.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop(),this._onReadyCallbacks.reject(r)),r})}_clientGetRootPath(){let e=U.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}async stop(e=2e3){if(await this.onReady(),this._initializeResult=void 0,!this._connectionPromise)return this.state=Ne.Stopped,Promise.resolve();if(this.state===Ne.Stopping&&this._onStop)return this._onStop;this.state=Ne.Stopping,this.cleanUp(!1);let t=new Promise(i=>{(0,w.RAL)().timer.setTimeout(i,e)}),r=this.resolveConnection().then(i=>i.shutdown().then(()=>i.exit().then(()=>i)));return this._onStop=Promise.race([t,r]).then(i=>{if(i!==void 0)i.end(),i.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},i=>{throw this.error("Stopping server failed",i,!1),i}).finally(()=>{this.state=Ne.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0})}cleanUp(e=!0,t=!0){this._fileEvents=[],this._fileEventDelayer.cancel(),this._listeners&&(this._listeners.forEach(r=>r.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(r=>r.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var o;let t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.onReady();let a=await t.resolveConnection(),c=Promise.resolve();return t.isConnectionActive()&&(t.forceDocumentSync(),c=a.didChangeWatchedFiles({changes:t._fileEvents})),t._fileEvents=[],c})}let i=(o=this.clientOptions.middleware)==null?void 0:o.workspace;(i!=null&&i.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}forceDocumentSync(){this._didChangeTextDocumentFeature===void 0&&(this._didChangeTextDocumentFeature=this._dynamicFeatures.get(w.DidChangeTextDocumentNotification.type.method)),this._didChangeTextDocumentFeature.forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,w.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new U.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){let s=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(c,l)=>this.setDiagnostics(c,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){!this._diagnostics||this._diagnostics.set(e,t)}createConnection(){let e=(r,i,o)=>{this.handleConnectionError(r,i,o)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(r=>XD(r.reader,r.writer,e,t,this._clientOptions.connectionOptions))}handleConnectionClosed(){if(this.state===Ne.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch{}let e={action:_r.DoNotRestart};if(this.state!==Ne.Stopping)try{e=this._clientOptions.errorHandler.closed()}catch{}this._connectionPromise=void 0,this._resolvedConnection=void 0,e.action===_r.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,"force"),this.state===Ne.Starting?(this._onReadyCallbacks.reject(new Error("Connection to server got closed. Server will not be restarted.")),this.state=Ne.StartFailed):this.state=Ne.Stopped,this.cleanUp(!1,!0)):e.action===_r.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=Ne.Initial,this.start())}handleConnectionError(e,t,r){let i=this._clientOptions.errorHandler.error(e,t,r);i.action===jo.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)}))}hookConfigurationChanged(e){U.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let r=U.workspace.getConfiguration(this._id),i=w.Trace.Off,o=w.TraceFormat.Text;if(r){let s=r.get("trace.server","off");typeof s=="string"?i=w.Trace.fromString(s):(i=w.Trace.fromString(r.get("trace.server.verbosity","off")),o=w.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Se.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(w.DidChangeWatchedFilesNotification.type.method).registerRaw(_e.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Ga.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new Vp(this)),this.registerFeature(new Dp(this,this._syncedDocuments)),this.registerFeature(new Sp(this)),this.registerFeature(new _p(this)),this.registerFeature(new Pp(this)),this.registerFeature(new Ep(this)),this.registerFeature(new Tp(this,this._syncedDocuments)),this.registerFeature(new xp(this,e=>this.notifyFileEvent(e))),this.registerFeature(new qp(this)),this.registerFeature(new Op(this)),this.registerFeature(new Ip(this)),this.registerFeature(new Np(this)),this.registerFeature(new Fp(this)),this.registerFeature(new Lp(this)),this.registerFeature(new Ap(this)),this.registerFeature(new Mp(this)),this.registerFeature(new jp(this)),this.registerFeature(new $p(this)),this.registerFeature(new Hp(this)),this.registerFeature(new Wp(this)),this.registerFeature(new zp(this)),this.registerFeature(new Up(this)),this.registerFeature(new Kp(this)),this.registerFeature(new Bp(this))}fillInitializeParams(e){for(let t of this._features)Se.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};X(e,"workspace").applyEdit=!0;let t=X(X(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[w.ResourceOperationKind.Create,w.ResourceOperationKind.Rename,w.ResourceOperationKind.Delete],t.failureHandling=w.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=X(X(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[w.DiagnosticTag.Unnecessary,w.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=X(e,"window"),o=X(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};let s=X(i,"showDocument");s.support=!0;let a=X(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(ei.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)r.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,r)=>{for(let i of e.registrations){let o=this._dynamicFeatures.get(i.method);if(o===void 0){r(new Error(`No feature implementation for ${i.method} found. Registration failed.`));return}let s=i.registerOptions??{};s.documentSelector=s.documentSelector??this._clientOptions.documentSelector;let a={id:i.id,registerOptions:s};try{o.register(a)}catch(c){r(c);return}}t()})}handleUnregistrationRequest(e){return new Promise((t,r)=>{for(let i of e.unregisterations){let o=this._dynamicFeatures.get(i.method);if(!o){r(new Error(`No feature implementation for ${i.method} found. Unregistration failed.`));return}o.unregister(i.id)}t()})}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;U.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(let s of t.documentChanges)if(w.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){let a=i.get(s.textDocument.uri);if(a&&a.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):Se.asPromise(U.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof w.ResponseError){if(r.code===w.LSPErrorCodes.RequestCancelled||r.code===w.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Qa(r.data):new U.CancellationError}else if(r.code===w.LSPErrorCodes.ContentModified){if(ei.RequestsToCancelOnContentModified.has(e.method))throw new U.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}};xe.BaseLanguageClient=ei;ei.RequestsToCancelOnContentModified=new Set([w.SemanticTokensRequest.method,w.SemanticTokensRangeRequest.method,w.SemanticTokensDeltaRequest.method])});var Qp=k($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.ColorProviderFeature=void 0;var ZD=require("vscode"),Vi=Te(),eT=pt();function Gp(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Xp=class extends eT.TextDocumentFeature{constructor(e){super(e,Vi.DocumentColorRequest.type)}fillClientCapabilities(e){Gp(Gp(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={color:g,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(v.document),range:a.code2ProtocolConverter.asRange(v.range)};return a.sendRequest(Vi.ColorPresentationRequest.type,C,h).then(b=>h.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(b,h),b=>a.handleFailedRequest(Vi.ColorPresentationRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,o,s,c):c(i,o,s)},provideDocumentColors:(i,o)=>{let s=this._client,a=(l,g)=>{let v={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(Vi.DocumentColorRequest.type,v,g).then(h=>g.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(h,g),h=>s.handleFailedRequest(Vi.ColorPresentationRequest.type,g,h,null))},c=s.clientOptions.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,o,a):a(i,o)}};return[ZD.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};$o.ColorProviderFeature=Xp});var Zp=k(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.ImplementationFeature=void 0;var tT=require("vscode"),Ja=Te(),nT=pt();function Jp(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Yp=class extends nT.TextDocumentFeature{constructor(e){super(e,Ja.ImplementationRequest.type)}fillClientCapabilities(e){let t=Jp(Jp(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(Ja.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(Ja.ImplementationRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideImplementation?l.provideImplementation(i,o,s,c):c(i,o,s)}};return[tT.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ho.ImplementationFeature=Yp});var th=k(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.TypeDefinitionFeature=void 0;var rT=require("vscode"),Ya=Te(),iT=pt();function Wo(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var eh=class extends iT.TextDocumentFeature{constructor(e){super(e,Ya.TypeDefinitionRequest.type)}fillClientCapabilities(e){Wo(Wo(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=Wo(Wo(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(Ya.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(Ya.TypeDefinitionRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,o,s,c):c(i,o,s)}};return[rT.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};zo.TypeDefinitionFeature=eh});var rh=k(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.WorkspaceFoldersFeature=ti.arrayDiff=void 0;var oT=Zr(),Uo=require("vscode"),Bi=Te();function Za(n,e){if(n!==void 0)return n[e]}function ec(n,e){return n.filter(t=>e.indexOf(t)<0)}ti.arrayDiff=ec;var nh=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return Bi.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Uo.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Bi.WorkspaceFoldersRequest.type,o=>{let s=()=>{let c=Uo.workspace.workspaceFolders;return c===void 0?null:c.map(g=>this.asProtocol(g))},a=t.clientOptions.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s(o)});let r=Za(Za(Za(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=oT.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=ec(this._initialFolders,e),i=ec(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Bi.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Bi.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Uo.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=r.clientOptions.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${Bi.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(Uo.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};ti.WorkspaceFoldersFeature=nh});var sh=k(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.FoldingRangeFeature=void 0;var sT=require("vscode"),tc=Te(),aT=pt();function ih(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var oh=class extends aT.TextDocumentFeature{constructor(e){super(e,tc.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=ih(ih(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideFoldingRanges:(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g)};return a.sendRequest(tc.FoldingRangeRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(b,h),b=>a.handleFailedRequest(tc.FoldingRangeRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideFoldingRanges?l.provideFoldingRanges(i,o,s,c):c(i,o,s)}};return[sT.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ko.FoldingRangeFeature=oh});var uh=k(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.DeclarationFeature=void 0;var cT=require("vscode"),nc=Te(),uT=pt();function ah(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ch=class extends uT.TextDocumentFeature{constructor(e){super(e,nc.DeclarationRequest.type)}fillClientCapabilities(e){let t=ah(ah(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(nc.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,h),C=>a.handleFailedRequest(nc.DeclarationRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDeclaration?l.provideDeclaration(i,o,s,c):c(i,o,s)}};return[cT.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Vo.DeclarationFeature=ch});var fh=k(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.SelectionRangeFeature=void 0;var lT=require("vscode"),rc=Te(),dT=pt();function lh(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var dh=class extends dT.TextDocumentFeature{constructor(e){super(e,rc.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=lh(lh(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{let a=this._client,c=async(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),positions:await a.code2ProtocolConverter.asPositions(v,h)};return a.sendRequest(rc.SelectionRangeRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(b,h),b=>a.handleFailedRequest(rc.SelectionRangeRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,o,s,c):c(i,o,s)}};return[lT.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Bo.SelectionRangeFeature=dh});var hh=k(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.ProgressFeature=void 0;var fT=Te(),pT=Va();function hT(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var ph=class{constructor(e){this._client=e,this.activeParts=new Set}fillClientCapabilities(e){hT(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new pT.ProgressPart(this._client,i.token,t))};e.onRequest(fT.WorkDoneProgressCreateRequest.type,r)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Go.ProgressFeature=ph});var yh=k(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.CallHierarchyFeature=void 0;var gT=require("vscode"),Pr=Te(),mT=pt();function gh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var mh=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,c,l)=>{let g=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Pr.CallHierarchyPrepareRequest.type,g,l).then(v=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(v,l),v=>i.handleFailedRequest(Pr.CallHierarchyPrepareRequest.type,l,v,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(Pr.CallHierarchyIncomingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(Pr.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(Pr.CallHierarchyOutgoingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(Pr.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}},vh=class extends mT.TextDocumentFeature{constructor(e){super(e,Pr.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let r=gh(gh(e,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new mh(t);return[gT.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Xo.CallHierarchyFeature=vh});var wh=k(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.SemanticTokensFeature=void 0;var Qo=require("vscode"),ie=Te(),vT=pt(),yT=wn();function Jo(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Ch=class extends vT.TextDocumentFeature{constructor(e){super(e,ie.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=Jo(Jo(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[ie.SemanticTokenTypes.namespace,ie.SemanticTokenTypes.type,ie.SemanticTokenTypes.class,ie.SemanticTokenTypes.enum,ie.SemanticTokenTypes.interface,ie.SemanticTokenTypes.struct,ie.SemanticTokenTypes.typeParameter,ie.SemanticTokenTypes.parameter,ie.SemanticTokenTypes.variable,ie.SemanticTokenTypes.property,ie.SemanticTokenTypes.enumMember,ie.SemanticTokenTypes.event,ie.SemanticTokenTypes.function,ie.SemanticTokenTypes.method,ie.SemanticTokenTypes.macro,ie.SemanticTokenTypes.keyword,ie.SemanticTokenTypes.modifier,ie.SemanticTokenTypes.comment,ie.SemanticTokenTypes.string,ie.SemanticTokenTypes.number,ie.SemanticTokenTypes.regexp,ie.SemanticTokenTypes.operator,ie.SemanticTokenTypes.decorator],t.tokenModifiers=[ie.SemanticTokenModifiers.declaration,ie.SemanticTokenModifiers.definition,ie.SemanticTokenModifiers.readonly,ie.SemanticTokenModifiers.static,ie.SemanticTokenModifiers.deprecated,ie.SemanticTokenModifiers.abstract,ie.SemanticTokenModifiers.async,ie.SemanticTokenModifiers.modification,ie.SemanticTokenModifiers.documentation,ie.SemanticTokenModifiers.defaultLibrary],t.formats=[ie.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,Jo(Jo(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(ie.SemanticTokensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});let[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){let t=e.documentSelector,r=yT.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new Qo.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(C,b)=>{let x=this._client,q=x.clientOptions.middleware,O=(I,N)=>{let $={textDocument:x.code2ProtocolConverter.asTextDocumentIdentifier(I)};return x.sendRequest(ie.SemanticTokensRequest.type,$,N).then(K=>N.isCancellationRequested?null:x.protocol2CodeConverter.asSemanticTokens(K,N),K=>x.handleFailedRequest(ie.SemanticTokensRequest.type,N,K,null))};return q.provideDocumentSemanticTokens?q.provideDocumentSemanticTokens(C,b,O):O(C,b)},provideDocumentSemanticTokensEdits:i?(C,b,x)=>{let q=this._client,O=q.clientOptions.middleware,I=(N,$,K)=>{let de={textDocument:q.code2ProtocolConverter.asTextDocumentIdentifier(N),previousResultId:$};return q.sendRequest(ie.SemanticTokensDeltaRequest.type,de,K).then(async se=>K.isCancellationRequested?null:ie.SemanticTokens.is(se)?await q.protocol2CodeConverter.asSemanticTokens(se,K):await q.protocol2CodeConverter.asSemanticTokensEdits(se,K),se=>q.handleFailedRequest(ie.SemanticTokensDeltaRequest.type,K,se,null))};return O.provideDocumentSemanticTokensEdits?O.provideDocumentSemanticTokensEdits(C,b,x,I):I(C,b,x)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,b,x)=>{let q=this._client,O=q.clientOptions.middleware,I=(N,$,K)=>{let de={textDocument:q.code2ProtocolConverter.asTextDocumentIdentifier(N),range:q.code2ProtocolConverter.asRange($)};return q.sendRequest(ie.SemanticTokensRangeRequest.type,de,K).then(se=>K.isCancellationRequested?null:q.protocol2CodeConverter.asSemanticTokens(se,K),se=>q.handleFailedRequest(ie.SemanticTokensRangeRequest.type,K,se,null))};return O.provideDocumentRangeSemanticTokens?O.provideDocumentRangeSemanticTokens(C,b,x,I):I(C,b,x)}}:void 0,l=[],g=this._client,v=g.protocol2CodeConverter.asSemanticTokensLegend(e.legend),h=g.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&l.push(Qo.languages.registerDocumentSemanticTokensProvider(h,s,v)),c!==void 0&&l.push(Qo.languages.registerDocumentRangeSemanticTokensProvider(h,c,v)),[new Qo.Disposable(()=>l.forEach(C=>C.dispose())),{range:c,full:s,onDidChangeSemanticTokensEmitter:o}]}};Yo.SemanticTokensFeature=Ch});var bh=k((nE,Rh)=>{Rh.exports=function(n,e){for(var t=[],r=0;r<n.length;r++){var i=e(n[r],r);CT(i)?t.push.apply(t,i):t.push(i)}return t};var CT=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}});var Ph=k((rE,_h)=>{"use strict";_h.exports=Th;function Th(n,e,t){n instanceof RegExp&&(n=Dh(n,t)),e instanceof RegExp&&(e=Dh(e,t));var r=Sh(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Dh(n,e){var t=e.match(n);return t?t[0]:null}Th.range=Sh;function Sh(n,e,t){var r,i,o,s,a,c=t.indexOf(n),l=t.indexOf(e,c+1),g=c;if(c>=0&&l>0){if(n===e)return[c,l];for(r=[],o=t.length;g>=0&&!a;)g==c?(r.push(g),c=t.indexOf(n,g+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<o&&(o=i,s=l),l=t.indexOf(e,g+1)),g=c<l&&c>=0?c:l;r.length&&(a=[o,s])}return a}});var Fh=k((iE,Nh)=>{var wT=bh(),Eh=Ph();Nh.exports=DT;var xh="\0SLASH"+Math.random()+"\0",kh="\0OPEN"+Math.random()+"\0",oc="\0CLOSE"+Math.random()+"\0",qh="\0COMMA"+Math.random()+"\0",Oh="\0PERIOD"+Math.random()+"\0";function ic(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function RT(n){return n.split("\\\\").join(xh).split("\\{").join(kh).split("\\}").join(oc).split("\\,").join(qh).split("\\.").join(Oh)}function bT(n){return n.split(xh).join("\\").split(kh).join("{").split(oc).join("}").split(qh).join(",").split(Oh).join(".")}function Ih(n){if(!n)return[""];var e=[],t=Eh("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=Ih(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function DT(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),ni(RT(n),!0).map(bT)):[]}function TT(n){return"{"+n+"}"}function ST(n){return/^-?0\d/.test(n)}function _T(n,e){return n<=e}function PT(n,e){return n>=e}function ni(n,e){var t=[],r=Eh("{","}",n);if(!r||/\$$/.test(r.pre))return[n];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),s=i||o,a=r.body.indexOf(",")>=0;if(!s&&!a)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+oc+r.post,ni(n)):[n];var c;if(s)c=r.body.split(/\.\./);else if(c=Ih(r.body),c.length===1&&(c=ni(c[0],!1).map(TT),c.length===1)){var g=r.post.length?ni(r.post,!1):[""];return g.map(function(Tt){return r.pre+c[0]+Tt})}var l=r.pre,g=r.post.length?ni(r.post,!1):[""],v;if(s){var h=ic(c[0]),C=ic(c[1]),b=Math.max(c[0].length,c[1].length),x=c.length==3?Math.abs(ic(c[2])):1,q=_T,O=C<h;O&&(x*=-1,q=PT);var I=c.some(ST);v=[];for(var N=h;q(N,C);N+=x){var $;if(o)$=String.fromCharCode(N),$==="\\"&&($="");else if($=String(N),I){var K=b-$.length;if(K>0){var de=new Array(K+1).join("0");N<0?$="-"+de+$.slice(1):$=de+$}}v.push($)}}else v=wT(c,function(rt){return ni(rt,!1)});for(var se=0;se<v.length;se++)for(var He=0;He<g.length;He++){var Ge=l+v[se]+g[He];(!e||s||Ge)&&t.push(Ge)}return t}});var uc=k((oE,$h)=>{$h.exports=Ut;Ut.Minimatch=ht;var Gi=function(){try{return require("path")}catch{}}()||{sep:"/"};Ut.sep=Gi.sep;var cc=Ut.GLOBSTAR=ht.GLOBSTAR={},ET=Fh(),Lh={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},sc="[^/]",ac=sc+"*?",xT="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",kT="(?:(?!(?:\\/|^)\\.).)*?",Ah=qT("().*{}+?[]^$\\!");function qT(n){return n.split("").reduce(function(e,t){return e[t]=!0,e},{})}var Mh=/\/+/;Ut.filter=OT;function OT(n,e){return e=e||{},function(t,r,i){return Ut(t,n,e)}}function ir(n,e){e=e||{};var t={};return Object.keys(n).forEach(function(r){t[r]=n[r]}),Object.keys(e).forEach(function(r){t[r]=e[r]}),t}Ut.defaults=function(n){if(!n||typeof n!="object"||!Object.keys(n).length)return Ut;var e=Ut,t=function(i,o,s){return e(i,o,ir(n,s))};return t.Minimatch=function(i,o){return new e.Minimatch(i,ir(n,o))},t.Minimatch.defaults=function(i){return e.defaults(ir(n,i)).Minimatch},t.filter=function(i,o){return e.filter(i,ir(n,o))},t.defaults=function(i){return e.defaults(ir(n,i))},t.makeRe=function(i,o){return e.makeRe(i,ir(n,o))},t.braceExpand=function(i,o){return e.braceExpand(i,ir(n,o))},t.match=function(r,i,o){return e.match(r,i,ir(n,o))},t};ht.defaults=function(n){return Ut.defaults(n).Minimatch};function Ut(n,e,t){return es(e),t||(t={}),!t.nocomment&&e.charAt(0)==="#"?!1:new ht(e,t).match(n)}function ht(n,e){if(!(this instanceof ht))return new ht(n,e);es(n),e||(e={}),n=n.trim(),!e.allowWindowsEscape&&Gi.sep!=="/"&&(n=n.split(Gi.sep).join("/")),this.options=e,this.set=[],this.pattern=n,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}ht.prototype.debug=function(){};ht.prototype.make=IT;function IT(){var n=this.pattern,e=this.options;if(!e.nocomment&&n.charAt(0)==="#"){this.comment=!0;return}if(!n){this.empty=!0;return}this.parseNegate();var t=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,t),t=this.globParts=t.map(function(r){return r.split(Mh)}),this.debug(this.pattern,t),t=t.map(function(r,i,o){return r.map(this.parse,this)},this),this.debug(this.pattern,t),t=t.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,t),this.set=t}ht.prototype.parseNegate=NT;function NT(){var n=this.pattern,e=!1,t=this.options,r=0;if(!t.nonegate){for(var i=0,o=n.length;i<o&&n.charAt(i)==="!";i++)e=!e,r++;r&&(this.pattern=n.substr(r)),this.negate=e}}Ut.braceExpand=function(n,e){return jh(n,e)};ht.prototype.braceExpand=jh;function jh(n,e){return e||(this instanceof ht?e=this.options:e={}),n=typeof n>"u"?this.pattern:n,es(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:ET(n)}var FT=1024*64,es=function(n){if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>FT)throw new TypeError("pattern is too long")};ht.prototype.parse=LT;var Zo={};function LT(n,e){es(n);var t=this.options;if(n==="**")if(t.noglobstar)n="*";else return cc;if(n==="")return"";var r="",i=!!t.nocase,o=!1,s=[],a=[],c,l=!1,g=-1,v=-1,h=n.charAt(0)==="."?"":t.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",C=this;function b(){if(c){switch(c){case"*":r+=ac,i=!0;break;case"?":r+=sc,i=!0;break;default:r+="\\"+c;break}C.debug("clearStateChar %j %j",c,r),c=!1}}for(var x=0,q=n.length,O;x<q&&(O=n.charAt(x));x++){if(this.debug("%s	%s %s %j",n,x,r,O),o&&Ah[O]){r+="\\"+O,o=!1;continue}switch(O){case"/":return!1;case"\\":b(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",n,x,r,O),l){this.debug("  in class"),O==="!"&&x===v+1&&(O="^"),r+=O;continue}C.debug("call clearStateChar %j",c),b(),c=O,t.noext&&b();continue;case"(":if(l){r+="(";continue}if(!c){r+="\\(";continue}s.push({type:c,start:x-1,reStart:r.length,open:Lh[c].open,close:Lh[c].close}),r+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,r),c=!1;continue;case")":if(l||!s.length){r+="\\)";continue}b(),i=!0;var I=s.pop();r+=I.close,I.type==="!"&&a.push(I),I.reEnd=r.length;continue;case"|":if(l||!s.length||o){r+="\\|",o=!1;continue}b(),r+="|";continue;case"[":if(b(),l){r+="\\"+O;continue}l=!0,v=x,g=r.length,r+=O;continue;case"]":if(x===v+1||!l){r+="\\"+O,o=!1;continue}var N=n.substring(v+1,x);try{RegExp("["+N+"]")}catch{var $=this.parse(N,Zo);r=r.substr(0,g)+"\\["+$[0]+"\\]",i=i||$[1],l=!1;continue}i=!0,l=!1,r+=O;continue;default:b(),o?o=!1:Ah[O]&&!(O==="^"&&l)&&(r+="\\"),r+=O}}for(l&&(N=n.substr(v+1),$=this.parse(N,Zo),r=r.substr(0,g)+"\\["+$[0],i=i||$[1]),I=s.pop();I;I=s.pop()){var K=r.slice(I.reStart+I.open.length);this.debug("setting tail",r,I),K=K.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(ct,Ft,Xe){return Xe||(Xe="\\"),Ft+Ft+Xe+"|"}),this.debug(`tail=%j
   %s`,K,K,I,r);var de=I.type==="*"?ac:I.type==="?"?sc:"\\"+I.type;i=!0,r=r.slice(0,I.reStart)+de+"\\("+K}b(),o&&(r+="\\\\");var se=!1;switch(r.charAt(0)){case"[":case".":case"(":se=!0}for(var He=a.length-1;He>-1;He--){var Ge=a[He],rt=r.slice(0,Ge.reStart),Tt=r.slice(Ge.reStart,Ge.reEnd-8),gt=r.slice(Ge.reEnd-8,Ge.reEnd),mt=r.slice(Ge.reEnd);gt+=mt;var St=rt.split("(").length-1,at=mt;for(x=0;x<St;x++)at=at.replace(/\)[+*?]?/,"");mt=at;var vt="";mt===""&&e!==Zo&&(vt="$");var xn=rt+Tt+mt+vt+gt;r=xn}if(r!==""&&i&&(r="(?=.)"+r),se&&(r=h+r),e===Zo)return[r,i];if(!i)return MT(n);var Le=t.nocase?"i":"";try{var tt=new RegExp("^"+r+"$",Le)}catch{return new RegExp("$.")}return tt._glob=n,tt._src=r,tt}Ut.makeRe=function(n,e){return new ht(n,e||{}).makeRe()};ht.prototype.makeRe=AT;function AT(){if(this.regexp||this.regexp===!1)return this.regexp;var n=this.set;if(!n.length)return this.regexp=!1,this.regexp;var e=this.options,t=e.noglobstar?ac:e.dot?xT:kT,r=e.nocase?"i":"",i=n.map(function(o){return o.map(function(s){return s===cc?t:typeof s=="string"?jT(s):s._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch{this.regexp=!1}return this.regexp}Ut.match=function(n,e,t){t=t||{};var r=new ht(e,t);return n=n.filter(function(i){return r.match(i)}),r.options.nonull&&!n.length&&n.push(e),n};ht.prototype.match=function(e,t){if(typeof t>"u"&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var r=this.options;Gi.sep!=="/"&&(e=e.split(Gi.sep).join("/")),e=e.split(Mh),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var o,s;for(s=e.length-1;s>=0&&(o=e[s],!o);s--);for(s=0;s<i.length;s++){var a=i[s],c=e;r.matchBase&&a.length===1&&(c=[o]);var l=this.matchOne(c,a,t);if(l)return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate};ht.prototype.matchOne=function(n,e,t){var r=this.options;this.debug("matchOne",{this:this,file:n,pattern:e}),this.debug("matchOne",n.length,e.length);for(var i=0,o=0,s=n.length,a=e.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var c=e[o],l=n[i];if(this.debug(e,c,l),c===!1)return!1;if(c===cc){this.debug("GLOBSTAR",[e,c,l]);var g=i,v=o+1;if(v===a){for(this.debug("** at the end");i<s;i++)if(n[i]==="."||n[i]===".."||!r.dot&&n[i].charAt(0)===".")return!1;return!0}for(;g<s;){var h=n[g];if(this.debug(`
globstar while`,n,g,e,v,h),this.matchOne(n.slice(g),e.slice(v),t))return this.debug("globstar found match!",g,s,h),!0;if(h==="."||h===".."||!r.dot&&h.charAt(0)==="."){this.debug("dot detected!",n,g,e,v);break}this.debug("globstar swallow a segment, and continue"),g++}return!!(t&&(this.debug(`
>>> no match, partial?`,n,g,e,v),g===s))}var C;if(typeof c=="string"?(C=l===c,this.debug("string match",c,l,C)):(C=l.match(c),this.debug("pattern match",c,l,C)),!C)return!1}if(i===s&&o===a)return!0;if(i===s)return t;if(o===a)return i===s-1&&n[i]==="";throw new Error("wtf?")};function MT(n){return n.replace(/\\(.)/g,"$1")}function jT(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Xh=k(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.WillDeleteFilesFeature=At.WillRenameFilesFeature=At.WillCreateFilesFeature=At.DidDeleteFilesFeature=At.DidRenameFilesFeature=At.DidCreateFilesFeature=void 0;var rn=require("vscode"),$T=uc(),Hn=Te(),HT=Zr();function Hh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function WT(n,e){return n[e]}function Wh(n,e,t){n[e]=t}var or=class{constructor(e,t,r,i,o){this._filters=new Map,this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Hh(Hh(e,"workspace"),"fileOperations");Wh(t,"dynamicRegistration",!0),Wh(t,this._clientCapability,!0)}initialize(e){var i;let t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?WT(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:HT.generateUuid(),registerOptions:{filters:r.filters}})}catch(o){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${o}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new $T.Minimatch(r.pattern.glob,or.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return or.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async o=>{let s=t(o),a=s.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let l of c)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;let g=await this.getFileType(s);if(g===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(g===rn.FileType.File&&l.kind===Hn.FileOperationPatternKind.file||g===rn.FileType.Directory&&l.kind===Hn.FileOperationPatternKind.folder)return!0}else if(l.kind===Hn.FileOperationPatternKind.folder&&await or.getFileType(s)===rn.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return so(Ar({},e),{files:i})}static async getFileType(e){try{return(await rn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},lc=class extends or{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o);this._notificationType=r,this._accessUri=s,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},dc=class extends lc{constructor(){super(...arguments);this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await or.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},zh=class extends lc{constructor(e){super(e,rn.workspace.onDidCreateFiles,Hn.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didCreateFiles?r.didCreateFiles(e,t):t(e)}};At.DidCreateFilesFeature=zh;var Uh=class extends dc{constructor(e){super(e,rn.workspace.onDidRenameFiles,Hn.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=rn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){var i;this.clearFileTypeCache();let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didRenameFiles?r.didRenameFiles(e,t):t(e)}};At.DidRenameFilesFeature=Uh;var Kh=class extends dc{constructor(e){super(e,rn.workspace.onDidDeleteFiles,Hn.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=rn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){var i;this.clearFileTypeCache();let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};At.DidDeleteFilesFeature=Kh;var ts=class extends or{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o);this._requestType=r,this._accessUri=s,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},Vh=class extends ts{constructor(e){super(e,rn.workspace.onWillCreateFiles,Hn.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willCreateFiles?r.willCreateFiles(e,t):t(e)}};At.WillCreateFilesFeature=Vh;var Bh=class extends ts{constructor(e){super(e,rn.workspace.onWillRenameFiles,Hn.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willRenameFiles?r.willRenameFiles(e,t):t(e)}};At.WillRenameFilesFeature=Bh;var Gh=class extends ts{constructor(e){super(e,rn.workspace.onWillDeleteFiles,Hn.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};At.WillDeleteFilesFeature=Gh});var Yh=k(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.LinkedEditingFeature=void 0;var zT=require("vscode"),fc=Te(),UT=pt();function Qh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Jh=class extends UT.TextDocumentFeature{constructor(e){super(e,fc.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=Qh(Qh(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(fc.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,h),C=>a.handleFailedRequest(fc.LinkedEditingRangeRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,o,s,c):c(i,o,s)}};return[zT.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ns.LinkedEditingFeature=Jh});var ng=k(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.TypeHierarchyFeature=void 0;var KT=require("vscode"),Er=Te(),VT=pt();function Zh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var eg=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,c,l)=>{let g=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Er.TypeHierarchyPrepareRequest.type,g,l).then(v=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(v,l),v=>i.handleFailedRequest(Er.TypeHierarchyPrepareRequest.type,l,v,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Er.TypeHierarchySupertypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Er.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Er.TypeHierarchySubtypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Er.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}},tg=class extends VT.TextDocumentFeature{constructor(e){super(e,Er.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=Zh(Zh(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new eg(t);return[KT.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};rs.TypeHierarchyFeature=tg});var og=k(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.InlineValueFeature=void 0;var rg=require("vscode"),is=Te(),BT=pt();function os(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var ig=class extends BT.TextDocumentFeature{constructor(e){super(e,is.InlineValueRequest.type)}fillClientCapabilities(e){os(os(e,"textDocument"),"inlineValue").dynamicRegistration=!0,os(os(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(is.InlineValueRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new rg.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,a,c)=>{let l=this._client,g=(h,C,b,x)=>{let q={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(h),range:l.code2ProtocolConverter.asRange(C),context:l.code2ProtocolConverter.asInlineValueContext(b)};return l.sendRequest(is.InlineValueRequest.type,q,x).then(O=>x.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(O,x),O=>l.handleFailedRequest(is.InlineValueRequest.type,x,O,null))},v=l.clientOptions.middleware;return v.provideInlineValues?v.provideInlineValues(o,s,a,c,g):g(o,s,a,c)}};return[rg.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeInlineValues:r}]}};ss.InlineValueFeature=ig});var cg=k(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.InlayHintsFeature=void 0;var sg=require("vscode"),ri=Te(),GT=pt();function as(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var ag=class extends GT.TextDocumentFeature{constructor(e){super(e,ri.InlayHintRequest.type)}fillClientCapabilities(e){let t=as(as(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},as(as(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(ri.InlayHintRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new sg.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,a)=>{let c=this._client,l=async(v,h,C)=>{let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(h)};try{let x=await c.sendRequest(ri.InlayHintRequest.type,b,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(x,C)}catch(x){return c.handleFailedRequest(ri.InlayHintRequest.type,C,x,null)}},g=c.clientOptions.middleware;return g.provideInlayHints?g.provideInlayHints(o,s,a,l):l(o,s,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{let a=this._client,c=async(g,v)=>{try{let h=await a.sendRequest(ri.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(g),v);if(v.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(h,v);return v.isCancellationRequested?null:C}catch(h){return a.handleFailedRequest(ri.InlayHintResolveRequest.type,v,h,null)}},l=a.clientOptions.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,c):c(o,s)}:void 0,[sg.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeInlayHints:r}]}};cs.InlayHintsFeature=ag});var mg=k(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.DiagnosticFeature=xr.vsdiag=void 0;var ze=require("vscode"),Ve=Te(),XT=Zr(),Xi=pt();function ug(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Tn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Tn=xr.vsdiag||(xr.vsdiag={}));var Dt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(Dt||(Dt={}));var lg=class{constructor(){this.open=new Set;let e=()=>{if(this.open.clear(),ze.window.tabs!==void 0)for(let t of ze.window.tabs)t.resource!==void 0&&this.open.add(t.resource.toString());else if(ze.window.openEditors!==void 0)for(let t of ze.window.openEditors)t.resource!==void 0&&this.open.add(t.resource.toString())};e(),ze.window.onDidChangeTabs!==void 0?this.disposable=ze.window.onDidChangeTabs(e):ze.window.onDidChangeOpenEditors!==void 0?this.disposable=ze.window.onDidChangeOpenEditors(e):this.disposable={dispose:()=>{}}}dispose(){this.disposable.dispose()}isActive(e){var t;return((t=ze.window.activeTextEditor)==null?void 0:t.document)===e}isVisible(e){return this.open.has(e.uri.toString())}},Kt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Kt||(Kt={}));var dg=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Kt.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=typeof t=="string"?[t,ze.Uri.parse(t),r]:[t.uri.toString(),t.uri,t.version],c=i.get(o);return c===void 0&&(c={document:s,pulledVersion:a,resultId:void 0},i.set(o,c)),c}update(e,t,r,i){let o=e===Kt.document?this.documentPullStates:this.workspacePullStates,[s,a,c,l]=typeof t=="string"?[t,ze.Uri.parse(t),r,i]:[t.uri.toString(),t.uri,t.version,r],g=o.get(s);g===void 0?(g={document:a,pulledVersion:c,resultId:l},o.set(s,g)):(g.pulledVersion=c,g.resultId=l)}unTrack(e,t){(e===Kt.document?this.documentPullStates:this.workspacePullStates).delete(t.uri.toString())}tracks(e,t){let r=typeof t=="string"?t:t.uri.toString();return(e===Kt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var i;return(i=(e===Kt.document?this.documentPullStates:this.workspacePullStates).get(t.uri.toString()))==null?void 0:i.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},fg=class{constructor(e,t,r){this.client=e,this.editorTracker=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new ze.EventEmitter,this.provider=this.createProvider(),this.diagnostics=ze.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new dg,this.workspaceErrorCounter=0}knows(e,t){return this.documentStates.tracks(e,t)}pull(e,t){this.pullAsync(e).then(()=>{t&&t()},r=>{this.client.error(`Document pull failed for text document ${e.uri.toString()}`,r,!1)})}async pullAsync(e){let t=e.uri.toString(),r=e.version,i=this.openRequests.get(t),o=this.documentStates.track(Kt.document,e);if(i===void 0){let s=new ze.CancellationTokenSource;this.openRequests.set(t,{state:Dt.active,version:r,textDocument:e,tokenSource:s});let a,c;try{a=await this.provider.provideDiagnostics(e,o.resultId,s.token)??{kind:Tn.DocumentDiagnosticReportKind.full,items:[]}}catch(l){if(l instanceof Xi.LSPCancellationError&&Ve.Proposed.DiagnosticServerCancellationData.is(l.data)&&l.data.retriggerRequest===!1&&(c={state:Dt.outDated,textDocument:e}),c===void 0&&l instanceof ze.CancellationError)c={state:Dt.reschedule,textDocument:e};else throw l}if(c=c??this.openRequests.get(t),c===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${t}`),this.diagnostics.delete(e.uri);return}if(this.openRequests.delete(t),!this.editorTracker.isVisible(e)){this.documentStates.unTrack(Kt.document,e);return}if(c.state===Dt.outDated)return;a!==void 0&&(a.kind===Tn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(e.uri,a.items),o.pulledVersion=r,o.resultId=a.resultId),c.state===Dt.reschedule&&this.pull(e)}else i.state===Dt.active?(i.tokenSource.cancel(),this.openRequests.set(t,{state:Dt.reschedule,textDocument:i.textDocument})):i.state===Dt.outDated&&this.openRequests.set(t,{state:Dt.reschedule,textDocument:i.textDocument})}cleanupPull(e){let t=e.uri.toString(),r=this.openRequests.get(t);this.options.workspaceDiagnostics||this.options.interFileDependencies?r!==void 0?this.openRequests.set(t,{state:Dt.reschedule,textDocument:e}):this.pull(e):(r!==void 0&&(r.state===Dt.active&&r.tokenSource.cancel(),this.openRequests.set(t,{state:Dt.outDated,textDocument:e})),this.diagnostics.delete(e.uri))}pullWorkspace(){this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Ve.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Xi.LSPCancellationError)&&!Ve.Proposed.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Ve.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new ze.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Tn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Kt.document,r.uri.toString())||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Kt.workspace,r.uri.toString(),r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let o=(a,c,l)=>{let g={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a.uri)},previousResultId:c};return this.client.sendRequest(Ve.Proposed.DocumentDiagnosticRequest.type,g,l).then(async v=>v==null||this.isDisposed||l.isCancellationRequested?{kind:Tn.DocumentDiagnosticReportKind.full,items:[]}:v.kind===Ve.Proposed.DocumentDiagnosticReportKind.full?{kind:Tn.DocumentDiagnosticReportKind.full,resultId:v.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(v.items,l)}:{kind:Tn.DocumentDiagnosticReportKind.unChanged,resultId:v.resultId},v=>this.client.handleFailedRequest(Ve.Proposed.DocumentDiagnosticRequest.type,l,v,{kind:Tn.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.clientOptions.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let o=async l=>l.kind===Ve.Proposed.DocumentDiagnosticReportKind.full?{kind:Tn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:Tn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{let g=[];for(let v of l)g.push({uri:this.client.code2ProtocolConverter.asUri(v.uri),value:v.value});return g},a=(l,g)=>{let v=(0,XT.generateUuid)(),h=this.client.onProgress(Ve.Proposed.WorkspaceDiagnosticRequest.partialResult,v,async b=>{if(b==null){i(null);return}let x={items:[]};for(let q of b.items)try{x.items.push(await o(q))}catch(O){this.client.error("Converting workspace diagnostics failed.",O)}i(x)}),C={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:v};return this.client.sendRequest(Ve.Proposed.WorkspaceDiagnosticRequest.type,C,g).then(async b=>{if(g.isCancellationRequested)return{items:[]};let x={items:[]};for(let q of b.items)x.items.push(await o(q));return h.dispose(),i(x),{items:[]}},b=>(h.dispose(),this.client.handleFailedRequest(Ve.Proposed.DocumentDiagnosticRequest.type,g,b,{items:[]})))},c=this.client.clientOptions.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(let[r,i]of this.openRequests)i.state===Dt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Dt.outDated,textDocument:i.textDocument})}},pg=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Ve.LinkedMap}add(e){let t=e.uri.toString();this.documents.has(t)||(this.documents.set(e.uri.toString(),e,Ve.Touch.Last),this.trigger())}remove(e){let t=e.uri.toString();this.documents.has(t)&&(this.documents.delete(t),this.diagnosticRequestor.pull(e)),this.documents.size===0?this.stop():e===this.endDocument&&(this.endDocument=this.documents.last)}trigger(){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Ve.RAL)().timer.setInterval(()=>{let e=this.documents.first;e!==void 0&&(this.diagnosticRequestor.pull(e),this.documents.set(e.uri.toString(),e,Ve.Touch.Last),e===this.endDocument&&this.stop())},200)}dispose(){this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}},hg=class{constructor(e,t,r){var v;let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],a=h=>ze.languages.match(o,h)>0&&t.isVisible(h);this.diagnosticRequestor=new fg(e,t,r),this.backgroundScheduler=new pg(this.diagnosticRequestor);let c=h=>{!a(h)||!r.interFileDependencies||this.activeTextDocument===h||this.backgroundScheduler.add(h)};this.activeTextDocument=(v=ze.window.activeTextEditor)==null?void 0:v.document,ze.window.onDidChangeActiveTextEditor(h=>{let C=this.activeTextDocument;this.activeTextDocument=h==null?void 0:h.document,C!==void 0&&c(C),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let l=e.getFeature(Ve.DidOpenTextDocumentNotification.method);s.push(l.onNotificationSent(h=>{let C=h.original;a(C)&&this.diagnosticRequestor.pull(C,()=>{c(C)})}));for(let h of ze.workspace.textDocuments)a(h)&&this.diagnosticRequestor.pull(h,()=>{c(h)});if(i.onChange){let h=e.getFeature(Ve.DidChangeTextDocumentNotification.method);s.push(h.onNotificationSent(async C=>{let b=C.original.document;(i.filter===void 0||!i.filter(b,Xi.DiagnosticPullMode.onType))&&this.diagnosticRequestor.knows(Kt.document,b)&&C.original.contentChanges.length>0&&this.diagnosticRequestor.pull(b,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave){let h=e.getFeature(Ve.DidSaveTextDocumentNotification.method);s.push(h.onNotificationSent(C=>{let b=C.original;(i.filter===void 0||!i.filter(b,Xi.DiagnosticPullMode.onSave))&&this.diagnosticRequestor.knows(Kt.document,b)&&this.diagnosticRequestor.pull(C.original,()=>{this.backgroundScheduler.trigger()})}))}let g=e.getFeature(Ve.DidCloseTextDocumentNotification.method);s.push(g.onNotificationSent(h=>{let C=h.original;this.diagnosticRequestor.cleanupPull(C),this.backgroundScheduler.remove(C)})),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let h of ze.workspace.textDocuments)a(h)&&this.diagnosticRequestor.pull(h)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=ze.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}},gg=class extends Xi.TextDocumentFeature{constructor(e){super(e,Ve.Proposed.DocumentDiagnosticRequest.type);this.editorTracker=new lg}fillClientCapabilities(e){let t=ug(ug(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1}initialize(e,t){this._client.onRequest(Ve.Proposed.DiagnosticRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}dispose(){this.editorTracker.dispose(),super.dispose()}registerLanguageProvider(e){let t=new hg(this._client,this.editorTracker,e);return[t.disposable,t]}};xr.DiagnosticFeature=gg});var wg=k(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.NotebookDocumentSyncFeature=void 0;var qt=require("vscode"),QT=uc(),Wn=Te(),Sn=Te(),us=Zr(),vg=wn();function yg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ii;(function(n){let e;(function(t){function r(h,C){return{version:h.version,uri:C.asUri(h.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(h,C,b){let x=Wn.Proposed.NotebookDocument.create(b.asUri(h.uri),h.notebookType,h.version,o(C,b));return Object.keys(h.metadata).length>0&&(x.metadata=s(h.metadata)),x}t.asNotebookDocument=i;function o(h,C){return h.map(b=>a(b,C))}t.asNotebookCells=o;function s(h){return l(new Set,h)}t.asMetadata=s;function a(h,C){let b=Wn.Proposed.NotebookCell.create(c(h.kind),C.asUri(h.document.uri));return Object.keys(h.metadata).length>0&&(b.metadata=s(h.metadata)),h.executionSummary!==void 0&&vg.number(h.executionSummary.executionOrder)&&vg.boolean(h.executionSummary.success)&&(b.executionSummary={executionOrder:h.executionSummary.executionOrder,success:h.executionSummary.success}),b}t.asNotebookCell=a;function c(h){switch(h){case qt.NotebookCellKind.Markup:return Wn.Proposed.NotebookCellKind.Markup;case qt.NotebookCellKind.Code:return Wn.Proposed.NotebookCellKind.Code}}function l(h,C){if(h.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let b=[];for(let x of C)if(x!==null&&typeof x=="object"||Array.isArray(x))b.push(l(h,x));else{if(x instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b.push(x)}return b}else{let b=Object.keys(C),x=Object.create(null);for(let q of b){let O=C[q];if(O!==null&&typeof O=="object"||Array.isArray(O))x[q]=l(h,O);else{if(O instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");x[q]=O}}return x}}function g(h,C){let b=C.asChangeTextDocumentParams(h);return{document:b.textDocument,changes:b.contentChanges}}t.asTextContentChange=g;function v(h,C){let b=Object.create(null);if(h.metadata&&(b.metadata=n.c2p.asMetadata(h.metadata)),h.cells!==void 0){let x=Object.create(null),q=h.cells;q.structure&&(x.structure={array:{start:q.structure.array.start,deleteCount:q.structure.array.deleteCount,cells:q.structure.array.cells!==void 0?q.structure.array.cells.map(O=>n.c2p.asNotebookCell(O,C)):void 0},didOpen:q.structure.didOpen!==void 0?q.structure.didOpen.map(O=>C.asOpenTextDocumentParams(O.document).textDocument):void 0,didClose:q.structure.didClose!==void 0?q.structure.didClose.map(O=>C.asCloseTextDocumentParams(O.document).textDocument):void 0}),q.data!==void 0&&(x.data=q.data.map(O=>n.c2p.asNotebookCell(O,C))),q.textContent!==void 0&&(x.textContent=q.textContent.map(O=>n.c2p.asTextContentChange(O,C))),Object.keys(x).length>0&&(b.cells=x)}return b}t.asNotebookDocumentChangeEvent=v})(e=n.c2p||(n.c2p={}))})(ii||(ii={}));var pc;(function(n){function e(a,c,l){let g=a.length,v=c.length,h=0;for(;h<v&&h<g&&t(a[h],c[h],l);)h++;if(h<v&&h<g){let C=g-1,b=v-1;for(;C>=0&&b>=0&&t(a[C],c[b],l);)C--,b--;let x=C+1-h,q=h===b+1?void 0:c.slice(h,b+1);return q!==void 0?{start:h,deleteCount:x,cells:q}:{start:h,deleteCount:x}}else return h<v?{start:h,deleteCount:0,cells:c.slice(h)}:h<g?{start:h,deleteCount:g-h}:void 0}n.computeDiff=e;function t(a,c,l=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!l||l&&o(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function o(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let l=Array.isArray(a),g=Array.isArray(c);if(l!==g)return!1;if(l&&g){if(a.length!==c.length)return!1;for(let v=0;v<a.length;v++)if(!o(a[v],c[v]))return!1}if(s(a)&&s(c)){let v=Object.keys(a),h=Object.keys(c);if(v.length!==h.length||(v.sort(),h.sort(),!o(v,h)))return!1;for(let C=0;C<v.length;C++){let b=v[C];if(!o(a[b],c[b]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=s})(pc||(pc={}));var hc;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let o=new QT.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(hc||(hc={}));var ls;(function(n){function e(r){var s,a,c;let i=r.notebookSelector,o=[];for(let l of i){let g=(typeof l.notebook=="string"?l.notebook:(s=l.notebook)==null?void 0:s.notebookType)??"*",v=typeof l.notebook=="string"||(a=l.notebook)==null?void 0:a.scheme,h=typeof l.notebook=="string"||(c=l.notebook)==null?void 0:c.pattern;if(l.cells!==void 0)for(let C of l.cells)o.push(t(g,v,h,C.language));else o.push(t(g,v,h,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})(ls||(ls={}));var ds;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(ds||(ds={}));var Qi=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(ls.asDocumentSelector(t)),qt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of qt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);qt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&qt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),qt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}get mode(){return"notebook"}handles(e){return qt.languages.match(this.selector,e.document)>0}didOpenNotebookCellTextDocument(e,t){if(qt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){let s=this.getMatchingCells(e);if(s!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){qt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let s=r.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var o;let r=async(s,a)=>{let c=ii.c2p.asNotebookDocument(s,a,this.client.code2ProtocolConverter),l=a.map(g=>this.client.code2ProtocolConverter.asTextDocumentItem(g.document));try{await this.client.sendNotification(Wn.Proposed.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:l})}catch(g){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",g),g}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),ds.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var o,s;let r=async a=>{try{await this.client.sendNotification(Wn.Proposed.DidChangeNotebookDocumentNotification.type,{notebookDocument:ii.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:ii.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return((s=e.cells)==null?void 0:s.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),ds.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;let t=async o=>{try{await this.client.sendNotification(Wn.Proposed.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=(i=this.client.clientOptions.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var o;let r=async(s,a)=>{try{await this.client.sendNotification(Wn.Proposed.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let o={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(o.metadata=ii.c2p.asMetadata(t.metadata));let s;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){let a=[];s=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)s.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,l=pc.computeDiff(a,c,!1),g,v;if(l!==void 0){g=l.cells===void 0?new Map:new Map(l.cells.map(b=>[b.document.uri.toString(),b])),v=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(b=>[b.document.uri.toString(),b]));for(let b of Array.from(v.keys()))g.has(b)&&(v.delete(b),g.delete(b));o.cells=o.cells??{};let h=[],C=[];if(g.size>0||v.size>0){for(let b of g.values())h.push(b);for(let b of v.values())C.push(b)}o.cells.structure={array:l,didOpen:h,didClose:C}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0){if(r.cells===void 0)return;let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}else if(hc.matchNotebook(r.notebook,e))return r.cells===void 0?t:this.filterCells(e,t,r.cells)}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var o;let i=t.filter(s=>{let a=s.document.languageId;return r.some(c=>c.language==="*"||a===c.language)});return typeof((o=this.client.clientOptions.notebookDocumentOptions)==null?void 0:o.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,t):i}},Cg=class{constructor(e,t){this.client=e,this.documentSelector=ls.asDocumentSelector(t);let r=us.generateUuid();this.client.getFeature(Sn.DidOpenTextDocumentNotification.method).register({id:r,registerOptions:{documentSelector:this.documentSelector}});let i=us.generateUuid();this.client.getFeature(Sn.DidChangeTextDocumentNotification.method).register({id:i,registerOptions:{documentSelector:this.documentSelector,syncKind:Sn.TextDocumentSyncKind.Incremental}});let o=us.generateUuid();this.client.getFeature(Sn.DidCloseTextDocumentNotification.method).register({id:o,registerOptions:{documentSelector:this.documentSelector}}),this.registrations={open:r,change:i,close:o}}get mode(){return"cellContent"}handles(e){return qt.languages.match(this.client.protocol2CodeConverter.asDocumentSelector(this.documentSelector),e.document)>0}dispose(){this.registrations!==void 0&&(this.client.getFeature(Sn.DidOpenTextDocumentNotification.method).unregister(this.registrations.open),this.client.getFeature(Sn.DidChangeTextDocumentNotification.method).unregister(this.registrations.change),this.client.getFeature(Sn.DidCloseTextDocumentNotification.method).unregister(this.registrations.close))}async sendDidOpenTextDocument(e){let t=this.client.getFeature(Sn.DidOpenTextDocumentNotification.method).getProvider(e);return t!==void 0?t.send(e):Promise.reject(new Error(`No open provider found for notebook cell document ${e.uri.toString()}`))}async sendDidChangeTextDocument(e){let t=this.client.getFeature(Sn.DidChangeTextDocumentNotification.method).getProvider(e.document);return t!==void 0?t.send(e):Promise.reject(new Error(`No change provider found for notebook cell document ${e.document.uri.toString()}`))}async sendDidCloseTextDocument(e){let t=this.client.getFeature(Sn.DidCloseTextDocumentNotification.method).getProvider(e);return t!==void 0?t.send(e):Promise.reject(new Error(`No close provider found for notebook cell document ${e.uri.toString()}`))}},kr=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=Wn.Proposed.NotebookDocumentSyncRegistrationType.type,qt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==kr.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Qi&&o.didOpenNotebookCellTextDocument(r,i)}),qt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==kr.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let o of this.registrations.values())o instanceof Qi&&o.didChangeNotebookCellTextDocument(i,t)}),qt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==kr.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Qi&&o.didCloseNotebookCellTextDocument(r,i)})}fillClientCapabilities(e){let t=yg(yg(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??us.generateUuid();this.register({id:r,registerOptions:t})}register(e){if(e.registerOptions.mode==="cellContent"){let t=new Cg(this.client,e.registerOptions);this.registrations.set(e.id,t)}else{let t=new Qi(this.client,e.registerOptions);this.registrations.set(e.id,t)}}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}dispose(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}getProvider(e){for(let t of this.registrations.values())if(t.handles(e))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of qt.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};fs.NotebookDocumentSyncFeature=kr;kr.CellScheme="vscode-notebook-cell"});var gc=k(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.ProposedFeatures=qr.CommonLanguageClient=void 0;var JT=pt(),YT=Qp(),ZT=_a(),eS=Zp(),tS=th(),nS=rh(),rS=sh(),iS=uh(),oS=fh(),sS=hh(),aS=yh(),cS=wh(),oi=Xh(),uS=Yh(),lS=ng(),dS=og(),fS=cg(),Dg=class extends JT.BaseLanguageClient{constructor(e,t,r){super(e,t,r)}registerProposedFeatures(){this.registerFeatures(Tg.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new ZT.ConfigurationFeature(this)),this.registerFeature(new tS.TypeDefinitionFeature(this)),this.registerFeature(new eS.ImplementationFeature(this)),this.registerFeature(new YT.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new nS.WorkspaceFoldersFeature(this)),this.registerFeature(new rS.FoldingRangeFeature(this)),this.registerFeature(new iS.DeclarationFeature(this)),this.registerFeature(new oS.SelectionRangeFeature(this)),this.registerFeature(new sS.ProgressFeature(this)),this.registerFeature(new aS.CallHierarchyFeature(this)),this.registerFeature(new cS.SemanticTokensFeature(this)),this.registerFeature(new uS.LinkedEditingFeature(this)),this.registerFeature(new oi.DidCreateFilesFeature(this)),this.registerFeature(new oi.DidRenameFilesFeature(this)),this.registerFeature(new oi.DidDeleteFilesFeature(this)),this.registerFeature(new oi.WillCreateFilesFeature(this)),this.registerFeature(new oi.WillRenameFilesFeature(this)),this.registerFeature(new oi.WillDeleteFilesFeature(this)),this.registerFeature(new lS.TypeHierarchyFeature(this)),this.registerFeature(new dS.InlineValueFeature(this)),this.registerFeature(new fS.InlayHintsFeature(this))}};qr.CommonLanguageClient=Dg;var Rg=mg(),bg=wg(),Tg;(function(n){function e(i){return[new Rg.DiagnosticFeature(i),new bg.NotebookDocumentSyncFeature(i)]}n.createAll=e;function t(i){return new Rg.DiagnosticFeature(i)}n.createDiagnosticFeature=t;function r(i){return new bg.NotebookDocumentSyncFeature(i)}n.createNotebookDocumentSyncFeature=r})(Tg=qr.ProposedFeatures||(qr.ProposedFeatures={}))});var _g=k(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.terminate=void 0;var Sg=require("child_process"),pS=require("path"),hS=process.platform==="win32",gS=process.platform==="darwin",mS=process.platform==="linux";function vS(n,e){if(hS)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Sg.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(mS||gS)try{var t=(0,pS.join)(__dirname,"terminateProcess.sh"),r=Sg.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}ps.terminate=vS});var mc=k((gE,Pg)=>{"use strict";Pg.exports=Te()});var Eg=k(zn=>{"use strict";var yS=zn&&zn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),vc=zn&&zn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&yS(e,n,t)};Object.defineProperty(zn,"__esModule",{value:!0});vc(Te(),zn);vc(pt(),zn);vc(gc(),zn)});var hs=k(Ot=>{"use strict";var CS=Ot&&Ot.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),qg=Ot&&Ot.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&CS(e,n,t)};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.SettingMonitor=Ot.LanguageClient=Ot.TransportKind=void 0;var Un=require("child_process"),yc=require("fs"),Cc=require("path"),xg=Ul(),ar=require("vscode"),Fe=wn(),wS=gc(),RS=pt(),bS=_g(),$e=mc();qg(mc(),Ot);qg(Eg(),Ot);var kg="^1.66.0",Ue;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(Ue=Ot.TransportKind||(Ot.TransportKind={}));var sr;(function(n){function e(t){let r=t;return r&&r.kind===Ue.socket&&Fe.number(r.port)}n.isSocket=e})(sr||(sr={}));var wc;(function(n){function e(t){return Fe.string(t.command)}n.is=e})(wc||(wc={}));var Rc;(function(n){function e(t){return Fe.string(t.module)}n.is=e})(Rc||(Rc={}));var bc;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(bc||(bc={}));var Dc;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(Dc||(Dc={}));var Og=class extends wS.CommonLanguageClient{constructor(e,t,r,i,o){let s,a,c,l,g;Fe.string(t)?(s=e,a=t,c=r,l=i,g=!!o):(s=e.toLowerCase(),a=e,c=t,l=r,g=i),g===void 0&&(g=!1);super(s,a,l);this._serverOptions=c,this._forceDebug=g,this._isInDebugMode=g;try{this.checkVersion()}catch(v){throw Fe.string(v.message)&&this.outputChannel.appendLine(v.message),v}}checkVersion(){let e=xg.parse(ar.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${ar.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!xg.satisfies(e,kg))throw new Error(`The language client requires VS Code version ${kg} but received version ${ar.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),this.start()):this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||setTimeout(()=>{try{process.kill(e.pid,0),(0,bS.terminate)(e)}catch{}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(g,v){if(!g&&!v)return;let h=Object.create(null);return Object.keys(process.env).forEach(C=>h[C]=process.env[C]),v&&(h.ELECTRON_RUN_AS_NODE="1",h.ELECTRON_NO_ASAR="1"),g&&Object.keys(g).forEach(C=>h[C]=g[C]),h}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function o(){let g=process.execArgv;return g?g.some(v=>r.some(h=>v.startsWith(h))||i.some(h=>v===h)):!1}function s(g){if(g.stdin===null||g.stdout===null||g.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Fe.func(a))return a().then(g=>{if(RS.MessageTransports.is(g))return this._isDetached=!!g.detached,g;if(bc.is(g))return this._isDetached=!!g.detached,{reader:new $e.StreamMessageReader(g.reader),writer:new $e.StreamMessageWriter(g.writer)};{let v;return Dc.is(g)?(v=g.process,this._isDetached=g.detached):(v=g,this._isDetached=!1),v.stderr.on("data",h=>this.outputChannel.append(Fe.string(h)?h:h.toString(e))),{reader:new $e.StreamMessageReader(v.stdout),writer:new $e.StreamMessageWriter(v.stdin)}}});let c,l=a;return l.run||l.debug?this._forceDebug||o()?(c=l.debug,this._isInDebugMode=!0):(c=l.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(g=>{if(Rc.is(c)&&c.module){let v=c,h=v.transport||Ue.stdio;if(v.runtime){let C=[],b=v.options??Object.create(null);b.execArgv&&b.execArgv.forEach(I=>C.push(I)),C.push(v.module),v.args&&v.args.forEach(I=>C.push(I));let x=Object.create(null);x.cwd=g,x.env=t(b.env,!1);let q=this._getRuntimePath(v.runtime,g),O;if(h===Ue.ipc?(x.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):h===Ue.stdio?C.push("--stdio"):h===Ue.pipe?(O=(0,$e.generateRandomPipeName)(),C.push(`--pipe=${O}`)):sr.isSocket(h)&&C.push(`--socket=${h.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),h===Ue.ipc||h===Ue.stdio){let I=Un.spawn(q,C,x);return!I||!I.pid?si(I,`Launching server using runtime ${q} failed.`):(this._serverProcess=I,I.stderr.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),h===Ue.ipc?(I.stdout.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),Promise.resolve({reader:new $e.IPCMessageReader(I),writer:new $e.IPCMessageWriter(I)})):Promise.resolve({reader:new $e.StreamMessageReader(I.stdout),writer:new $e.StreamMessageWriter(I.stdin)}))}else{if(h===Ue.pipe)return(0,$e.createClientPipeTransport)(O).then(I=>{let N=Un.spawn(q,C,x);return!N||!N.pid?si(N,`Launching server using runtime ${q} failed.`):(this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>({reader:$[0],writer:$[1]})))});if(sr.isSocket(h))return(0,$e.createClientSocketTransport)(h.port).then(I=>{let N=Un.spawn(q,C,x);return!N||!N.pid?si(N,`Launching server using runtime ${q} failed.`):(this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>({reader:$[0],writer:$[1]})))})}}else{let C;return new Promise((b,x)=>{let q=(v.args&&v.args.slice())??[];h===Ue.ipc?q.push("--node-ipc"):h===Ue.stdio?q.push("--stdio"):h===Ue.pipe?(C=(0,$e.generateRandomPipeName)(),q.push(`--pipe=${C}`)):sr.isSocket(h)&&q.push(`--socket=${h.port}`),q.push(`--clientProcessId=${process.pid.toString()}`);let O=v.options??Object.create(null);if(O.env=t(O.env,!0),O.execArgv=O.execArgv||[],O.cwd=g,O.silent=!0,h===Ue.ipc||h===Ue.stdio){let I=Un.fork(v.module,q||[],O);s(I),this._serverProcess=I,I.stderr.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),h===Ue.ipc?(I.stdout.on("data",N=>this.outputChannel.append(Fe.string(N)?N:N.toString(e))),b({reader:new $e.IPCMessageReader(this._serverProcess),writer:new $e.IPCMessageWriter(this._serverProcess)})):b({reader:new $e.StreamMessageReader(I.stdout),writer:new $e.StreamMessageWriter(I.stdin)})}else h===Ue.pipe?(0,$e.createClientPipeTransport)(C).then(I=>{let N=Un.fork(v.module,q||[],O);s(N),this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>{b({reader:$[0],writer:$[1]})},x)},x):sr.isSocket(h)&&(0,$e.createClientSocketTransport)(h.port).then(I=>{let N=Un.fork(v.module,q||[],O);s(N),this._serverProcess=N,N.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),N.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),I.onConnected().then($=>{b({reader:$[0],writer:$[1]})},x)},x)})}}else if(wc.is(c)&&c.command){let v=c,h=c.args!==void 0?c.args.slice(0):[],C,b=c.transport;if(b===Ue.stdio)h.push("--stdio");else if(b===Ue.pipe)C=(0,$e.generateRandomPipeName)(),h.push(`--pipe=${C}`);else if(sr.isSocket(b))h.push(`--socket=${b.port}`);else if(b===Ue.ipc)throw new Error("Transport kind ipc is not support for command executable");let x=Object.assign({},v.options);if(x.cwd=x.cwd||g,b===void 0||b===Ue.stdio){let q=Un.spawn(v.command,h,x);return!q||!q.pid?si(q,`Launching server using command ${v.command} failed.`):(q.stderr.on("data",O=>this.outputChannel.append(Fe.string(O)?O:O.toString(e))),this._serverProcess=q,this._isDetached=!!x.detached,Promise.resolve({reader:new $e.StreamMessageReader(q.stdout),writer:new $e.StreamMessageWriter(q.stdin)}))}else{if(b===Ue.pipe)return(0,$e.createClientPipeTransport)(C).then(q=>{let O=Un.spawn(v.command,h,x);return!O||!O.pid?si(O,`Launching server using command ${v.command} failed.`):(this._serverProcess=O,this._isDetached=!!x.detached,O.stderr.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),O.stdout.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),q.onConnected().then(I=>({reader:I[0],writer:I[1]})))});if(sr.isSocket(b))return(0,$e.createClientSocketTransport)(b.port).then(q=>{let O=Un.spawn(v.command,h,x);return!O||!O.pid?si(O,`Launching server using command ${v.command} failed.`):(this._serverProcess=O,this._isDetached=!!x.detached,O.stderr.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),O.stdout.on("data",I=>this.outputChannel.append(Fe.string(I)?I:I.toString(e))),q.onConnected().then(I=>({reader:I[0],writer:I[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(Cc.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=Cc.join(r,e);if(yc.existsSync(i))return i}if(t!==void 0){let i=Cc.join(t,e);if(yc.existsSync(i))return i}return e}_mainGetRootPath(){let e=ar.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{yc.lstat(t,(i,o)=>{r(!i&&o.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}getLocale(){let e=process.env.VSCODE_NLS_CONFIG;if(e===void 0)return"en";let t;try{t=JSON.parse(e)}catch{}return t===void 0||typeof t.locale!="string"?"en":t.locale}};Ot.LanguageClient=Og;var Ig=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return ar.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new ar.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?ar.workspace.getConfiguration(t).get(r,!1):ar.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start():!i&&this._client.needsStop()&&this._client.stop()}};Ot.SettingMonitor=Ig;function si(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var Sc=k((yE,tm)=>{"use strict";tm.exports=hs()});var BS={};_v(BS,{activate:()=>vv,deactivate:()=>jS,outputChannel:()=>jc,traceOutputChannel:()=>Mc});module.exports=Pv(BS);var pe=qe(require("vscode")),hv=qe(require("os"));var M=qe(require("vscode")),ro=qe(hs());var Oe=qe(hs()),Ng=new Oe.RequestType("rust-analyzer/analyzerStatus"),Fg=new Oe.RequestType0("rust-analyzer/memoryUsage"),Lg=new Oe.RequestType0("rust-analyzer/shuffleCrateGraph"),Ag=new Oe.NotificationType("experimental/serverStatus"),Mg=new Oe.RequestType0("rust-analyzer/reloadWorkspace"),jg=new Oe.RequestType("textDocument/hover"),$g=new Oe.RequestType("rust-analyzer/syntaxTree"),Hg=new Oe.RequestType("rust-analyzer/viewHir"),Wg=new Oe.RequestType("rust-analyzer/viewFileText"),zg=new Oe.RequestType("rust-analyzer/viewItemTree"),Ug=new Oe.RequestType("rust-analyzer/viewCrateGraph"),Kg=new Oe.RequestType("rust-analyzer/expandMacro"),Vg=new Oe.RequestType("experimental/matchingBrace"),Bg=new Oe.RequestType("experimental/parentModule"),Gg=new Oe.RequestType("experimental/joinLines"),Xg=new Oe.RequestType("experimental/onEnter"),Qg=new Oe.RequestType("experimental/runnables"),Jg=new Oe.RequestType("rust-analyzer/relatedTests"),Tc=new Oe.RequestType("experimental/ssr"),Yg=new Oe.RequestType("experimental/externalDocs"),Zg=new Oe.RequestType("experimental/openCargoToml"),em=new Oe.RequestType("experimental/moveItem");var xm=qe(require("path"));var vn=qe(require("vscode"));var DS=qe(Sc()),ms=qe(require("vscode")),nm=require("assert"),vs=require("child_process"),rm=require("util");function Ji(n,e){try{(0,nm.strict)(n,e)}catch(t){throw De.error("Assertion failed:",e),t}}var De=new class{constructor(){this.enabled=!0;this.output=ms.window.createOutputChannel("Rust Analyzer Client")}setEnabled(n){De.enabled=n}debug(...n){!De.enabled||De.write("DEBUG",...n)}info(...n){De.write("INFO",...n)}warn(...n){debugger;De.write("WARN",...n)}error(...n){debugger;De.write("ERROR",...n),De.output.show(!0)}write(n,...e){let t=e.map(De.stringify).join(" "),r=new Date().toLocaleString();De.output.appendLine(`${n} [${r}]: ${t}`)}stringify(n){return typeof n=="string"?n:(0,rm.inspect)(n,{colors:!1,depth:6})}};function Yi(n){return new Promise(e=>setTimeout(e,n))}function Kn(n){return n.languageId==="rust"&&n.uri.scheme==="file"}function im(n){return n.uri.scheme==="file"&&n.fileName.endsWith("Cargo.toml")}function _n(n){return Kn(n.document)}function om(n){De.debug("Checking availability of a binary at",n);let e=(0,vs.spawnSync)(n,["--version"],{encoding:"utf8"});return(e.error&&e.error.code!=="ENOENT"?De.warn:De.debug)(n,"--version:",e),e.status===0}function _c(n,e){return ms.commands.executeCommand("setContext",n,e)}function sm(n){let e=new Map;return async function(t){let r=e.get(t);if(r)return r;let i=await n.call(this,t);return e.set(t,i),i}}function Pc(n,e){return new Promise((t,r)=>{(0,vs.exec)(n,e,(i,o,s)=>{if(i){r(i);return}if(s){r(new Error(s));return}t(o.trimEnd())})})}async function Ec(n){if(n.entries().length===1){let[e,t]=n.entries()[0],r=await am(e);r&&await ys(r,t);return}for(let[e,t]of n.entries()){let r=await am(e);r&&await r.edit(i=>{for(let o of t)Ji(!um(o.newText),`bad ws edit: snippet received with multiple edits: ${JSON.stringify(n)}`),i.replace(o.range,o.newText)})}}async function am(n){var e;return((e=vn.window.activeTextEditor)==null?void 0:e.document.uri)!==n&&await vn.window.showTextDocument(n,{}),vn.window.visibleTextEditors.find(t=>t.document.uri.toString()===n.toString())}async function ys(n,e){let t=[],r=0;await n.edit(i=>{for(let o of e){let s=um(o.newText);if(s){let[a,[c,l]]=s,g=a.substr(0,c),v=g.lastIndexOf(`
`),h=o.range.start.line+r+cm(g),C=v===-1?o.range.start.character+c:g.length-v-1,b=C+l;t.push(new vn.Selection(new vn.Position(h,C),new vn.Position(h,b))),i.replace(o.range,a)}else i.replace(o.range,o.newText);r+=cm(o.newText)-(o.range.end.line-o.range.start.line)}}),t.length>0&&(n.selections=t),t.length===1&&n.revealRange(t[0],vn.TextEditorRevealType.InCenterIfOutsideViewport)}function um(n){let e=n.match(/\$(0|\{0:([^}]*)\})/);if(!e)return;let t=e[2]??"";if(e.index==null)return;let r=[e.index,t.length];return[n.replace(e[0],t),r]}function cm(n){return(n.match(/\n/g)||[]).length}var km=require("child_process");var Or=qe(require("vscode"));var et=qe(require("vscode"));var lm=qe(require("child_process")),Cs=qe(require("os")),ws=qe(require("path")),dm=qe(require("readline")),cr=qe(require("vscode"));var Zi=class{constructor(e,t){this.rootFolder=e;this.output=t}static artifactSpec(e){let t=[...e,"--message-format=json"];switch(t[0]){case"run":t[0]="build";break;case"test":{t.includes("--no-run")||t.push("--no-run");break}}let r={cargoArgs:t};return t[0]==="test"&&(r.filter=i=>i.filter(o=>o.isTest)),r}async getArtifacts(e){var r;let t=[];try{await this.runCargo(e.cargoArgs,i=>{if(i.reason==="compiler-artifact"&&i.executable){let o=i.target.crate_types.includes("bin"),s=i.target.kind.includes("custom-build");(o&&!s||i.profile.test)&&t.push({fileName:i.executable,name:i.target.name,kind:i.target.kind[0],isTest:i.profile.test})}else i.reason==="compiler-message"&&this.output.append(i.message.rendered)},i=>this.output.append(i))}catch(i){throw this.output.show(!0),new Error(`Cargo invocation has failed: ${i}`)}return((r=e.filter)==null?void 0:r.call(e,t))??t}async executableFromArgs(e){let t=await this.getArtifacts(Zi.artifactSpec(e));if(t.length===0)throw new Error("No compilation artifacts");if(t.length>1)throw new Error("Multiple compilation artifacts are not supported.");return t[0].fileName}async runCargo(e,t,r){let i=await xc();return await new Promise((o,s)=>{let a=lm.spawn(i,e,{stdio:["ignore","pipe","pipe"],cwd:this.rootFolder});a.on("error",l=>s(new Error(`could not launch cargo: ${l}`))),a.stderr.on("data",l=>r(l.toString())),dm.createInterface({input:a.stdout}).on("line",l=>{let g=JSON.parse(l);t(g)}),a.on("exit",(l,g)=>{l===0?o(l):s(new Error(`exit code: ${l}.`))})})}};async function fm(n){let e=await kc("rustc");return await Pc(`${e} --print sysroot`,{cwd:n})}async function pm(n){let e=await kc("rustc"),t=await Pc(`${e} -V -v`,{cwd:n});return/commit-hash:\s(.*)$/m.exec(t)[1]}function xc(){return kc("cargo")}var kc=sm(async n=>{{let e=process.env[n.toUpperCase()];if(e)return e}if(await TS(n))return n;try{let e=cr.Uri.joinPath(cr.Uri.file(Cs.homedir()),".cargo","bin",n);if(await hm(e))return e.fsPath}catch(e){De.error("Failed to read the fs info",e)}return n});async function TS(n){let t=(process.env.PATH??"").split(ws.delimiter).flatMap(r=>{let i=ws.join(r,n);return Cs.type()==="Windows_NT"?[i,`${i}.exe`]:[i]});for await(let r of t.map(SS))if(r)return!0;return!1}async function SS(n){return hm(cr.Uri.file(n))}async function hm(n){try{return((await cr.workspace.fs.stat(n)).type&cr.FileType.File)!==0}catch{return!1}}var ai="cargo",PS="rust",gm=class{constructor(e){this.config=e}async provideTasks(){let e=[{command:"build",group:et.TaskGroup.Build},{command:"check",group:et.TaskGroup.Build},{command:"clippy",group:et.TaskGroup.Build},{command:"test",group:et.TaskGroup.Test},{command:"clean",group:et.TaskGroup.Clean},{command:"run",group:void 0}],t=[];for(let r of et.workspace.workspaceFolders||[])for(let i of e){let o=await Rs(r,{type:ai,command:i.command},`cargo ${i.command}`,[i.command],this.config.cargoRunner);o.group=i.group,t.push(o)}return t}async resolveTask(e){let t=e.definition;if(t.type===ai&&t.command){let r=[t.command].concat(t.args??[]);return await Rs(e.scope,t,e.name,r,this.config.cargoRunner)}}};async function Rs(n,e,t,r,i,o=!1){let s;if(i){let a=`${i}.buildShellExecution`;try{let c={kind:ai,args:r,cwd:e.cwd,env:e.env},l=await et.commands.executeCommand(a,c);if(l)if(l instanceof et.ShellExecution)s=l;else throw De.debug("Invalid cargo ShellExecution",l),"Invalid cargo ShellExecution."}catch(c){if(o)throw`Cargo runner '${i}' failed! ${c}`}}if(!s){let a=e.overrideCargo??e.overrideCargo,c=await xc(),g=[...(a==null?void 0:a.split(" "))??[c],...r];s=new et.ProcessExecution(g[0],g.slice(1),e)}return new et.Task(e,n??et.TaskScope.Workspace,t,PS,s,["$rustc"])}function mm(n){let e=new gm(n);return et.tasks.registerTaskProvider(ai,e)}var vm=qe(require("os")),Vt=qe(require("vscode")),ci=qe(require("path"));var ui=Vt.window.createOutputChannel("Debug");async function bs(n,e){var a;let t=(a=n.activeRustEditor)==null?void 0:a.document.uri;if(!t)return;let r=await ym(n,e);if(!r)return;let i=Vt.workspace.getConfiguration("launch",t),o=i.get("configurations")||[],s=o.findIndex(c=>c.name===r.name);if(s!==-1){if(await Vt.window.showErrorMessage(`Launch configuration '${r.name}' already exists!`,"Cancel","Update")==="Cancel")return;o[s]=r}else o.push(r);await i.update("configurations",o)}async function qc(n,e){let t,r="",o=Vt.workspace.getConfiguration("launch").get("configurations")||[],s=o.findIndex(a=>a.name===e.label);return s!==-1?(t=o[s],r=" (from launch.json)",ui.clear()):t=await ym(n,e),t?(ui.appendLine(`Launching debug configuration${r}:`),ui.appendLine(JSON.stringify(t,null,2)),Vt.debug.startDebugging(void 0,t)):!1}async function ym(n,e){if(!n.activeRustEditor)return;let r={"vadimcn.vscode-lldb":kS,"ms-vscode.cpptools":qS},i=n.config.debug,o=null;if(i.engine==="auto"){for(var s in r)if(o=Vt.extensions.getExtension(s),o)break}else o=Vt.extensions.getExtension(i.engine);if(!o){await Vt.window.showErrorMessage("Install [CodeLLDB](https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb) or [MS C++ tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools) extension for debugging.");return}ui.clear(),n.config.debug.openDebugPane&&ui.show(!0);let a=Vt.workspace.workspaceFolders,c=a.length>1,l=a[0],g=!c||!e.args.workspaceRoot?l:a.find(N=>{var $;return($=e.args.workspaceRoot)==null?void 0:$.includes(N.uri.fsPath)})||l,v=ci.normalize(g.uri.fsPath),h=c?`:${g.name}`:"";function C(N){return ci.normalize(N).replace(v,"${workspaceFolder"+h+"}")}let b=await xS(e),x=Oc(e,n.config.runnableEnv),q=i.sourceFileMap;if(q==="auto"){let N=await pm(v),$=await fm(v),K=ci.normalize($+"/lib/rustlib/src/rust");q={},q[`/rustc/${N}/`]=K}let O=r[o.id](e,C(b),x,q);if(O.type in i.engineSettings){let N=i.engineSettings[O.type];for(var I in N)O[I]=N[I]}return O.name==="run binary"&&(O.name=`run ${ci.basename(b)}`),O.cwd&&(O.cwd=C(O.cwd)),O}async function xS(n){return await new Zi(n.args.workspaceRoot||".",ui).executableFromArgs(n.args.cargoArgs)}function kS(n,e,t,r){return{type:"lldb",request:"launch",name:n.label,program:e,args:n.args.executableArgs,cwd:n.args.workspaceRoot,sourceMap:r,sourceLanguages:["rust"],env:t}}function qS(n,e,t,r){return{type:vm.platform()==="win32"?"cppvsdbg":"cppdbg",request:"launch",name:n.label,program:e,args:n.args.executableArgs,cwd:n.args.workspaceRoot,sourceFileMap:r,env:t}}var Cm=[{iconPath:new Or.ThemeIcon("save"),tooltip:"Save as a launch.json configuration."}];async function eo(n,e,t=!1,r=!0){let i=n.activeRustEditor,o=n.client;if(!i||!o)return;let s={uri:i.document.uri.toString()},a=await o.sendRequest(Qg,{textDocument:s,position:o.code2ProtocolConverter.asPosition(i.selection.active)}),c=[];e&&c.push(e);for(let l of a)e&&JSON.stringify(e.runnable)===JSON.stringify(l)||t&&(l.label.startsWith("doctest")||l.label.startsWith("cargo"))||c.push(new wm(l));if(c.length===0){await Or.window.showErrorMessage("There's no debug target!");return}return await new Promise(l=>{let g=[],v=C=>{l(C),g.forEach(b=>b.dispose())},h=Or.window.createQuickPick();h.items=c,h.title="Select Runnable",r&&(h.buttons=Cm),g.push(h.onDidHide(()=>v()),h.onDidAccept(()=>v(h.selectedItems[0])),h.onDidTriggerButton(async C=>{await bs(n,h.activeItems[0].runnable),v()}),h.onDidChangeActive(C=>{r&&C.length>0&&(C[0].label.startsWith("cargo")?h.buttons=[]:h.buttons.length===0&&(h.buttons=Cm))}),h),h.show()})}var wm=class{constructor(e){this.runnable=e;this.label=e.label}};function Oc(n,e){let t={RUST_BACKTRACE:"short"};if(n.args.expectTest&&(t.UPDATE_EXPECT="1"),Object.assign(t,process.env),e)if(Array.isArray(e))for(let r of e)(!r.mask||new RegExp(r.mask).test(n.label))&&Object.assign(t,r.env);else Object.assign(t,e);return t}async function Ic(n,e){if(n.kind!=="cargo")throw`Unexpected runnable kind: ${n.kind}`;let t=Nc(n),r={type:ai,command:t[0],args:t.slice(1),cwd:n.args.workspaceRoot||".",env:Oc(n,e.runnableEnv),overrideCargo:n.args.overrideCargo},i=Or.workspace.workspaceFolders[0],o=await Rs(i,r,n.label,t,e.cargoRunner,!0);return o.presentationOptions.clear=!0,o.presentationOptions.focus=!1,o}function Nc(n){let e=[...n.args.cargoArgs];return n.args.cargoExtraArgs&&e.push(...n.args.cargoExtraArgs),n.args.executableArgs.length>0&&e.push("--",...n.args.executableArgs),e}var Be=qe(require("vscode"));var Fc=class{constructor(e){this.astDecorationType=Be.window.createTextEditorDecorationType({borderColor:new Be.ThemeColor("rust_analyzer.syntaxTreeBorder"),borderStyle:"solid",borderWidth:"2px"});this.rust2Ast=new Rm(()=>{let e=this.findAstTextEditor();if(!this.rustEditor||!e)return;let t=[];for(let r=0;r<e.document.lineCount;++r){let i=e.document.lineAt(r);if(!(i.text.lastIndexOf('"')>=0))continue;let s=this.parseRustTextRange(this.rustEditor.document,i.text);!s||t.push([s,this.findAstNodeRange(i)])}return t});e.pushCleanup(Be.languages.registerHoverProvider({scheme:"rust-analyzer"},this)),e.pushCleanup(Be.languages.registerDefinitionProvider({language:"rust"},this)),Be.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument,this,e.subscriptions),Be.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,e.subscriptions),Be.window.onDidChangeVisibleTextEditors(this.onDidChangeVisibleTextEditors,this,e.subscriptions),e.pushCleanup(this)}dispose(){this.setRustEditor(void 0)}onDidChangeTextDocument(e){this.rustEditor&&e.document.uri.toString()===this.rustEditor.document.uri.toString()&&this.rust2Ast.reset()}onDidCloseTextDocument(e){this.rustEditor&&e.uri.toString()===this.rustEditor.document.uri.toString()&&this.setRustEditor(void 0)}onDidChangeVisibleTextEditors(e){if(!this.findAstTextEditor()){this.setRustEditor(void 0);return}this.setRustEditor(e.find(_n))}findAstTextEditor(){return Be.window.visibleTextEditors.find(e=>e.document.uri.scheme==="rust-analyzer")}setRustEditor(e){this.rustEditor&&this.rustEditor!==e&&(this.rustEditor.setDecorations(this.astDecorationType,[]),this.rust2Ast.reset()),this.rustEditor=e}provideDefinition(e,t){var a;if(!this.rustEditor||e.uri.toString()!==this.rustEditor.document.uri.toString())return;let r=this.findAstTextEditor();if(!r)return;let i=(a=this.rust2Ast.get())==null?void 0:a.find(([c,l])=>c.contains(t));if(!i)return;let[o,s]=i;return r.revealRange(s),r.selection=new Be.Selection(s.start,s.end),[{targetRange:s,targetUri:r.document.uri,originSelectionRange:o,targetSelectionRange:s}]}provideHover(e,t){if(!this.rustEditor)return;let r=e.lineAt(t.line),i=this.parseRustTextRange(this.rustEditor.document,r.text);if(!i)return;this.rustEditor.setDecorations(this.astDecorationType,[i]),this.rustEditor.revealRange(i);let o=this.rustEditor.document.getText(i),s=this.findAstNodeRange(r);return new Be.Hover(["```rust\n"+o+"\n```"],s)}findAstNodeRange(e){let t=e.range.start,r=t.translate(void 0,e.firstNonWhitespaceCharacterIndex),i=t.translate(void 0,e.text.trimEnd().length);return new Be.Range(r,i)}parseRustTextRange(e,t){let r=/(\d+)\.\.(\d+)/.exec(t);if(!r)return;let[i,o]=r.slice(1).map(s=>this.positionAt(e,+s));return new Be.Range(i,o)}positionAt(e,t){if(e.eol===Be.EndOfLine.LF)return e.positionAt(t);let r=0,i=0,o=this.cache;for((o==null?void 0:o.doc)===e&&o.offset<=t&&({line:r,offset:i}=o);;){let s=e.lineAt(r).text.length+1;if(i+s>t)return this.cache={doc:e,offset:i,line:r},e.positionAt(t+r);i+=s,r+=1}}},Rm=class{constructor(e){this.compute=e}get(){return this.val??(this.val=this.compute())}reset(){this.val=void 0}};var En=qe(Sc()),Pn=qe(require("vscode"));var to=qe(wn());var Ac=require("vscode");var It=qe(require("vscode"));var bm=require("path"),OS="nightly",Lc=class{constructor(e){this.extensionId="rust-lang.rust-analyzer";this.rootSection="rust-analyzer";this.requiresWorkspaceReloadOpts=["serverPath","server"].map(e=>`${this.rootSection}.${e}`);this.requiresReloadOpts=["cargo","procMacro","files","lens"].map(e=>`${this.rootSection}.${e}`).concat(this.requiresWorkspaceReloadOpts);this.package=It.extensions.getExtension(this.extensionId).packageJSON;this.globalStorageUri=e.globalStorageUri,It.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,e.subscriptions),this.refreshLogging()}refreshLogging(){De.setEnabled(this.traceExtension),De.info("Extension version:",this.package.version);let e=Object.entries(this.cfg).filter(([t,r])=>!(r instanceof Function));De.info("Using configuration",Object.fromEntries(e))}async onDidChangeConfiguration(e){this.refreshLogging();let t=this.requiresReloadOpts.find(s=>e.affectsConfiguration(s));if(!t)return;let r=this.requiresWorkspaceReloadOpts.find(s=>e.affectsConfiguration(s));if(!r&&this.restartServerOnConfigChange){await It.commands.executeCommand("rust-analyzer.reload");return}let i=r?`Changing "${r}" requires a window reload`:`Changing "${t}" requires a reload`,o=await It.window.showInformationMessage(i,"Reload now");if(o==="Reload now"){let s=r?"workbench.action.reloadWindow":"rust-analyzer.reload";o==="Reload now"&&await It.commands.executeCommand(s)}}get cfg(){return It.workspace.getConfiguration(this.rootSection)}get(e){return this.cfg.get(e)}get serverPath(){return this.get("server.path")??this.get("serverPath")}get serverExtraEnv(){let e=this.get("server.extraEnv")??{};return Object.fromEntries(Object.entries(e).map(([t,r])=>[t,typeof r!="string"?r.toString():r]))}get traceExtension(){return this.get("trace.extension")}get cargoRunner(){return this.get("cargoRunner")}get runnableEnv(){return this.get("runnableEnv")}get restartServerOnConfigChange(){return this.get("restartServerOnConfigChange")}get debug(){let e=this.get("debug.sourceFileMap");if(e!=="auto"){let t=this.get("debug.sourceFileMap"),{["/rustc/<id>"]:r}=t;e=Vc(t,["/rustc/<id>"])}return{engine:this.get("debug.engine"),engineSettings:this.get("debug.engineSettings"),openDebugPane:this.get("debug.openDebugPane"),sourceFileMap:e}}get hoverActions(){return{enable:this.get("hover.actions.enable"),implementations:this.get("hover.actions.implementations.enable"),references:this.get("hover.actions.references.enable"),run:this.get("hover.actions.run.enable"),debug:this.get("hover.actions.debug.enable"),gotoTypeDef:this.get("hover.actions.gotoTypeDef.enable")}}get currentExtensionIsNightly(){return this.package.releaseTag===OS}};async function Dm(n){let e=[["assist.allowMergingIntoGlobImports","imports.merge.glob"],["assist.exprFillDefault","assist.expressionFillDefault"],["assist.importEnforceGranularity","imports.granularity.enforce"],["assist.importGranularity","imports.granularity.group"],["assist.importMergeBehavior","imports.granularity.group"],["assist.importMergeBehaviour","imports.granularity.group"],["assist.importGroup","imports.group.enable"],["assist.importPrefix","imports.prefix"],["primeCaches.enable","cachePriming.enable"],["cache.warmup","cachePriming.enable"],["cargo.loadOutDirsFromCheck","cargo.buildScripts.enable"],["cargo.runBuildScripts","cargo.buildScripts.enable"],["cargo.runBuildScriptsCommand","cargo.buildScripts.overrideCommand"],["cargo.useRustcWrapperForBuildScripts","cargo.buildScripts.useRustcWrapper"],["completion.snippets","completion.snippets.custom"],["diagnostics.enableExperimental","diagnostics.experimental.enable"],["experimental.procAttrMacros","procMacro.attributes.enable"],["highlighting.strings","semanticHighlighting.strings.enable"],["highlightRelated.breakPoints","highlightRelated.breakPoints.enable"],["highlightRelated.exitPoints","highlightRelated.exitPoints.enable"],["highlightRelated.yieldPoints","highlightRelated.yieldPoints.enable"],["highlightRelated.references","highlightRelated.references.enable"],["hover.documentation","hover.documentation.enable"],["hover.linksInHover","hover.links.enable"],["hoverActions.linksInHover","hover.links.enable"],["hoverActions.debug","hover.actions.debug.enable"],["hoverActions.enable","hover.actions.enable.enable"],["hoverActions.gotoTypeDef","hover.actions.gotoTypeDef.enable"],["hoverActions.implementations","hover.actions.implementations.enable"],["hoverActions.references","hover.actions.references.enable"],["hoverActions.run","hover.actions.run.enable"],["inlayHints.chainingHints","inlayHints.chainingHints.enable"],["inlayHints.closureReturnTypeHints","inlayHints.closureReturnTypeHints.enable"],["inlayHints.hideNamedConstructorHints","inlayHints.typeHints.hideNamedConstructor"],["inlayHints.parameterHints","inlayHints.parameterHints.enable"],["inlayHints.reborrowHints","inlayHints.reborrowHints.enable"],["inlayHints.typeHints","inlayHints.typeHints.enable"],["lruCapacity","lru.capacity"],["runnables.cargoExtraArgs","runnables.extraArgs"],["runnables.overrideCargo","runnables.command"],["rustcSource","rustc.source"],["rustfmt.enableRangeFormatting","rustfmt.rangeFormatting.enable"]];for(let[t,r]of e){let i=n.inspect(t);if(i!==void 0){let o=[{val:i.globalValue,langVal:i.globalLanguageValue,target:It.ConfigurationTarget.Global},{val:i.workspaceFolderValue,langVal:i.workspaceFolderLanguageValue,target:It.ConfigurationTarget.WorkspaceFolder},{val:i.workspaceValue,langVal:i.workspaceLanguageValue,target:It.ConfigurationTarget.Workspace}];for(let{val:s,langVal:a,target:c}of o){let l=g=>g!==void 0&&!(typeof g=="object"&&g!==null&&(t==="completion.snippets"||!g.hasOwnProperty("custom")));l(s)&&(await n.update(r,s,c,!1),await n.update(t,void 0,c,!1)),l(a)&&(await n.update(r,a,c,!0),await n.update(t,void 0,c,!0))}}}}function Tm(n){let e=new Set,t=new Set(Object.keys(n).map(c=>`env:${c}`)),r=Object.fromEntries(Object.entries(n).map(([c,l])=>{let g=new Set,v=new RegExp(/\${(?<depName>.+?)}/g),h;for(;h=v.exec(l);){let C=h.groups.depName;g.add(C),t.has(C)||e.add(C)}return[`env:${c}`,{deps:[...g],value:l}]})),i=new Set;for(let c of e){let l=/(?<prefix>.*?):(?<body>.+)/.exec(c);if(l){let{prefix:g,body:v}=l.groups;if(g==="env"){let h=v;r[c]={value:process.env[h]??"",deps:[]},i.add(c)}else r[c]={value:"${"+c+"}",deps:[]},i.add(c)}else r[c]={value:Sm(c),deps:[]}}let o=new Set(Object.keys(r)),s;do{s=o.size;for(let c of o)r[c].deps.every(l=>i.has(l))&&(r[c].value=r[c].value.replace(/\${(?<depName>.+?)}/g,(l,g)=>r[g].value),i.add(c),o.delete(c))}while(o.size>0&&o.size<s);let a={};for(let c of Object.keys(n))a[c]=r[`env:${c}`].value;return a}function Sm(n){let e={workspaceFolder:()=>{let t=It.workspace.workspaceFolders??[];return t.length===1||t.length>1?t[0].uri.fsPath:""},workspaceFolderBasename:()=>{let t=Sm("workspaceFolder");return t?bm.basename(t):""},cwd:()=>process.cwd(),execPath:()=>process.env.VSCODE_EXEC_PATH??process.execPath,pathSeparator:()=>bm.sep};return n in e?e[n]():"${"+n+"}"}var _m=require("crypto"),no=new Map;setInterval(function(){let e=[...no.keys()],t=e.slice(0,e.length-10);for(let r of t)no.delete(r)},10*60*1e3);function IS(n){let e=(0,_m.randomUUID)();return no.set(e,n),`[${n.title}](command:rust-analyzer.linkToCommand?${encodeURIComponent(JSON.stringify([e]))} '${n.tooltip}')`}function NS(n){let e=n.map(r=>(r.title?r.title+" ":"")+r.commands.map(IS).join(" | ")).join("___"),t=new Pn.MarkdownString(e);return t.isTrusted=!0,t}async function Pm(n,e,t){let r=Tm(Object.assign({},process.env,t)),i={command:n,options:{env:r}},o={run:i,debug:i},s=Pn.workspace.getConfiguration("rust-analyzer");await Dm(s).catch(l=>{Pn.window.showErrorMessage(`Failed updating old config keys: ${l.message}`)}),e.kind==="Detached Files"&&(s=Ar({detachedFiles:e.files.map(l=>l.uri.fsPath)},s));let a={documentSelector:[{scheme:"file",language:"rust"}],initializationOptions:s,diagnosticCollectionName:"rustc",traceOutputChannel:Mc(),outputChannel:jc(),middleware:{async provideHover(l,g,v,h){var x;let C=Pn.window.activeTextEditor,b=(x=C==null?void 0:C.selection)!=null&&x.contains(g)?c.code2ProtocolConverter.asRange(C.selection):c.code2ProtocolConverter.asPosition(g);return c.sendRequest(jg,{textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(l),position:b},v).then(q=>{let O=c.protocol2CodeConverter.asHover(q);if(O){let I=q.actions;I&&O.contents.push(NS(I))}return O},q=>(c.handleFailedRequest(En.HoverRequest.type,v,q,null),Promise.resolve(null)))},async provideCodeActions(l,g,v,h,C){let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(l),range:c.code2ProtocolConverter.asRange(g),context:await c.code2ProtocolConverter.asCodeActionContext(v,h)};return c.sendRequest(En.CodeActionRequest.type,b,h).then(async x=>{if(x===null)return;let q=[],O=new Map;for(let I of x){if(En.CodeAction.is(I)){Ji(!I.command,"We don't expect to receive commands in CodeActions");let de=await c.protocol2CodeConverter.asCodeAction(I,h);q.push(de);continue}Ji(FS(I),"We don't expect edits or commands here");let N=c.protocol2CodeConverter.asCodeActionKind(I.kind),$=new Pn.CodeAction(I.title,N),K=I.group;if($.command={command:"rust-analyzer.resolveCodeAction",title:I.title,arguments:[I]},$.edit=new Ac.WorkspaceEdit,K){let de=O.get(K);de||(de={index:q.length,items:[]},O.set(K,de),q.push($)),de.items.push($)}else q.push($)}for(let[I,{index:N,items:$}]of O)if($.length===1)q[N]=$[0];else{let K=new Pn.CodeAction(I);K.kind=$[0].kind,K.command={command:"rust-analyzer.applyActionGroup",title:"",arguments:[$.map(de=>({label:de.title,arguments:de.command.arguments[0]}))]},K.edit=new Ac.WorkspaceEdit,q[N]=K}return q},x=>{})}},markdown:{supportHtml:!0}},c=new En.LanguageClient("rust-analyzer","Rust Analyzer Language Server",o,a);return c.registerFeature(new Em),c}var Em=class{fillClientCapabilities(e){let t=e.experimental??{};t.snippetTextEdit=!0,t.codeActionGroup=!0,t.hoverActions=!0,t.serverStatusNotification=!0,t.commands={commands:["rust-analyzer.runSingle","rust-analyzer.debugSingle","rust-analyzer.showReferences","rust-analyzer.gotoLocation","editor.action.triggerParameterHints"]},e.experimental=t}initialize(e,t){}dispose(){}};function FS(n){let e=n;return e&&to.string(e.title)&&(e.diagnostics===void 0||to.typedArray(e.diagnostics,En.Diagnostic.is))&&(e.kind===void 0||to.string(e.kind))&&e.edit===void 0&&e.command===void 0}function qm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-status://status");this.eventEmitter=new M.EventEmitter}provideTextDocumentContent(t){var o;if(!M.window.activeTextEditor)return"";let r={},i=(o=n.activeRustEditor)==null?void 0:o.document;return i!=null&&(r.textDocument=n.client.code2ProtocolConverter.asTextDocumentIdentifier(i)),n.client.sendRequest(Ng,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-status",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Om(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer-memory://memory");this.eventEmitter=new M.EventEmitter}provideTextDocumentContent(t){return M.window.activeTextEditor?n.client.sendRequest(Fg).then(r=>`Per-query memory usage:
`+r+`
(note: database has been cleared)`):""}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer-memory",e)),async()=>{e.eventEmitter.fire(e.uri);let t=await M.workspace.openTextDocument(e.uri);return M.window.showTextDocument(t,M.ViewColumn.Two,!0)}}function Im(n){return async()=>{let e=n.client;!e||await e.sendRequest(Lg)}}function Nm(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Vg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),positions:e.selections.map(i=>t.code2ProtocolConverter.asPosition(i.active))});e.selections=e.selections.map((i,o)=>{let s=t.protocol2CodeConverter.asPosition(r[o]),a=i.isEmpty?s:i.anchor;return new M.Selection(a,s)}),e.revealRange(e.selection)}}function Fm(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Gg,{ranges:e.selections.map(o=>t.code2ProtocolConverter.asRange(o)),textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)}),i=await t.protocol2CodeConverter.asTextEdits(r);await e.edit(o=>{i.forEach(s=>{o.replace(s.range,s.newText)})})}}function Lm(n){return Mm(n,"Up")}function Am(n){return Mm(n,"Down")}function Mm(n,e){return async()=>{let t=n.activeRustEditor,r=n.client;if(!t||!r)return;let i=await r.sendRequest(em,{range:r.code2ProtocolConverter.asRange(t.selection),textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(t.document),direction:e});if(!i)return;let o=await r.protocol2CodeConverter.asTextEdits(i);await ys(t,o)}}function jm(n){async function e(){let t=n.activeRustEditor,r=n.client;if(!t||!r)return!1;let i=await r.sendRequest(Xg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(t.document),position:r.code2ProtocolConverter.asPosition(t.selection.active)}).catch(s=>null);if(!i)return!1;let o=await r.protocol2CodeConverter.asTextEdits(i);return await ys(t,o),!0}return async()=>{await e()||await M.commands.executeCommand("default:type",{text:`
`})}}function $m(n){return async()=>{let e=M.window.activeTextEditor,t=n.client;if(!e||!t||!(Kn(e.document)||im(e.document)))return;let r=await t.sendRequest(Bg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),position:t.code2ProtocolConverter.asPosition(e.selection.active)});if(!!r)if(r.length===1){let i=r[0],o=t.protocol2CodeConverter.asUri(i.targetUri),s=t.protocol2CodeConverter.asRange(i.targetRange),a=await M.workspace.openTextDocument(o),c=await M.window.showTextDocument(a);c.selection=new M.Selection(s.start,s.start),c.revealRange(s,M.TextEditorRevealType.InCenter)}else{let i=e.document.uri.toString(),o=t.code2ProtocolConverter.asPosition(e.selection.active);await $c(t,i,o,r.map(s=>ro.Location.create(s.targetUri,s.targetRange)))}}}function Hm(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Zg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)});if(!r)return;let i=t.protocol2CodeConverter.asUri(r.uri),o=t.protocol2CodeConverter.asRange(r.range),s=await M.workspace.openTextDocument(i),a=await M.window.showTextDocument(s);a.selection=new M.Selection(o.start,o.start),a.revealRange(o,M.TextEditorRevealType.InCenter)}}function Wm(n){return async()=>{let e=M.window.activeTextEditor,t=n.client;if(!e||!t)return;let r=e.selection.active,i=e.selections,o=n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),s={value:"() ==>> ()",prompt:"Enter request, for example 'Foo($a) ==>> Foo::new($a)' ",validateInput:async c=>{try{await t.sendRequest(Tc,{query:c,parseOnly:!0,textDocument:o,position:r,selections:i})}catch(l){return l.toString()}return null}},a=await M.window.showInputBox(s);!a||await M.window.withProgress({location:M.ProgressLocation.Notification,title:"Structured search replace in progress...",cancellable:!1},async(c,l)=>{let g=await t.sendRequest(Tc,{query:a,parseOnly:!1,textDocument:o,position:r,selections:i});await M.workspace.applyEdit(await t.protocol2CodeConverter.asWorkspaceEdit(g,l))})}}function zm(n){return async()=>{let{stdout:e}=(0,km.spawnSync)(n.serverPath,["--version"],{encoding:"utf8"}),t=e.slice(14).trim();M.window.showInformationMessage(`rust-analyzer version: ${t}`)}}function Um(n){return async()=>{let e=M.workspace.getConfiguration("editor.inlayHints",{languageId:"rust"}),t=!e.get("enabled");await e.update("enabled",t,M.ConfigurationTarget.Global)}}function Km(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer://syntaxtree/tree.rast");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Yi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor;if(!i)return"";let o=t.query==="range=true"&&!i.selection.isEmpty?n.client.code2ProtocolConverter.asRange(i.selection):null,s={textDocument:{uri:i.document.uri.toString()},range:o};return n.client.sendRequest($g,s,r)}get onDidChange(){return this.eventEmitter.event}};return new Fc(n),n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),n.pushCleanup(M.languages.setLanguageConfiguration("ra_syntax_tree",{brackets:[["[",")"]]})),async()=>{let t=M.window.activeTextEditor,i=!!t&&!t.selection.isEmpty?M.Uri.parse(`${e.uri.toString()}?range=true`):e.uri,o=await M.workspace.openTextDocument(i);e.eventEmitter.fire(i),await M.window.showTextDocument(o,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Vm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer://viewHir/hir.txt");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Yi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(i.document),position:o.code2ProtocolConverter.asPosition(i.selection.active)};return o.sendRequest(Hg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Bm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer://viewFileText/file.rs");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Yi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s=o.code2ProtocolConverter.asTextDocumentIdentifier(i.document);return o.sendRequest(Wg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Gm(n){let e=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer://viewItemTree/itemtree.rs");this.eventEmitter=new M.EventEmitter;M.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),M.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Yi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&_n(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(i.document)};return o.sendRequest(zg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),async()=>{let t=await M.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await M.window.showTextDocument(t,{viewColumn:M.ViewColumn.Two,preserveFocus:!0})}}function Xm(n,e){return async()=>{let t=M.Uri.file(xm.join(n.extensionPath,"node_modules")),r=M.window.createWebviewPanel("rust-analyzer.crate-graph","rust-analyzer crate graph",M.ViewColumn.Two,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[t]}),i={full:e},o=await n.client.sendRequest(Ug,i),s=r.webview.asWebviewUri(t),a=`
            <!DOCTYPE html>
            <meta charset="utf-8">
            <head>
                <style>
                    /* Fill the entire view */
                    html, body { margin:0; padding:0; overflow:hidden }
                    svg { position:fixed; top:0; left:0; height:100%; width:100% }

                    /* Disable the graphviz backgroud and fill the polygons */
                    .graph > polygon { display:none; }
                    :is(.node,.edge) polygon { fill: white; }

                    /* Invert the line colours for dark themes */
                    body:not(.vscode-light) .edge path { stroke: white; }
                </style>
            </head>
            <body>
                <script type="text/javascript" src="${s}/d3/dist/d3.min.js"><\/script>
                <script type="text/javascript" src="${s}/@hpcc-js/wasm/dist/index.min.js"><\/script>
                <script type="text/javascript" src="${s}/d3-graphviz/build/d3-graphviz.min.js"><\/script>
                <div id="graph"></div>
                <script>
                    let graph = d3.select("#graph")
                                  .graphviz()
                                  .fit(true)
                                  .zoomScaleExtent([0.1, Infinity])
                                  .renderDot(\`${o}\`);

                    d3.select(window).on("click", (event) => {
                        if (event.ctrlKey) {
                            graph.resetZoom(d3.transition().duration(100));
                        }
                    });
                <\/script>
            </body>
            `;r.webview.html=a}}function Qm(n){return Xm(n,!1)}function Jm(n){return Xm(n,!0)}function Ym(n){function e(r){let i=`// Recursive expansion of ${r.name}! macro
`;return i+="// "+"=".repeat(i.length-3),i+=`

`,i+=r.expansion,i}let t=new class{constructor(){this.uri=M.Uri.parse("rust-analyzer://expandMacro/[EXPANSION].rs");this.eventEmitter=new M.EventEmitter}async provideTextDocumentContent(r){let i=M.window.activeTextEditor,o=n.client;if(!i||!o)return"";let s=i.selection.active,a=await o.sendRequest(Kg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(i.document),position:s});return a==null?"Not available":e(a)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(M.workspace.registerTextDocumentContentProvider("rust-analyzer",t)),async()=>{let r=await M.workspace.openTextDocument(t.uri);return t.eventEmitter.fire(t.uri),M.window.showTextDocument(r,M.ViewColumn.Two,!0)}}function Zm(n){return async()=>n.client.sendRequest(Mg)}async function $c(n,e,t,r){n&&await M.commands.executeCommand("editor.action.showReferences",M.Uri.parse(e),n.protocol2CodeConverter.asPosition(t),r.map(n.protocol2CodeConverter.asLocation))}function ev(n){return async(e,t,r)=>{await $c(n.client,e,t,r)}}function tv(n){return async e=>{let t=await M.window.showQuickPick(e);!t||await M.commands.executeCommand("rust-analyzer.resolveCodeAction",t.arguments)}}function nv(n){return async e=>{let t=n.client;if(t){let r=t.protocol2CodeConverter.asUri(e.targetUri),i=t.protocol2CodeConverter.asRange(e.targetSelectionRange);i=i.with({end:i.start}),await M.window.showTextDocument(r,{selection:i})}}}function rv(n){return async()=>{let e=n.client,t=M.window.activeTextEditor;if(!t||!e)return;let r=t.selection.active,i={uri:t.document.uri.toString()},o=await e.sendRequest(Yg,{position:r,textDocument:i});o!=null&&await M.commands.executeCommand("vscode.open",M.Uri.parse(o))}}function iv(n){let e=n.client;return async t=>{var c;t.command=void 0;let r=await e.sendRequest(ro.CodeActionResolveRequest.type,t);if(!r.edit)return;let i=r.edit,o=await e.protocol2CodeConverter.asWorkspaceEdit(i),s=so(Ar({},i),{documentChanges:(c=i.documentChanges)==null?void 0:c.filter(l=>"kind"in l)}),a=await e.protocol2CodeConverter.asWorkspaceEdit(s);await M.workspace.applyEdit(a),await Ec(o),r.command!=null&&await M.commands.executeCommand(r.command.command,r.command.arguments)}}function ov(n){return async e=>{await Ec(e)}}function sv(n){let e;return async()=>{let t=await eo(n,e);if(!t)return;t.detail="rerun",e=t;let r=await Ic(t.runnable,n.config);return await M.tasks.executeTask(r)}}function av(n){let e=n.client;return async()=>{let t=n.activeRustEditor;!t||!e||await M.window.withProgress({location:M.ProgressLocation.Notification,title:"Looking for tests...",cancellable:!1},async(r,i)=>{let o=t.document.uri.toString(),s=e.code2ProtocolConverter.asPosition(t.selection.active),c=(await e.sendRequest(Jg,{textDocument:{uri:o},position:s})).map(l=>ro.Location.create(l.runnable.location.targetUri,l.runnable.location.targetSelectionRange));await $c(e,o,s,c)})}}function cv(n){return async e=>{if(!n.activeRustEditor)return;let r=await Ic(e,n.config);return r.group=M.TaskGroup.Build,r.presentationOptions={reveal:M.TaskRevealKind.Always,panel:M.TaskPanelKind.Dedicated,clear:!0},M.tasks.executeTask(r)}}function uv(n){let e;return async()=>{let t=await eo(n,e);if(!t)return;let r=Nc(t.runnable),i=["cargo",...r].join(" ");await M.env.clipboard.writeText(i),await M.window.showInformationMessage("Cargo invocation copied to the clipboard.")}}function lv(n){let e;return async()=>{let t=await eo(n,e,!0);if(!!t)return t.detail="restart",e=t,await qc(n,t.runnable)}}function dv(n){return async e=>{await qc(n,e)}}function fv(n){return async()=>{let e=await eo(n,void 0,!0,!1);!e||await bs(n,e.runnable)}}function pv(n){return async e=>{let t=no.get(e);if(n.client&&t){let{command:r,arguments:i=[]}=t;await M.commands.executeCommand(r,...i)}}}var Bt=qe(require("vscode"));var li=class{constructor(e,t,r,i,o){this.config=e;this.extCtx=t;this.client=r;this.serverPath=i;this.statusBar=o}static async create(e,t,r,i){let o=await Pm(r,i,e.serverExtraEnv),s=Bt.window.createStatusBarItem(Bt.StatusBarAlignment.Left);t.subscriptions.push(s),s.text="rust-analyzer",s.tooltip="ready",s.command="rust-analyzer.analyzerStatus",s.show();let a=new li(e,t,o,r,s);return a.pushCleanup(o.start()),await o.onReady(),o.onNotification(Ag,c=>a.setServerStatus(c)),a}get activeRustEditor(){let e=Bt.window.activeTextEditor;return e&&_n(e)?e:void 0}get visibleRustEditors(){return Bt.window.visibleTextEditors.filter(_n)}registerCommand(e,t){let r=`rust-analyzer.${e}`,i=t(this),o=Bt.commands.registerCommand(r,i);this.pushCleanup(o)}get extensionPath(){return this.extCtx.extensionPath}get globalState(){return this.extCtx.globalState}get subscriptions(){return this.extCtx.subscriptions}setServerStatus(e){let t="";switch(e.health){case"ok":this.statusBar.tooltip=e.message??"Ready",this.statusBar.command=void 0,this.statusBar.color=void 0,this.statusBar.backgroundColor=void 0;break;case"warning":this.statusBar.tooltip+=`
Click to reload.`,this.statusBar.command="rust-analyzer.reloadWorkspace",this.statusBar.color=new Bt.ThemeColor("statusBarItem.warningForeground"),this.statusBar.backgroundColor=new Bt.ThemeColor("statusBarItem.warningBackground"),t="$(warning) ";break;case"error":this.statusBar.tooltip+=`
Click to reload.`,this.statusBar.command="rust-analyzer.reloadWorkspace",this.statusBar.color=new Bt.ThemeColor("statusBarItem.errorForeground"),this.statusBar.backgroundColor=new Bt.ThemeColor("statusBarItem.errorBackground"),t="$(error) ";break}e.quiescent||(t="$(sync~spin) "),this.statusBar.text=`${t}rust-analyzer`}pushCleanup(e){this.extCtx.subscriptions.push(e)}};var Hc=class{constructor(e){this.globalState=e;let{serverVersion:t}=this;De.info("PersistentState:",{serverVersion:t})}get serverVersion(){return this.globalState.get("serverVersion")}async updateServerVersion(e){await this.globalState.update("serverVersion",e)}};var gv=require("child_process"),Nt,mv="inRustProject",Ir=null;function Mc(){return Ir||(Ir=pe.window.createOutputChannel("Rust Analyzer Language Server Trace")),Ir}var Nr=null;function jc(){return Nr||(Nr=pe.window.createOutputChannel("Rust Analyzer Language Server")),Nr}async function vv(n){return await AS(n).catch(e=>{throw pe.window.showErrorMessage(`Cannot activate rust-analyzer: ${e.message}`),e})}async function AS(n){let e=new Lc(n),t=new Hc(n.globalState),r=await $S(n,e,t).catch(i=>{let o="bootstrap error. ";throw o+='See the logs in "OUTPUT > Rust Analyzer Client" (should open automatically). ',o+='To enable verbose logs use { "rust-analyzer.trace.extension": true }',De.error("Bootstrap error",i),new Error(o)});if((pe.workspace.workspaceFolders||[]).length===0){let i=pe.workspace.textDocuments.filter(o=>Kn(o));if(i.length>0)Nt=await li.create(e,n,r,{kind:"Detached Files",files:i});else throw new Error("no rust files are opened")}else Nt=await li.create(e,n,r,{kind:"Workspace Folder"}),Nt.pushCleanup(mm(Nt.config));return await MS(n,Nt),KS(),Nt.pushCleanup(VS()),pe.workspace.onDidChangeConfiguration(i=>{var o;return(o=Nt==null?void 0:Nt.client)==null?void 0:o.sendNotification("workspace/didChangeConfiguration",{settings:""}).catch(De.error)},null,Nt.subscriptions),{client:Nt.client}}async function MS(n,e){let t=pe.commands.registerCommand("rust-analyzer.onEnter",()=>pe.commands.executeCommand("default:type",{text:`
`}));n.subscriptions.push(t),await _c(mv,!0),e.registerCommand("reload",r=>async()=>{for(pe.window.showInformationMessage("Reloading rust-analyzer..."),await yv();n.subscriptions.length>0;)try{n.subscriptions.pop().dispose()}catch(i){De.error("Dispose error:",i)}await vv(n).catch(De.error)}),e.registerCommand("analyzerStatus",qm),e.registerCommand("memoryUsage",Om),e.registerCommand("shuffleCrateGraph",Im),e.registerCommand("reloadWorkspace",Zm),e.registerCommand("matchingBrace",Nm),e.registerCommand("joinLines",Fm),e.registerCommand("parentModule",$m),e.registerCommand("syntaxTree",Km),e.registerCommand("viewHir",Vm),e.registerCommand("viewFileText",Bm),e.registerCommand("viewItemTree",Gm),e.registerCommand("viewCrateGraph",Qm),e.registerCommand("viewFullCrateGraph",Jm),e.registerCommand("expandMacro",Ym),e.registerCommand("run",sv),e.registerCommand("copyRunCommandLine",uv),e.registerCommand("debug",lv),e.registerCommand("newDebugConfig",fv),e.registerCommand("openDocs",rv),e.registerCommand("openCargoToml",Hm),e.registerCommand("peekTests",av),e.registerCommand("moveItemUp",Lm),e.registerCommand("moveItemDown",Am),t.dispose(),e.registerCommand("onEnter",jm),e.registerCommand("ssr",Wm),e.registerCommand("serverVersion",zm),e.registerCommand("toggleInlayHints",Um),e.registerCommand("runSingle",cv),e.registerCommand("debugSingle",dv),e.registerCommand("showReferences",ev),e.registerCommand("applySnippetWorkspaceEdit",ov),e.registerCommand("resolveCodeAction",iv),e.registerCommand("applyActionGroup",tv),e.registerCommand("gotoLocation",nv),e.registerCommand("linkToCommand",pv)}async function jS(){Ir==null||Ir.dispose(),Ir=null,Nr==null||Nr.dispose(),Nr=null,await yv()}async function yv(){await _c(mv,void 0),await(Nt==null?void 0:Nt.client.stop()),Nt=void 0}async function $S(n,e,t){let r=await WS(n,e,t);if(!r)throw new Error("Rust Analyzer Language Server is not available. Please, ensure its [proper installation](https://rust-analyzer.github.io/manual.html#installation).");if(De.info("Using server binary at",r),!om(r))throw e.serverPath?new Error(`Failed to execute ${r} --version. \`config.server.path\` or \`config.serverPath\` has been set explicitly.            Consider removing this config or making a valid server binary available at that path.`):new Error(`Failed to execute ${r} --version`);return r}async function HS(n){await pe.window.withProgress({location:pe.ProgressLocation.Notification,title:"Patching rust-analyzer for NixOS"},async(e,t)=>{let r=`
            {srcStr, pkgs ? import <nixpkgs> {}}:
                pkgs.stdenv.mkDerivation {
                    name = "rust-analyzer";
                    src = /. + srcStr;
                    phases = [ "installPhase" "fixupPhase" ];
                    installPhase = "cp $src $out";
                    fixupPhase = ''
                    chmod 755 $out
                    patchelf --set-interpreter "$(cat $NIX_CC/nix-support/dynamic-linker)" $out
                    '';
                }
            `,i=pe.Uri.file(n.fsPath+"-orig");await pe.workspace.fs.rename(n,i,{overwrite:!0});try{e.report({message:"Patching executable",increment:20}),await new Promise((o,s)=>{var c,l;let a=(0,gv.exec)(`nix-build -E - --argstr srcStr '${i.fsPath}' -o '${n.fsPath}'`,(g,v,h)=>{g!=null?s(Error(h)):o(v)});(c=a.stdin)==null||c.write(r),(l=a.stdin)==null||l.end()})}finally{await pe.workspace.fs.delete(i)}})}async function WS(n,e,t){let r=zS(e);if(r)return r.startsWith("~/")?hv.homedir()+r.slice(1):r;if(e.package.releaseTag===null)return"rust-analyzer";let i=process.platform==="win32"?".exe":"",o=pe.Uri.joinPath(n.extensionUri,"server",`rust-analyzer${i}`);if(await pe.workspace.fs.stat(o).then(()=>!0,()=>!1)){let a=o;if(await US()){await pe.workspace.fs.createDirectory(e.globalStorageUri).then();let c=pe.Uri.joinPath(e.globalStorageUri,`rust-analyzer${i}`),l=await pe.workspace.fs.stat(c).then(()=>!0,()=>!1);l&&e.package.version!==t.serverVersion&&(await pe.workspace.fs.delete(c),l=!1),l||(await pe.workspace.fs.copy(o,c),await HS(c)),a=c}return await t.updateServerVersion(e.package.version),a.fsPath}await t.updateServerVersion(void 0),await pe.window.showErrorMessage("Unfortunately we don't ship binaries for your platform yet. You need to manually clone the rust-analyzer repository and run `cargo xtask install --server` to build the language server from sources. If you feel that your platform should be supported, please create an issue about that [here](https://github.com/rust-analyzer/rust-analyzer/issues) and we will consider it.")}function zS(n){return process.env.__RA_LSP_SERVER_DEBUG??n.serverPath}async function US(){try{return((await pe.workspace.fs.readFile(pe.Uri.file("/etc/os-release"))).toString().split(`
`).find(t=>t.startsWith("ID="))||"ID=linux").indexOf("nixos")!==-1}catch{return!1}}function KS(){pe.extensions.getExtension("rust-lang.rust")&&pe.window.showWarningMessage("You have both the rust-analyzer (rust-lang.rust-analyzer) and Rust (rust-lang.rust) plugins enabled. These are known to conflict and cause various functions of both plugins to not work correctly. You should disable one of them.","Got it").then(()=>{},console.error)}function VS(){let n=pe.IndentAction.None;return pe.languages.setLanguageConfiguration("rust",{onEnterRules:[{beforeText:/^\s*\/{3}.*$/,action:{indentAction:n,appendText:"/// "}},{beforeText:/^\s*\/{2}\!.*$/,action:{indentAction:n,appendText:"//! "}},{beforeText:/^\s*\/\*(\*|\!)(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:pe.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*(\*|\!)(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:n,appendText:" * "}},{beforeText:/^(\ \ )*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:n,appendText:"* "}},{beforeText:/^(\ \ )*\ \*\/\s*$/,action:{indentAction:n,removeText:1}}]})}0&&(module.exports={activate,deactivate,outputChannel,traceOutputChannel});
